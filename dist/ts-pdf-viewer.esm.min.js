/**
 * Copyright 2021 yermolim
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * 
 * FlateStream class is based on the corresponding one from PDF.js,
 * so the code of that class is also subject to the next license notice:
 * 
 * Copyright 2012 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Copyright 1996-2003 Glyph & Cog, LLC
 * 
 * The flate stream implementation contained in this file is a JavaScript port
 * of XPDF's implementation, made available under the Apache 2.0 open source
 * license.
 */

import{renderTextLayer as t,RenderingCancelledException as e,GlobalWorkerOptions as r,getDocument as s}from"pdfjs-dist";import{v4 as n}from"uuid";import i from"crypto-es";import a from"pako";function o(){return n()}function h(t,e,r,s){return Math.hypot(r-t,s-e)}class c{constructor(t){this.data=t}}class d{constructor(t){this._length=0,t&&this.push(t)}get head(){return this._head.data}get length(){return this._length}get tail(){return this.get(this._length-1)}push(t){const e=new c(t);let r;if(this._head){for(r=this._head;r.next;)r=r.next;r.next=e}else this._head=e;this._length++}insert(t,e){if(e<0||e>this._length-1)return null;const r=new c(t);let s,n=this._head,i=0;if(e){for(;i++<e;)s=n,n=n.next;s.next=r}else this._head=r;return r.next=n,this._length++,r.data}replace(t,e){if(e<0||e>this._length-1)return null;const r=new c(t);let s,n=this._head,i=0;if(e){for(;i++<e;)s=n,n=n.next;s.next=r}else this._head=r;return r.next=n.next,n.data}remove(t){if(t<0||t>this._length-1)return null;let e,r=this._head,s=0;if(t){for(;s++<t;)e=r,r=r.next;e.next=r.next}else this._head=r.next;return this._length--,r.data}clear(){this._head=null,this._length=0}get(t){if(t<0||t>this._length-1)return null;let e=this._head,r=0;for(;r++<t;)e=e.next;return e.data}pop(){return this.remove(this._length-1)}has(t,e){if(!this._length)return!1;e||(e=(t,e)=>t===e);let r=this._head,s=0;for(;s<this._length;){if(e(t,r.data))return!0;r=r.next,s++}return!1}findIndex(t,e){if(!this._length)return-1;e||(e=(t,e)=>t===e);let r=this._head,s=0;for(;s<this._length;){if(e(t,r.data))return s;r=r.next,s++}return-1}*[Symbol.iterator](){let t=this._head;for(;t;)yield t.data,t=t.next}}function l(t,e,r){return Math.max(e,Math.min(t,r))}class p{constructor(t=0,e=0){this.length=2,this.x=t,this.y=e}static multiplyByScalar(t,e){return new p(t.x*e,t.y*e)}static addScalar(t,e){return new p(t.x+e,t.y+e)}static normalize(t){return(new p).setFromVec2(t).normalize()}static add(t,e){return new p(t.x+e.x,t.y+e.y)}static substract(t,e){return new p(t.x-e.x,t.y-e.y)}static dotProduct(t,e){return t.x*e.x+t.y*e.y}static applyMat3(t,e){return t.clone().applyMat3(e)}static lerp(t,e,r){return t.clone().lerp(e,r)}static rotate(t,e,r){return t.clone().rotate(e,r)}static equals(t,e,r=6){return t.equals(e)}static getDistance(t,e){const r=e.x-t.x,s=e.y-t.y;return Math.sqrt(r*r+s*s)}clone(){return new p(this.x,this.y)}set(t,e){return this.x=t,this.y=e,this}setFromVec2(t){return this.x=t.x,this.y=t.y,this}multiplyByScalar(t){return this.x*=t,this.y*=t,this}addScalar(t){return this.x+=t,this.y+=t,this}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.getMagnitude();return t&&(this.x/=t,this.y/=t),this}add(t){return this.x+=t.x,this.y+=t.y,this}substract(t){return this.x-=t.x,this.y-=t.y,this}dotProduct(t){return p.dotProduct(this,t)}applyMat3(t){if(9!==t.length)throw new Error("Matrix must contain 9 elements");const{x:e,y:r}=this,[s,n,,i,a,,o,h]=t;return this.x=e*s+r*i+o,this.y=e*n+r*a+h,this}lerp(t,e){return this.x+=e*(t.x-this.x),this.y+=e*(t.y-this.y),this}rotate(t,e){const r=Math.sin(e),s=Math.cos(e),n=this.x-t.x,i=this.y-t.y;return this.x=n*s-i*r+t.x,this.y=n*r+i*s+t.y,this}equals(t,e=6){return+this.x.toFixed(e)==+t.x.toFixed(e)&&+this.y.toFixed(e)==+t.y.toFixed(e)}toArray(){return[this.x,this.y]}toIntArray(){return new Int32Array(this)}toFloatArray(){return new Float32Array(this)}*[Symbol.iterator](){yield this.x,yield this.y}}class u{constructor(t=0,e=0,r=0){this.length=3,this.x=t,this.y=e,this.z=r}static multiplyByScalar(t,e){return new u(t.x*e,t.y*e,t.z*e)}static addScalar(t,e){return new u(t.x+e,t.y+e,t.z+e)}static normalize(t){return(new u).setFromVec3(t).normalize()}static add(t,e){return new u(t.x+e.x,t.y+e.y,t.z+e.z)}static substract(t,e){return new u(t.x-e.x,t.y-e.y,t.z-e.z)}static dotProduct(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static crossProduct(t,e){return new u(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static onVector(t,e){return t.clone().onVector(e)}static onPlane(t,e){return t.clone().onPlane(e)}static applyMat3(t,e){return t.clone().applyMat3(e)}static lerp(t,e,r){return t.clone().lerp(e,r)}static equals(t,e,r=6){return!!t&&t.equals(e,r)}static getDistance(t,e){const r=e.x-t.x,s=e.y-t.y,n=e.z-t.z;return Math.sqrt(r*r+s*s+n*n)}static getAngle(t,e){return t.getAngle(e)}clone(){return new u(this.x,this.y,this.z)}set(t,e,r){return this.x=t,this.y=e,this.z=r,this}setFromVec3(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}multiplyByScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}getAngle(t){const e=this.getMagnitude()*t.getMagnitude();if(!e)return Math.PI/2;const r=this.dotProduct(t)/e;return Math.acos(l(r,-1,1))}normalize(){const t=this.getMagnitude();return t&&(this.x/=t,this.y/=t,this.z/=t),this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}substract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}dotProduct(t){return u.dotProduct(this,t)}crossProduct(t){return this.x=this.y*t.z-this.z*t.y,this.y=this.z*t.x-this.x*t.z,this.z=this.x*t.y-this.y*t.x,this}onVector(t){const e=this.getMagnitude();return e?t.clone().multiplyByScalar(t.clone().dotProduct(this)/(e*e)):this.set(0,0,0)}onPlane(t){return this.substract(this.clone().onVector(t))}applyMat3(t){if(9!==t.length)throw new Error("Matrix must contain 9 elements");const{x:e,y:r,z:s}=this,[n,i,a,o,h,c,d,l,p]=t;return this.x=e*n+r*o+s*d,this.y=e*i+r*h+s*l,this.z=e*a+r*c+s*p,this}lerp(t,e){return this.x+=e*(t.x-this.x),this.y+=e*(t.y-this.y),this.z+=e*(t.z-this.z),this}equals(t,e=6){return!!t&&(+this.x.toFixed(e)==+t.x.toFixed(e)&&+this.y.toFixed(e)==+t.y.toFixed(e)&&+this.z.toFixed(e)==+t.z.toFixed(e))}toArray(){return[this.x,this.y,this.z]}toIntArray(){return new Int32Array(this)}toFloatArray(){return new Float32Array(this)}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}class f{constructor(){this.length=9,this._matrix=new Array(this.length),this._matrix[0]=1,this._matrix[1]=0,this._matrix[2]=0,this._matrix[3]=0,this._matrix[4]=1,this._matrix[5]=0,this._matrix[6]=0,this._matrix[7]=0,this._matrix[8]=1}get x_x(){return this._matrix[0]}get x_y(){return this._matrix[1]}get x_z(){return this._matrix[2]}get y_x(){return this._matrix[3]}get y_y(){return this._matrix[4]}get y_z(){return this._matrix[5]}get z_x(){return this._matrix[6]}get z_y(){return this._matrix[7]}get z_z(){return this._matrix[8]}static fromMat3(t){return(new f).setFromMat3(t)}static multiply(t,e){const[r,s,n,i,a,o,h,c,d]=t._matrix,[l,p,u,g,w,y,A,m,v]=e._matrix,x=new f;return x.set(r*l+s*g+n*A,r*p+s*w+n*m,r*u+s*y+n*v,i*l+a*g+o*A,i*p+a*w+o*m,i*u+a*y+o*v,h*l+c*g+d*A,h*p+c*w+d*m,h*u+c*y+d*v),x}static multiplyScalar(t,e){const r=new f;for(let s=0;s<this.length;s++)r._matrix[s]=t._matrix[s]*e;return r}static transpose(t){const e=new f;return e.set(t.x_x,t.y_x,t.z_x,t.x_y,t.y_y,t.z_y,t.x_z,t.y_z,t.z_z),e}static invert(t){const e=new f;e.set(t.y_y*t.z_z-t.z_y*t.y_z,t.y_x*t.z_z-t.z_x*t.y_z,t.y_x*t.z_y-t.z_x*t.y_y,t.x_y*t.z_z-t.z_y*t.x_z,t.x_x*t.z_z-t.z_x*t.x_z,t.x_x*t.z_y-t.z_x*t.x_y,t.x_y*t.y_z-t.y_y*t.x_z,t.x_x*t.y_z-t.y_x*t.x_z,t.x_x*t.y_y-t.y_x*t.x_y),e.set(e.x_x,-e.x_y,e.x_z,-e.y_x,e.y_y,-e.y_z,e.z_x,-e.z_y,e.z_z);const r=t.x_x*e.x_x+t.x_y*e.x_y+t.x_z*e.x_z,s=new f;if(r){const t=.1;s.set(t*e.x_x,t*e.y_x,t*e.z_x,t*e.x_y,t*e.y_y,t*e.z_y,t*e.x_z,t*e.y_z,t*e.z_z)}else s.set(0,0,0,0,0,0,0,0,0);return s}static buildScale(t,e){return null!=e||(e=t),(new f).set(t,0,0,0,e,0,0,0,1)}static buildRotation(t){const e=Math.cos(t),r=Math.sin(t);return(new f).set(e,-r,0,r,e,0,0,0,1)}static buildTranslate(t,e){return(new f).set(1,0,0,0,1,0,t,e,1)}static equals(t,e,r=6){return t.equals(e,r)}clone(){return(new f).set(this.x_x,this.x_y,this.x_z,this.y_x,this.y_y,this.y_z,this.z_x,this.z_y,this.z_z)}set(t,e,r,s,n,i,a,o,h){return this._matrix[0]=t,this._matrix[1]=e,this._matrix[2]=r,this._matrix[3]=s,this._matrix[4]=n,this._matrix[5]=i,this._matrix[6]=a,this._matrix[7]=o,this._matrix[8]=h,this}reset(){return this._matrix[0]=1,this._matrix[1]=0,this._matrix[2]=0,this._matrix[3]=0,this._matrix[4]=1,this._matrix[5]=0,this._matrix[6]=0,this._matrix[7]=0,this._matrix[8]=1,this}setFromMat3(t){for(let e=0;e<this.length;e++)this._matrix[e]=t._matrix[e];return this}multiply(t){const[e,r,s,n,i,a,o,h,c]=this._matrix,[d,l,p,u,f,g,w,y,A]=t._matrix;return this._matrix[0]=e*d+r*u+s*w,this._matrix[1]=e*l+r*f+s*y,this._matrix[2]=e*p+r*g+s*A,this._matrix[3]=n*d+i*u+a*w,this._matrix[4]=n*l+i*f+a*y,this._matrix[5]=n*p+i*g+a*A,this._matrix[6]=o*d+h*u+c*w,this._matrix[7]=o*l+h*f+c*y,this._matrix[8]=o*p+h*g+c*A,this}multiplyScalar(t){for(let e=0;e<this.length;e++)this._matrix[e]*=t;return this}transpose(){const t=(new f).setFromMat3(this);return this.set(t.x_x,t.y_x,t.z_x,t.x_y,t.y_y,t.z_y,t.x_z,t.y_z,t.z_z),this}invert(){const t=new f;t.set(this.y_y*this.z_z-this.z_y*this.y_z,this.y_x*this.z_z-this.z_x*this.y_z,this.y_x*this.z_y-this.z_x*this.y_y,this.x_y*this.z_z-this.z_y*this.x_z,this.x_x*this.z_z-this.z_x*this.x_z,this.x_x*this.z_y-this.z_x*this.x_y,this.x_y*this.y_z-this.y_y*this.x_z,this.x_x*this.y_z-this.y_x*this.x_z,this.x_x*this.y_y-this.y_x*this.x_y),t.set(t.x_x,-t.x_y,t.x_z,-t.y_x,t.y_y,-t.y_z,t.z_x,-t.z_y,t.z_z);if(this.x_x*t.x_x+this.x_y*t.x_y+this.x_z*t.x_z){const e=.1;this.set(e*t.x_x,e*t.y_x,e*t.z_x,e*t.x_y,e*t.y_y,e*t.z_y,e*t.x_z,e*t.y_z,e*t.z_z)}else this.set(0,0,0,0,0,0,0,0,0);return this}getDeterminant(){const[t,e,r,s,n,i,a,o,h]=this._matrix;return t*n*h-t*i*o+e*i*a-e*s*h+r*s*o-r*n*a}getTRS(){const t=new p(this.z_x,this.z_y),e=Math.sqrt(this.x_x*this.x_x+this.x_y*this.x_y),r=Math.sqrt(this.y_x*this.y_x+this.y_y*this.y_y),s=new p(e,r),n=Math.atan(-this.x_y/this.x_x),i=Math.acos(this.x_x/e);let a;return a=i>Math.PI/2&&n>0||i<Math.PI/2&&n<0?2*Math.PI-i:i,{t:t,r:a,s:s}}equals(t,e=6){for(let r=0;r<this.length;r++)if(+this._matrix[r].toFixed(e)!=+t._matrix[r].toFixed(e))return!1;return!0}applyScaling(t,e){const r=f.buildScale(t,e);return this.multiply(r)}applyTranslation(t,e){const r=f.buildTranslate(t,e);return this.multiply(r)}applyRotation(t){const e=f.buildRotation(t);return this.multiply(e)}toArray(){return this._matrix.slice()}toIntArray(){return new Int32Array(this)}toIntShortArray(){return new Int32Array([this._matrix[0],this._matrix[1],this._matrix[3],this._matrix[4],this._matrix[6],this._matrix[7]])}toFloatArray(){return new Float32Array(this)}toFloatShortArray(){return new Float32Array([this._matrix[0],this._matrix[1],this._matrix[3],this._matrix[4],this._matrix[6],this._matrix[7]])}*[Symbol.iterator](){for(let t=0;t<9;t++)yield this._matrix[t]}}function g(t,e,r,s,n=!1){const i=new f;i.applyTranslation(-t.x,-t.y);const a=p.substract(e,t).getMagnitude(),o=p.substract(s,r).getMagnitude()/a;if(i.applyScaling(o),!n){const n=Math.atan2(e.y-t.y,e.x-t.x),a=Math.atan2(s.y-r.y,s.x-r.x)-n;i.applyRotation(a)}return i.applyTranslation(r.x,r.y),i}function w(...t){return{min:new p(Math.min(...t.map((t=>t.x))),Math.min(...t.map((t=>t.y)))),max:new p(Math.max(...t.map((t=>t.x))),Math.max(...t.map((t=>t.y))))}}const y=0,A=8,m=9,v=10,x=12,b=13,_=32,E=37,C=40,S=41,P=45,k=46,B=47,I=48,M=49,N=50,R=51,D=52,T=53,L=54,U=55,O=56,F=57,V=60,z=62,H=69,W=70,G=80,Q=82,j=83,X=84,q=88,K=91,J=92,Y=93,Z=97,$=98,tt=100,et=101,rt=102,st=106,nt=108,it=109,at=110,ot=111,ht=112,ct=114,dt=115,lt=116,pt=117,ut=120,ft=121,gt={NULL:[at,pt,nt,nt],OBJ:[ot,$,st],OBJ_END:[et,at,tt,ot,$,st],STREAM_START:[dt,lt,ct,et,Z,it],STREAM_END:[et,at,tt,dt,lt,ct,et,Z,it],DICT_START:[V,V],DICT_END:[z,z],ARRAY_START:[K],ARRAY_END:[Y],STR_LITERAL_START:[C],STR_LITERAL_END:[S],STR_HEX_START:[V],STR_HEX_END:[z],VERSION:[E,G,68,W,P],PREV:[B,G,ct,et,118],TYPE:[B,X,ft,ht,et],SUBTYPE:[B,j,pt,$,lt,ft,ht,et],FORM:[B,W,ot,ct,it],XREF_TABLE:[ut,ct,et,rt],XREF_STREAM:[B,q,Q,et,rt],XREF_HYBRID:[q,Q,et,rt,j,lt,it],XREF_START:[dt,lt,Z,ct,lt,ut,ct,et,rt],TRAILER:[lt,ct,Z,105,nt,et,ct],END_OF_FILE:[E,E,H,79,W],END_OF_LINE:[b,v],TRUE:[lt,ct,pt,et],FALSE:[rt,Z,nt,dt,et]},wt=new Set([E,C,S,B,V,z,K,Y,123,125]),yt=new Set([y,m,v,x,b,_]),At=new Set([I,M,N,R,D,T,L,U,O,F]);function mt(t){return!wt.has(t)&&!yt.has(t)}const vt=3,xt=4,bt=5,_t=7,Et=8,Ct=0,St=1,Pt=0,kt=1,Bt=2,It="/DCTDecode",Mt="/FlateDecode",Nt="/JBIG2Decode",Rt="/JPXDecode",Dt=1,Tt=2,Lt=10,Ut=11,Ot=12,Ft=13,Vt=14,zt=15,Ht={RC4_40:1,RC4_128:2,AES_128:4,AES_256:5},Wt={RC4_40:2,RC4_128:3,AES_128:4,AES_256:5,AES_256_V2:6},Gt={NONE:"/None",RC4:"/V2",AES_128:"/AESV2",AES_256:"/AESV3"},Qt={DOC_OPEN:"/DocOpen",EMBEDDED_OPEN:"/EFOpen"},jt="/XRef",Xt="/ObjStm",qt="/XObject",Kt="/Catalog",Jt="/Pages",Yt="/Page",Zt="/Annot",$t="/Border",te="/Measure",ee="/ExtGState",re="/CryptFilter",se="/Mask",ne="/Group",ie="/Font",ae="",oe={TRANSPARENCY:"/Transparency"},he=0,ce=2,de=3,le=4,pe=5,ue=6,fe=7,ge=8,we=9,ye=10,Ae=11,me="/Stamp",ve={BUTT:0,ROUND:1,SQUARE:2},xe={MITER:0,ROUND:1,BEVEL:2},be={ABSOLUTE:"/AbsoluteColorimetric",RELATIVE:"/RelativeColorimetric",SATURATION:"/Saturation",PERCEPTUAL:"/Perceptual"},_e={NORMAL:"/Normal",COMPATIBLE:"/Compatible",MULTIPLY:"/Multiply",SCREEN:"/Screen",OVERLAY:"/Overlay",DARKEN:"/Darken",LIGHTEN:"/Lighten",COLOR_DODGE:"/ColorDodge",COLOR_BURN:"/ColorBurn",HARD_LIGHT:"/HardLight",SOFT_LIGHT:"/SoftLight",DIFFERENCE:"/Difference",EXCLUSION:"/Exclusion"},Ee="/DeviceGray",Ce="/DeviceRGB",Se="/DeviceCMYK",Pe="/Indexed",ke={ALPHA:"/Alpha",LUMINOSITY:"/Luminosity"},Be=new Set([Mt,It,Nt,Rt]);function Ie(t){if(!(null==t?void 0:t.length))return 0;if(1===t.length)return t[0];const e=Array.from(t,(t=>("0"+(255&t).toString(16)).slice(-2))).join("");return parseInt(e,16)}function Me(t){const e=new ArrayBuffer(1);return new DataView(e).setInt8(0,t),new Uint8Array(e)}function Ne(t,e=!1){const r=new ArrayBuffer(2);return new DataView(r).setInt16(0,t,e),new Uint8Array(r)}function Re(t,e=!1){const r=new ArrayBuffer(4);return new DataView(r).setInt32(0,t,e),new Uint8Array(r)}function De(t,e){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t[s]^e;return r}function Te(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Le(t){const e=new Uint8Array(t.length/2);for(let r=0,s=0;r<t.length;r+=2,s++)e[s]=parseInt(t.substr(r,2),16);return e}function Ue(t){return i.lib.WordArray.create(t)}function Oe(t){return function(t,e=!1){const r=new ArrayBuffer(4*t.length),s=new DataView(r);for(let r=0;r<t.length;r++)s.setInt32(4*r,t[r],e);return new Uint8Array(r)}(t.words).slice(0,t.sigBytes)}function Fe(t){t instanceof Uint8Array&&(t=Ue(t));return i.MD5(t)}function Ve(t,e){t instanceof Uint8Array&&(t=Ue(t)),e instanceof Uint8Array&&(e=Ue(e));return i.RC4.encrypt(t,e).ciphertext}function ze(t,e,r=!1){if(t instanceof Uint8Array&&(t=Ue(t)),e instanceof Uint8Array&&(e=Ue(e)),r){const r=i.lib.WordArray.create(t.words.slice(0,4));return i.algo.AES.createDecryptor(e,{mode:i.mode.CBC,iv:r,padding:i.pad.Pkcs7}).finalize(t)}{const r=i.lib.WordArray.random(16);return i.algo.AES.createEncryptor(e,{mode:i.mode.CBC,iv:r,padding:i.pad.Pkcs7}).finalize(t)}}const He=[115,65,108,84];class We{constructor(t){if(!t)throw new Error("Empty key");if(16!==t.length)throw new Error(`Invalid key length: ${t.length} (shall be 16)`);this._n=t.length,this._key=t,this._tempKey=new Uint8Array(t.length+9)}encrypt(t,e){return this.run(t,e.id,e.generation)}decrypt(t,e){return this.run(t,e.id,e.generation,!0)}run(t,e,r,s=!1){const n=Re(e,!0),i=Re(r,!0);this._tempKey.set(this._key,0),this._tempKey.set(n.subarray(0,3),this._n),this._tempKey.set(i.subarray(0,2),this._n+3),this._tempKey.set(He,this._n+5);const a=Oe(Fe(this._tempKey)),o=Math.min(this._n+5,16),h=Oe(ze(t,a.slice(0,o),s));return s?h.slice(16):h}}class Ge{constructor(t){if(!t)throw new Error("Empty key");if(32!==t.length)throw new Error(`Invalid key length: ${t.length} (shall be 16)`);this._n=t.length,this._key=t}encrypt(t,e){return this.run(t,e.id,e.generation)}decrypt(t,e){return this.run(t,e.id,e.generation,!0)}run(t,e,r,s=!1){const n=Oe(ze(t,this._key,s));return s?n.slice(16):n}}class Qe{constructor(){}encrypt(t,e){return t}decrypt(t,e){return t}}class je{constructor(t){if(!t)throw new Error("Empty key");if(t.length<5||t.length>16)throw new Error(`Invalid key length: ${t.length} (shall be a multiple in range from 40 to 128)`);this._n=t.length,this._key=t,this._tempKey=new Uint8Array(t.length+5)}encrypt(t,e){const r=Re(e.id,!0),s=Re(e.generation,!0);this._tempKey.set(this._key,0),this._tempKey.set(r.slice(0,3),this._n),this._tempKey.set(s.slice(0,2),this._n+3);const n=Oe(Fe(this._tempKey)),i=Math.min(this._n+5,16);return Oe(Ve(t,n.slice(0,i)))}decrypt(t,e){return this.encrypt(t,e)}}const Xe=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122];class qe{constructor(t,e){const{filter:r,version:s,revision:n,permissions:i,encryptMetadata:a,keyLength:o,stringKeyLength:h,streamKeyLength:c,stringMethod:d,streamMethod:l,oPasswordHash:p,uPasswordHash:u,oEncPasswordHash:f,uEncPasswordHash:g,perms:w}=t;if("/Standard"!==r)throw new Error(`Unsupported filter name: ${r}`);if(![1,2,4,5].includes(s))throw new Error(`Unsupported algorithm version: ${s}`);if(![2,3,4,5,6].includes(n))throw new Error(`Unsupported algorithm revision: ${n}`);if(isNaN(i))throw new Error("Permissions not provided");if(!p||!u)throw new Error("Password hash not provided");this._filter=r,this._version=s,this._revision=n,this._permissions=i,this._keyLength=o,this._encryptMetadata=a,this._stringKeyLength=h,this._streamKeyLength=c,this._stringMethod=d,this._streamMethod=l,this._oPasswordHash=p,this._uPasswordHash=u,this._oEncPasswordHash=f,this._uEncPasswordHash=g,this._perms=w,this._fileId=e}authenticate(t){const e=this._version,r=this._stringMethod,s=this._streamMethod;let n=!1;if(this.authOwnerPassword(t))n=!0;else{if(!this.authUserPassword(t))return null}const i=this._lastEncryptionKey;switch(e){case 1:const t=new je(i);return{owner:n,stringCryptor:t,streamCryptor:t};case 2:const e=new je(i);return{owner:n,stringCryptor:e,streamCryptor:e};case 4:let a,o;if(r&&r!==Gt.NONE)if(r===Gt.RC4)a=new je(i);else{if(r!==Gt.AES_128)throw new Error(`Invalid crypt method: ${r}`);a=new We(i)}else a=new Qe;if(s&&s!==Gt.NONE)if(s===Gt.RC4)o=new je(i);else{if(s!==Gt.AES_128)throw new Error(`Invalid crypt method: ${s}`);o=new We(i)}else o=new Qe;return{owner:n,stringCryptor:a,streamCryptor:o};case 5:let h,c;if(r&&r!==Gt.NONE){if(r!==Gt.AES_256)throw new Error(`Invalid crypt method: ${r}`);a=new Ge(i)}else a=new Qe;if(s&&s!==Gt.NONE){if(s!==Gt.AES_256)throw new Error(`Invalid crypt method: ${s}`);o=new Ge(i)}else o=new Qe;return{owner:n,stringCryptor:h,streamCryptor:c}}}padPassword32(t){if(!t)return new Uint8Array(Xe);const e=(new TextEncoder).encode(t),r=new Uint8Array(32);return r.set(e.slice(0,32)),e.length<32&&r.set(Xe.slice(0,32-e.length),e.length),r}computeEncryptionKey(t){if([2,3,4].includes(this._revision)){const e=this.padPassword32(t),r=Re(this._permissions,!0),s=this._revision>=4&&!this._encryptMetadata?new Uint8Array([255,255,255,255]):new Uint8Array(0);let n=Oe(Fe(new Uint8Array([...e,...this._oPasswordHash,...r,...this._fileId,...s])));const i=this._keyLength>>3;if(this._revision>=3)for(let t=0;t<50;t++)n=Oe(Fe(n.slice(0,i)));const a=n.slice(0,i);return this._lastEncryptionKey=a,a}if(5===this._revision)throw new Error("Not implemented yet");if(6===this._revision)throw new Error("Not implemented yet")}computeOHashEncryptionKey_R2R3R4(t){let e=Fe(this.padPassword32(t));if(this._revision>=3)for(let t=0;t<50;t++)e=Fe(e);const r=Oe(e),s=this._keyLength>>3;return r.slice(0,s)}computeOHash_R2R3R4(t,e){const r=this.computeOHashEncryptionKey_R2R3R4(t||e);let s=Ve(this.padPassword32(e),r);if(this._revision>=3)for(let t=1;t<20;t++)s=Ve(s,De(r,t));return Oe(s)}computeUHash_R2(t){const e=this.computeEncryptionKey(t);return Oe(Ve(new Uint8Array(Xe),e))}computeUHash_R3R4(t){const e=this.computeEncryptionKey(t);let r=Fe(new Uint8Array([...Xe,...this._fileId]));r=Ve(r,e);for(let t=1;t<20;t++)r=Ve(r,De(e,t));return Oe(r)}authOwnerPassword(t){if([2,3,4].includes(this._revision)){const e=this.computeOHashEncryptionKey_R2R3R4(t);let r;if(2===this._revision)r=Oe(Ve(this._oPasswordHash,e));else{let t=Ue(this._oPasswordHash);for(let r=19;r>=0;r--)t=Ve(t,De(e,r));r=Oe(t)}const s=function(t,e){if((null==t?void 0:t.length)&&(null==e?void 0:e.length)){let r;t:for(let s=0;s<=t.length;s++){let n=!1;for(r=0;r<e.length;r++){if(!(s+r<t.length)){if(n)return s;break t}if(t[s+r]!==e[r])continue t;n=!0}}}return-1}(r,new Uint8Array(Xe)),n=(new TextDecoder).decode(-1===s?r:r.subarray(0,s));return this.authUserPassword(n)}if(5===this._revision)throw new Error("Not implemented yet");if(6===this._revision)throw new Error("Not implemented yet")}authUserPassword(t){let e;if(2===this._revision)return e=this.computeUHash_R2(t),Te(this._uPasswordHash,e);if(3===this._revision||4===this._revision)return e=this.computeUHash_R3R4(t),Te(this._uPasswordHash.subarray(0,16),e);if(5===this._revision)throw new Error("Not implemented yet");if(6===this._revision)throw new Error("Not implemented yet")}}class Ke{constructor(t){if(!(null==t?void 0:t.length))throw new Error("Data is empty");this._data=t,this._maxIndex=t.length-1}get maxIndex(){return this._maxIndex}getPdfVersion(){var t;const e=this.findSubarrayIndex(gt.VERSION);if(!e)throw new Error("PDF not valid. Version not found");const r=null===(t=this.parseNumberAt(e.end+1,!0))||void 0===t?void 0:t.value;if(!r)throw new Error("Error parsing version number");return r.toFixed(1)}getLastXrefIndex(){const t=this.findSubarrayIndex(gt.XREF_START,{maxIndex:this.maxIndex,direction:"reverse"});if(!t)return null;const e=this.parseNumberAt(t.end+1);return e||null}findSubarrayIndex(t,e){var r,s;const n=this._data;if(!(null==t?void 0:t.length))return null;const i=(null==e?void 0:e.direction)||"straight",a=Math.max(Math.min(null!==(r=null==e?void 0:e.minIndex)&&void 0!==r?r:0,this._maxIndex),0),o=Math.max(Math.min(null!==(s=null==e?void 0:e.maxIndex)&&void 0!==s?s:this._maxIndex,this._maxIndex),0),h=!(null==e?void 0:e.closedOnly);let c,d="straight"===i?a:o;if("straight"===i)t:for(;d<=o;d++){for(c=0;c<t.length;c++)if(n[d+c]!==t[c])continue t;if(h||!mt(n[d+c]))return{start:d,end:d+c-1}}else{const e=t.length-1;t:for(;d>=a;d--){for(c=0;c<t.length;c++)if(n[d-c]!==t[e-c])continue t;if(h||!mt(n[d-c]))return{start:d-c+1,end:d}}}return null}findCharIndex(t,e="straight",r){return this.findSingleCharIndex((e=>t===e),e,r)}findNewLineIndex(t="straight",e){let r=this.findSingleCharIndex((t=>t===b||t===v),t,e);return-1===r?-1:"straight"===t?(this._data[r]===b&&this._data[r+1]===v&&r++,Math.min(r+1,this._maxIndex)):(this._data[r]===v&&this._data[r-1]===b&&r--,Math.max(r-1,0))}findSpaceIndex(t="straight",e){return this.findSingleCharIndex((t=>yt.has(t)),t,e)}findNonSpaceIndex(t="straight",e){return this.findSingleCharIndex((t=>!yt.has(t)),t,e)}findDelimiterIndex(t="straight",e){return this.findSingleCharIndex((t=>wt.has(t)),t,e)}findNonDelimiterIndex(t="straight",e){return this.findSingleCharIndex((t=>!wt.has(t)),t,e)}findIrregularIndex(t="straight",e){return this.findSingleCharIndex((t=>!mt(t)),t,e)}findRegularIndex(t="straight",e){return this.findSingleCharIndex((t=>mt(t)),t,e)}getValueTypeAt(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t))return null;const r=this._data,s=t;switch(r[s]){case B:return mt(r[s+1])?ue:he;case K:return fe;case C:return le;case V:return V===r[s+1]?ge:pe;case E:return Ae;case I:case M:case N:case R:case D:case T:case L:case U:case O:case F:const t=this.findDelimiterIndex("straight",s+1);if(-1!==t){const e=this.findCharIndex(Q,"reverse",t-1);if(-1!==e&&e>s&&!mt(r[e+1]))return ye}return de;case k:case P:return n=r[s+1],At.has(n)?de:he;case dt:return r[s+1]===lt&&r[s+2]===ct&&r[s+3]===et&&r[s+4]===Z&&r[s+5]===it?we:he;case lt:return r[s+1]===ct&&r[s+2]===pt&&r[s+3]===et?ce:he;case rt:return r[s+1]===Z&&r[s+2]===nt&&r[s+3]===dt&&r[s+4]===et?ce:he;default:return he}var n}getIndirectObjectBoundsAt(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t))return null;const r=this.findSubarrayIndex(gt.OBJ,{minIndex:t,closedOnly:!0});if(!r)return null;let s=this.findNonSpaceIndex("straight",r.end+1);if(-1===s)return null;const n=this.findSubarrayIndex(gt.OBJ_END,{minIndex:s,closedOnly:!0});if(!n)return null;let i=this.findNonSpaceIndex("reverse",n.start-1);return this.getCharCode(s)===V&&this.getCharCode(s+1)===V&&this.getCharCode(i-1)===z&&this.getCharCode(i)===z&&(s+=2,i-=2),{start:r.start,end:n.end,contentStart:s,contentEnd:i}}getXrefTableBoundsAt(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t)||this._data[t]!==ut)return null;const r=this.findSubarrayIndex(gt.XREF_TABLE,{minIndex:t});if(!r)return null;const s=this.findNonSpaceIndex("straight",r.end+1);if(-1===s)return null;const n=this.findSubarrayIndex(gt.TRAILER,{minIndex:r.end+1});if(!n)return null;const i=this.findNonSpaceIndex("reverse",n.start-1);return i<s?null:{start:r.start,end:n.end,contentStart:s,contentEnd:i}}getDictBoundsAt(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t)||this._data[t]!==V||this._data[t+1]!==V)return null;const r=this.findNonSpaceIndex("straight",t+2);if(-1===r)return null;let s,n,i=1,a=!0,o=0,h=r;for(;i;)n=s,s=this._data[h++],s!==C||o&&n===J||o++,s===S&&o&&n!==J&&o--,o||(a?a=!1:s===V&&s===n?(i++,a=!0):s===z&&s===n&&(i--,a=!0));const c=h-1,d=this.findNonSpaceIndex("reverse",c-2);return d<r?{start:t,end:c}:{start:t,end:c,contentStart:r,contentEnd:d}}getArrayBoundsAt(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t)||this._data[t]!==K)return null;let r,s=0,n=t+1;for(;s||r!==Y;)r=this._data[n++],r===K?s++:s&&r===Y&&s--;const i=n-1;return i-t<1?null:{start:t,end:i}}getHexBounds(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t)||this.getCharCode(t)!==V)return null;const r=this.findCharIndex(z,"straight",t+1);return-1===r?null:{start:t,end:r}}getLiteralBounds(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t)||this.getCharCode(t)!==C)return null;let r,s,n=t+1,i=0;for(;i||s!==S||r===J;){if(n>this._maxIndex)return null;isNaN(s)||(r=s),s=this.getCharCode(n++),r!==J&&(s===C?i+=1:i&&s===S&&(i-=1))}return{start:t,end:n-1}}parseNumberAt(t,e=!1,r=!0){if(r&&(t=this.skipEmpty(t)),this.isOutside(t)||!mt(this._data[t]))return null;let s=t,n="",i=this._data[s];for(i===P?(n+="-",i=this._data[++s]):i===k&&(n+="0.",i=this._data[++s]);At.has(i)||e&&i===k;)n+=String.fromCharCode(i),i=this._data[++s];return n?{value:+n,start:t,end:s-1}:null}parseNameAt(t,e=!0,r=!0){if(r&&(t=this.skipEmpty(t)),this.isOutside(t)||this._data[t]!==B)return null;let s=t+1,n=e?"/":"",i=this._data[s];for(;mt(i);)n+=String.fromCharCode(i),i=this._data[++s];return n.length>1?{value:n,start:t,end:s-1}:null}parseStringAt(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t))return null;let r=t,s="",n=this._data[r];for(;mt(n);)s+=String.fromCharCode(n),n=this._data[++r];return 0!==s.length?{value:s,start:t,end:r-1}:null}parseBoolAt(t,e=!0){if(e&&(t=this.skipEmpty(t)),this.isOutside(t))return null;const r=this.findSubarrayIndex(gt.TRUE,{minIndex:t});if(r)return{value:!0,start:t,end:r.end};const s=this.findSubarrayIndex(gt.FALSE,{minIndex:t});return s?{value:!0,start:t,end:s.end}:null}parseNumberArrayAt(t,e=!0,r=!0){const s=this.getArrayBoundsAt(t,r);if(!s)return null;const n=[];let i,a=s.start+1;for(;a<s.end&&(i=this.parseNumberAt(a,e,!0),i);)n.push(i.value),a=i.end+1;return{value:n,start:s.start,end:s.end}}parseNameArrayAt(t,e=!0,r=!0){const s=this.getArrayBoundsAt(t,r);if(!s)return null;const n=[];let i,a=s.start+1;for(;a<s.end&&(i=this.parseNameAt(a,e,!0),i);)n.push(i.value),a=i.end+1;return{value:n,start:s.start,end:s.end}}parseDictType(t){return this.parseDictNameProperty(gt.TYPE,t)}parseDictSubtype(t){return this.parseDictNameProperty(gt.SUBTYPE,t)}parseDictNameProperty(t,e){const r=this.findSubarrayIndex(t,{minIndex:e.start,maxIndex:e.end});if(!r)return null;const s=this.parseNameAt(r.end+1);return s?s.value:null}skipEmpty(t){let e=this.findNonSpaceIndex("straight",t);if(-1===e)return-1;if(this._data[e]===E){const t=this.findNewLineIndex("straight",e+1);if(-1===t)return-1;e=this.findNonSpaceIndex("straight",t)}return e}skipToNextName(t,e){if(t||(t=0),(e=e?Math.min(e,this._maxIndex):0)<t)return-1;let r=t;for(;r<=e;){const t=this.getValueTypeAt(r,!0);if(t){let e;switch(t){case ge:e=this.getDictBoundsAt(r,!1);break;case fe:e=this.getArrayBoundsAt(r,!1);break;case le:e=this.getLiteralBounds(r,!1);break;case pe:e=this.getHexBounds(r,!1);break;case de:const t=this.parseNumberAt(r,!0,!1);t&&(e=t);break;case ce:const s=this.parseBoolAt(r,!1);s&&(e=s);break;case Ae:break;case ue:return r;default:r++;continue}if(e){r=e.end+1,e=null;continue}}r++}return-1}getCharCode(t){return this._data[t]}getChar(t){const e=this._data[t];return isNaN(e)?null:String.fromCharCode(e)}sliceCharCodes(t,e){return this._data.slice(t,(e||t)+1)}sliceChars(t,e){return String.fromCharCode(...this._data.slice(t,(e||t)+1))}subCharCodes(t,e){return this._data.subarray(t,(e||t)+1)}isOutside(t){return t<0||t>this._maxIndex}getValidStartIndex(t,e){return isNaN(e)?"straight"===t?0:this._maxIndex:Math.max(Math.min(e,this._maxIndex),0)}findSingleCharIndex(t,e="straight",r){const s=this._data;let n=this.getValidStartIndex(e,r);if("straight"===e){for(;n<=this._maxIndex;n++)if(t(s[n]))return n}else for(;n>=0;n--)if(t(s[n]))return n;return-1}}class Je{constructor(t,e,r,s,n,i,a){this.type=t,this.id=e,this.generation=r,this.byteOffset=s,this.nextFreeId=n,this.streamId=i,this.streamIndex=a}static*fromTableBytes(t){let e=0,r=0;for(;e<t.length;){const s=[];let n=t[e++];for(;At.has(n);)s.push(n),n=t[e++];let i=parseInt(s.map((t=>String.fromCharCode(t))).join(""),10);const a=[];let o=t[e++];for(;At.has(o);)a.push(o),o=t[e++];const h=parseInt(a.map((t=>String.fromCharCode(t))).join(""),10);for(;!At.has(t[e]);)e++;for(r=0;r<h;r++){const r=parseInt(Array.from(t.subarray(e,e+10)).map((t=>String.fromCharCode(t))).join(""),10);e+=11;const s=parseInt(Array.from(t.subarray(e,e+5)).map((t=>String.fromCharCode(t))).join(""),10);e+=6;const n=t[e];n===rt?yield new Je(Pt,i++,s,null,r):n===at&&(yield new Je(kt,i++,s,r)),e+=3}}}static*fromStreamBytes(t,e,r){const[s,n,i]=e,a=s+n+i;if(t.length%a)throw new Error("Incorrect stream length");const o=t.length/a,h=new Array(o);if(null==r?void 0:r.length){let t,e,s=0;for(let n=0;n<r.length;n++)if(n%2)for(e=0;e<r[n];e++)h[s++]=t+e;else t=r[n]}else{let t=0;for(;t<o;)h[t++]=t}let c,d,l,p=0,u=0;for(;p<t.length;)switch(c=s?Ie(t.slice(p,p+s)):1,p+=s,d=Ie(t.slice(p,p+n)),p+=n,l=i?Ie(t.slice(p,p+i)):null,p+=i,c){case Pt:yield new Je(Pt,h[u++],null!=l?l:65535,null,d);break;case kt:yield new Je(kt,h[u++],null!=l?l:0,d);break;case Bt:yield new Je(Bt,h[u++],0,null,null,d,l)}}static toTableBytes(t){if(!(null==t?void 0:t.length))return null;const e=new TextEncoder,r=this.groupEntries(t);let s,n,i=new Uint8Array;for(const t of r){n=`${t[0]} ${t[1].length}\r\n`,s=new Uint8Array(i.length+n.length),s.set(i),s.set(e.encode(n),i.length),i=s;for(const r of t[1]){switch(r.type){case Pt:n=`${r.nextFreeId.toString().padStart(10,"0")} ${r.generation.toString().padStart(5,"0")} f\r\n`;break;case kt:n=`${r.byteOffset.toString().padStart(10,"0")} ${r.generation.toString().padStart(5,"0")} n\r\n`;break;default:continue}s=new Uint8Array(i.length+n.length),s.set(i),s.set(e.encode(n),i.length),i=s}}return i}static toStreamBytes(t,e=[1,4,2]){if(!(null==t?void 0:t.length))return null;if(Math.min(...e)<0)throw new Error("Negative length values are not permitted");let[r,s,n]=e;null!=r||(r=0),null!=s||(s=4),null!=n||(n=0);const i=r+s+n;let a,o,h;switch(r){case 0:a=()=>new Uint8Array;break;case 1:a=Me;break;case 2:a=Ne;break;default:o=t=>new Uint8Array([...new Array(r-2).fill(0),...Ne(t)])}switch(s){case 1:o=Me;break;case 2:o=Ne;break;case 3:o=t=>new Uint8Array([0,...Ne(t)]);break;case 4:o=Re;break;default:o=t=>new Uint8Array([...new Array(r-4).fill(0),...Re(t)])}switch(n){case 0:h=()=>new Uint8Array;break;case 1:h=Me;break;case 2:h=Ne;break;default:o=t=>new Uint8Array([...new Array(r-2).fill(0),...Ne(t)])}new TextEncoder;const c=this.groupEntries(t),d=[];let l,p,u,f,g=new Uint8Array;for(const t of c){d.push(t[0],t[1].length);for(const e of t[1]){switch(e.type){case Pt:p=a(0),u=o(e.nextFreeId),f=h(e.generation);break;case kt:p=a(1),u=o(e.byteOffset),f=h(e.generation);break;case Bt:p=a(2),u=o(e.streamId),f=h(e.streamIndex);break;default:continue}l=new Uint8Array(g.length+i),l.set(g),l.set(p,g.length),l.set(u,g.length+r),l.set(f,g.length+r+s),g=l}}return{bytes:g,index:d}}static groupEntries(t){t.sort(((t,e)=>t.id-e.id));const e=[];let r,s,n;for(const i of t)i.id!==n+1?((null==s?void 0:s.length)&&e.push([r,s]),r=i.id,s=[i]):s.push(i),n=i.id;return(null==s?void 0:s.length)&&e.push([r,s]),e}}class Ye{constructor(t){var e;const r=[],s=[],n=[];let i=0;t.forEach((t=>{for(const e of t.getEntries()){switch(e.type){case Pt:r.push(e);break;case kt:s.push(e);break;case Bt:n.push(e);break;default:continue}e.id>i&&(i=e.id)}})),this.size=i+1;const a={id:0,generation:65535,nextFreeId:0},o=new d(a),h=new Map,c=new Map;let l=!1;for(const t of r){if(!l&&0===t.id){l=!0,a.nextFreeId=t.nextFreeId;continue}const e=c.get(t.id);(!e||e.generation<t.generation)&&c.set(t.id,{id:t.id,generation:t.generation,nextFreeId:t.nextFreeId})}let p,u=a.nextFreeId;for(;u;)p=c.get(u),c.delete(u),o.push(p),u=p.nextFreeId;[...c].forEach((t=>{const e=t[1];65535===e.generation&&0===e.nextFreeId&&h.set(e.id,e)})),this.freeLinkedList=o,this.freeOutsideListMap=h;const f=new Map;for(const t of s){if(this.isFreed(t))continue;const e=f.get(t.id);e&&e.generation>=t.generation||f.set(t.id,{id:t.id,generation:t.generation,byteOffset:t.byteOffset})}for(const t of n){if(this.isFreed(t))continue;if(f.get(t.id))continue;const r=null===(e=f.get(t.streamId))||void 0===e?void 0:e.byteOffset;r&&f.set(t.id,{id:t.id,generation:t.generation,byteOffset:r,compressed:!0,streamId:t.streamId,streamIndex:t.streamIndex})}this.usedMap=f}getOffset(t){var e;return null===(e=this.usedMap.get(t))||void 0===e?void 0:e.byteOffset}getGeneration(t){var e;return null===(e=this.usedMap.get(t))||void 0===e?void 0:e.generation}isFreed(t){return this.freeOutsideListMap.has(t.id)||this.freeLinkedList.has(t,((t,e)=>t.id===e.id&&t.generation<e.generation))}isUsed(t){return this.usedMap.has(t)}}class Ze{constructor(t){this._refData=t,this._size=t.size;const e=new d;for(const r of t.freeLinkedList)e.push(Object.assign({},r));this._freeLinkedList=e,this._usedMap=new Map}get size(){return this._size}takeFreeRef(t,e=!1){let r;if(!e&&this._freeLinkedList.length>1){const e=this._freeLinkedList.pop();this._freeLinkedList.tail.nextFreeId=0,r={id:e.id,generation:e.generation,byteOffset:t}}else r={id:this._size++,generation:0,byteOffset:t};return this._usedMap.set(r.id,r),r}setRefFree(t){if(this._usedMap.has(t)&&(this._usedMap.delete(t),this._size>this._refData.size&&this._size===t+1&&this._size--),this._refData.isUsed(t)){const e={id:t,generation:this._refData.getGeneration(t)+1,nextFreeId:0};if(-1!==this._freeLinkedList.findIndex(e,((t,e)=>t.id===e.id&&t.generation<=e.generation)))return;this._freeLinkedList.tail.nextFreeId=t,this._freeLinkedList.push(e)}}updateUsedRef(t){if(t.compressed&&t.generation)throw new Error(`Compressed ref generation can't be greater than zero: '${t.id} ${t.generation} R'`);if(this.isFreed(t))throw new Error(`The reference is freed: '${t.id} ${t.generation} R'`);const e=this._usedMap.get(t.id);if(e)throw new Error(`Same reference has been issued twice: '${e.id} ${e.generation} R'`);if(this._refData.isUsed(t.id)){const r=this._refData.getGeneration(t.id);if(t.generation>=r)return this._usedMap.set(t.id,t),!0;throw new Error(`The reference has an old generation: '${e.id} ${e.generation} R'`)}throw new Error(`The reference is not used: '${e.id} ${e.generation} R'`)}exportEntries(){const t=[];for(const e of this._freeLinkedList)t.push(new Je(Pt,e.id,e.generation,null,e.nextFreeId));return this._usedMap.forEach((e=>{e.compressed?t.push(new Je(Bt,e.id,0,null,null,e.streamId,e.streamIndex)):t.push(new Je(kt,e.id,e.generation,e.byteOffset))})),t}isFreed(t){return this._freeLinkedList.has(t,((t,e)=>t.id===e.id&&t.generation<e.generation))}isUsedInSource(t){return this._refData.isUsed(t)}}class $e{constructor(t){if(!(null==t?void 0:t.length))throw new Error("Data is empty");this._data=[...t],this._pointer=t.length,this._encoder=new TextEncoder,this.fixEof()}get offset(){return this._pointer}getCurrentData(){return new Uint8Array(this._data)}writeBytes(t){(null==t?void 0:t.length)&&(this._data.push(...t),this._pointer+=t.length)}writeIndirectObject(t,e){if(!(null==t?void 0:t.ref)||!e)return;const r=[...this._encoder.encode(`${t.ref.id} ${t.ref.generation} `),...gt.OBJ,...gt.END_OF_LINE,...e.toArray(t),...gt.END_OF_LINE,...gt.OBJ_END,...gt.END_OF_LINE];this.writeBytes(r)}writeIndirectArray(t,e){if(!(null==t?void 0:t.ref)||!e)return;const r=[...this._encoder.encode(`${t.ref.id} ${t.ref.generation} `),...gt.OBJ,...gt.END_OF_LINE,K];for(const s of e)r.push(_,...s.toArray(t));r.push(Y,...gt.END_OF_LINE,...gt.OBJ_END,...gt.END_OF_LINE),this.writeBytes(r)}writeEof(t){const e=[...gt.XREF_START,...gt.END_OF_LINE,...this._encoder.encode(t+""),...gt.END_OF_LINE,...gt.END_OF_FILE,...gt.END_OF_LINE];this.writeBytes(e)}fixEof(){this._data[this._pointer-1]!==v&&(this._data[this._pointer-2]!==b?(this._data.push(b,v),this._pointer+=2):(this._data.push(v),this._pointer+=1))}}class tr{constructor(t,e){this.id=null!=t?t:0,this.generation=null!=e?e:0}static parse(t,e,r=!0){if(r&&(e=t.findRegularIndex("straight",e)),e<0||e>t.maxIndex)return null;const s=t.parseNumberAt(e,!1,!1);if(!s||isNaN(s.value))return null;const n=t.parseNumberAt(s.end+2,!1,!1);return!n||isNaN(n.value)?null:{value:new tr(s.value,n.value),start:e,end:n.end}}static parseRef(t,e,r=!0){const s=tr.parse(t,e,r);if(!s)return null;const n=s.end+2,i=t.findSubarrayIndex([Q],{minIndex:n,closedOnly:!0});return i&&i.start===n?{value:s.value,start:s.start,end:i.end}:null}static parseRefArray(t,e,r=!0){const s=t.getArrayBoundsAt(e,r);if(!s)return null;const n=[];let i,a=s.start+1;for(;a<s.end&&(i=tr.parseRef(t,a,!0),i);)n.push(i.value),a=i.end+1;return{value:n,start:s.start,end:s.end}}static fromRef(t){return new tr(t.id,t.generation)}equals(t){return this.id===t.id&&this.generation===t.generation}toArray(t){return(new TextEncoder).encode(`${this.id} ${this.generation} R`)}toString(){return this.id+"|"+this.generation}}class er{constructor(t,e){this._source=t,this._date=new Date(e)}get source(){return this._source}get date(){return new Date(this._date)}static parse(t,e,r=null,s=!0){if(s&&(e=t.skipEmpty(e)),t.isOutside(e)||t.getCharCode(e)!==C)return null;const n=t.findCharIndex(S,"straight",e);if(-1===n)return null;let i=t.subCharCodes(e+1,n-1);(null==r?void 0:r.ref)&&r.stringCryptor&&(i=r.stringCryptor.decrypt(i,r.ref));try{return{value:er.fromArray(i),start:e,end:n}}catch(t){return null}}static fromDate(t){const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),a=String(t.getSeconds()).padStart(2,"0");return new er(`D:${e}${r}${s}${n}${i}${a}`,t)}static fromString(t){const e=/D:(?<Y>\d{4})(?<M>\d{2})(?<D>\d{2})(?<h>\d{2})(?<m>\d{2})(?<s>\d{2})/.exec(t),r=new Date(+e.groups.Y,+e.groups.M-1,+e.groups.D,+e.groups.h,+e.groups.m,+e.groups.s);return new er(t,r)}static fromArray(t){const e=(new TextDecoder).decode(t);return er.fromString(e)}toArray(t){let e=(new TextEncoder).encode(this._source);return(null==t?void 0:t.ref)&&t.stringCryptor&&(e=t.stringCryptor.encrypt(e,t.ref)),new Uint8Array([...gt.STR_LITERAL_START,...e,...gt.STR_LITERAL_END])}}class rr{constructor(t,e){this._literal=t,this._bytes=e}get literal(){return this._literal}get bytes(){return this._bytes.slice()}static parse(t,e,r=null,s=!0){const n=t.getLiteralBounds(e,s);if(!n)return;let i=rr.unescape(t.subCharCodes(n.start+1,n.end-1));(null==r?void 0:r.ref)&&r.stringCryptor&&(i=r.stringCryptor.decrypt(i,r.ref));return{value:rr.fromBytes(i),start:n.start,end:n.end}}static fromBytes(t){const e=(254===t[0]&&255===t[1]?new TextDecoder("utf-16be"):new TextDecoder).decode(t);return new rr(e,t)}static fromString(t){const e=[];e.push(254,255);for(let r=0;r<t.length;r++){const s=t.charCodeAt(r);e.push((65280&s)>>>8),e.push(255&s)}return new rr(t,new Uint8Array(e))}static escape(t){const e=[];for(let r=0;r<t.length;r++)switch(t[r]){case v:e.push(J),e.push(at);break;case b:e.push(J),e.push(ct);break;case m:e.push(J),e.push(lt);break;case A:e.push(J),e.push($);break;case x:e.push(J),e.push(rt);break;case C:e.push(J),e.push(C);break;case S:e.push(J),e.push(S);break;case J:e.push(J),e.push(J);break;default:e.push(t[r])}return new Uint8Array(e)}static unescape(t){const e=[];let r=!1;for(let s=0;s<t.length;s++)if(r){switch(t[s]){case at:e.push(v);break;case ct:e.push(b);break;case lt:e.push(m);break;case $:e.push(A);break;case rt:e.push(x);break;case C:e.push(C);break;case S:e.push(S);break;case J:e.push(J);break;default:e.push(t[s])}r=!1}else t[s]!==J?e.push(t[s]):r=!0;return new Uint8Array(e)}toArray(t){const e=(null==t?void 0:t.ref)&&t.stringCryptor?t.stringCryptor.encrypt(this._bytes,t.ref):this._bytes;return new Uint8Array([...gt.STR_LITERAL_START,...rr.escape(e),...gt.STR_LITERAL_END])}}class sr{constructor(){this._edited=!1,this._deleted=!1,this.onChange={set:(t,e,r)=>(this._edited||"_"===e[0]||(this._edited=!0,console.log(`EDITED prop ${e}`),console.log(this)),t[e]=r,!0)}}get ref(){return this._ref}set ref(t){this._ref=t}get id(){var t;return null===(t=this._ref)||void 0===t?void 0:t.id}get generation(){var t;return null===(t=this._ref)||void 0===t?void 0:t.generation}get edited(){return this._edited}get deleted(){return this._deleted}markAsDeleted(t=!0){this._deleted=t}parseRefProp(t,e,r){const s=tr.parseRef(e,r);return this.setParsedProp(t,s)}parseRefArrayProp(t,e,r){const s=tr.parseRefArray(e,r);return this.setParsedProp(t,s)}parseBoolProp(t,e,r){const s=e.parseBoolAt(r);return this.setParsedProp(t,s)}parseNameProp(t,e,r,s=!0){const n=e.parseNameAt(r,s);return this.setParsedProp(t,n)}parseNameArrayProp(t,e,r,s=!0){const n=e.parseNameArrayAt(r,s);return this.setParsedProp(t,n)}parseNumberProp(t,e,r,s=!0){const n=e.parseNumberAt(r,s);return this.setParsedProp(t,n)}parseNumberArrayProp(t,e,r,s=!0){const n=e.parseNumberArrayAt(r,s);return this.setParsedProp(t,n)}parseDateProp(t,e,r,s){const n=er.parse(e,r,s);return this.setParsedProp(t,n)}parseLiteralProp(t,e,r,s){const n=rr.parse(e,r,s);return this.setParsedProp(t,n)}setParsedProp(t,e){if(!e)throw new Error(`Can't parse ${t} property value`);return this[t.slice(1)]=e.value,e.end+1}}class nr extends sr{constructor(t){super(),this.Type=t}get streamId(){return this._streamId}toArray(t){const e=new TextEncoder,r=[...gt.DICT_START];return this.Type&&r.push(...gt.TYPE,...e.encode(this.Type)),r.push(...gt.DICT_END),new Uint8Array(r)}parseProps(t){var e;if(!t)throw new Error("Parse info is empty");this._ref=null===(e=t.cryptInfo)||void 0===e?void 0:e.ref,this._streamId=t.streamId;const{parser:r,bounds:s}=t,n=s.contentStart||s.start,i=s.contentEnd||s.end;let a,o,h=r.skipToNextName(n,i-1);if(-1===h)throw new Error("Dict is empty (has no properties)");for(;o=r.parseNameAt(h),o;)switch(h=o.end+1,a=o.value,a){case"/Type":const t=r.parseNameAt(h);if(t){if(this.Type&&this.Type!==t.value)throw new Error(`Ivalid dict type: '${t.value}' instead of '${this.Type}'`);return}throw new Error("Can't parse /Type property value");default:h=r.skipToNextName(h,i-1)}}}class ir extends nr{constructor(){super(ae),this._intPropMap=new Map,this._boolPropMap=new Map,this._namePropMap=new Map,this._refPropMap=new Map}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new ir;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}static parseArray(t,e,r=null,s=!0){const n=t.getArrayBoundsAt(e,s);if(!n)return null;const i=[];let a,o=n.start+1;for(;o<n.end;){const e=t.getDictBoundsAt(o);if(a=ir.parse({parser:t,bounds:e,cryptInfo:r}),!a)break;i.push(a.value),o=a.end+1}return{value:i,start:n.start,end:n.end}}getIntProp(t){return this._intPropMap.get(t)}getBoolProp(t){return this._boolPropMap.get(t)}getNameProp(t){return this._namePropMap.get(t)}getRefProp(t){return this._refPropMap.get(t)}setIntProp(t,e){return this._intPropMap.set(t,e)}setBoolProp(t,e){return this._boolPropMap.set(t,e)}setNameProp(t,e){return this._namePropMap.set(t,e)}setRefProp(t,e){return this._refPropMap.set(t,e)}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this._intPropMap.forEach(((t,e)=>s.push(...r.encode(e),...r.encode(" "+t)))),this._boolPropMap.forEach(((t,e)=>s.push(...r.encode(e),...r.encode(" "+t)))),this._namePropMap.forEach(((t,e)=>s.push(...r.encode(e),...r.encode(t)))),this._refPropMap.forEach(((e,n)=>s.push(...r.encode(n),...e.toArray(t))));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;){o=a.end+1,i=a.value;switch(e.getValueTypeAt(o)){case de:const t=e.parseNumberAt(o,!1);if(t){this._intPropMap.set(i,t.value),o=t.end+1;continue}break;case ce:const r=e.parseBoolAt(o);if(r){this._boolPropMap.set(i,r.value),o=r.end+1;continue}break;case ue:const s=e.parseNameAt(o);if(s){this._namePropMap.set(i,s.value),o=s.end+1;continue}break;case ye:const n=tr.parseRef(e,o);if(n){this._refPropMap.set(i,n.value),o=n.end+1;continue}}o=e.skipToNextName(o,n-1)}}}class ar extends class{constructor(t){this._minBufferLength=512,this._bufferLength=0,this._current=0,this._ended=!1,this._sourceStream=t}get length(){return this._buffer.length}ensureBuffer(t){const e=this._buffer;if(e&&t<=e.byteLength)return e;let r=this._minBufferLength;for(;r<t;)r*=2;const s=new Uint8Array(r);return e&&s.set(e),this._buffer=s}takeByte(){const t=this._current;for(;this._bufferLength<=t;){if(this._ended)return-1;this._readBlock()}return this._buffer[this._current++]}takeBytes(t){let e;const r=this._current;if(t){for(this.ensureBuffer(r+t),e=r+t;!this._ended&&this._bufferLength<e;)this._readBlock();e>this._bufferLength&&(e=this._bufferLength)}else{for(;!this._ended;)this._readBlock();e=this._bufferLength}this._current=e;return this._buffer.subarray(r,e)}takeUint16(){const t=this.takeByte(),e=this.takeByte();return-1===t||-1===e?-1:(t<<8)+e}takeInt32(){return(this.takeByte()<<24)+(this.takeByte()<<16)+(this.takeByte()<<8)+this.takeByte()}peekByte(){const t=this.takeByte();return-1!==t&&this._current--,t}peekBytes(t){const e=this.takeBytes(t);return this._current-=e.length,e}skip(t){this._current+=t||1}reset(){this._current=0}}{constructor(t){super(t),this._codeSize=0,this._codeBuf=0;const e=t.takeByte(),r=t.takeByte();if(-1===e||-1===r)throw new Error(`Invalid header in flate stream: ${e}, ${r}`);if(8!=(15&e))throw new Error(`Unknown compression method in flate stream: ${e}, ${r}`);if(((e<<8)+r)%31!=0)throw new Error(`Bad FCHECK in flate stream: ${e}, ${r}`);if(32&r)throw new Error(`FDICT bit set in flate stream: ${e}, ${r}`);this._codeSize=0,this._codeBuf=0}_readBlock(){let t,e;const r=this._sourceStream;let s,n,i=this.getBits(3);if(1&i&&(this._ended=!0),i>>=1,0===i){let e;if(-1===(e=r.takeByte()))throw new Error("Bad block header in flate stream");let s=e;if(-1===(e=r.takeByte()))throw new Error("Bad block header in flate stream");if(s|=e<<8,-1===(e=r.takeByte()))throw new Error("Bad block header in flate stream");let n=e;if(-1===(e=r.takeByte()))throw new Error("Bad block header in flate stream");if(n|=e<<8,n!==(65535&~s)&&(0!==s||0!==n))throw new Error("Bad uncompressed block length in flate stream");this._codeBuf=0,this._codeSize=0;const i=this._bufferLength,a=i+s;if(t=this.ensureBuffer(a),this._bufferLength=a,0===s)-1===r.peekByte()&&(this._ended=!0);else{const e=r.takeBytes(s);t.set(e,i),e.length<s&&(this._ended=!0)}return}if(1===i)s=ar.fixedLitCodeTab,n=ar.fixedDistCodeTab;else{if(2!==i)throw new Error("Unknown block type in flate stream");{const t=this.getBits(5)+257,r=this.getBits(5)+1,i=this.getBits(4)+4,a=new Uint8Array(ar.codeLenCodeMap.length);let o;for(o=0;o<i;o++)a[ar.codeLenCodeMap[o]]=this.getBits(3);const h=this.generateHuffmanTable(a);e=0,o=0;const c=t+r,d=new Uint8Array(c);let l,p,u;for(;o<c;){const t=this.getCode(h);if(16===t)l=2,p=3,u=e;else if(17===t)l=3,p=3,u=e=0;else{if(18!==t){d[o++]=e=t;continue}l=7,p=11,u=e=0}let r=this.getBits(l)+p;for(;r-- >0;)d[o++]=u}s=this.generateHuffmanTable(d.subarray(0,t)),n=this.generateHuffmanTable(d.subarray(t,c))}}t=this._buffer;let a=t?t.length:0,o=this._bufferLength;for(;;){let r=this.getCode(s);if(r<256){o+1>=a&&(t=this.ensureBuffer(o+1),a=t.length),t[o++]=r;continue}if(256===r)return void(this._bufferLength=o);r-=257,r=ar.lengthDecode[r];let i=r>>16;i>0&&(i=this.getBits(i)),e=(65535&r)+i,r=this.getCode(n),r=ar.distDecode[r],i=r>>16,i>0&&(i=this.getBits(i));const h=(65535&r)+i;o+e>=a&&(t=this.ensureBuffer(o+e),a=t.length);for(let r=0;r<e;++r,++o)t[o]=t[o-h]}}getBits(t){const e=this._sourceStream;let r,s=this._codeSize,n=this._codeBuf;for(;s<t;){if(-1===(r=e.takeByte()))throw new Error("Bad encoding in flate stream");n|=r<<s,s+=8}return r=n&(1<<t)-1,this._codeBuf=n>>t,this._codeSize=s-=t,r}getCode(t){const e=this._sourceStream,[r,s]=t;let n,i=this._codeSize,a=this._codeBuf;for(;i<s&&-1!==(n=e.takeByte());)a|=n<<i,i+=8;const o=r[a&(1<<s)-1],h=o>>16,c=65535&o;if(h<1||i<h)throw new Error("Bad encoding in flate stream");return this._codeBuf=a>>h,this._codeSize=i-h,c}generateHuffmanTable(t){const e=t.length;let r,s=0;for(r=0;r<e;r++)t[r]>s&&(s=t[r]);const n=1<<s,i=new Int32Array(n);for(let a=1,o=0,h=2;a<=s;a++,o<<=1,h<<=1)for(let s=0;s<e;s++)if(t[s]===a){let t=0,e=o;for(r=0;r<a;r++)t=t<<1|1&e,e>>=1;for(r=t;r<n;r+=h)i[r]=a<<16|s;o++}return[i,s]}}ar.codeLenCodeMap=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ar.lengthDecode=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),ar.distDecode=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),ar.fixedLitCodeTab=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],ar.fixedDistCodeTab=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];class or{constructor(t,e=0,r){if(r&&r<0)throw new Error("Stream length can't be negative");this._bytes=t instanceof Uint8Array?t:new Uint8Array(t),this._start=e,this._current=e,this._end=e+r||t.length}get length(){return this._end-this._start}takeByte(){return this._current>=this._end?-1:this._bytes[this._current++]}takeBytes(t){const e=this._bytes,r=this._current,s=this._end;if(t){let n=r+t;n>s&&(n=s),this._current=n;return e.subarray(r,n)}return e.subarray(r,s)}takeUint16(){const t=this.takeByte(),e=this.takeByte();return-1===t||-1===e?-1:(t<<8)+e}takeInt32(){return(this.takeByte()<<24)+(this.takeByte()<<16)+(this.takeByte()<<8)+this.takeByte()}peekByte(){const t=this.takeByte();return-1!==t&&this._current--,t}peekBytes(t){const e=this.takeBytes(t);return this._current-=e.length,e}getByte(t){return this._bytes[t]}getByteRange(t,e){return this._bytes.subarray(Math.max(t,0),Math.min(e,this._end))}skip(t){this._current+=t||1}reset(){this._current=this._start}}class hr{static Decode(t,e=Dt,r=1,s=1,n=8){const i=new or(t,0,t.length),a=new ar(i).takeBytes(null);switch(e){case Dt:return a;case Lt:case Ut:case Ot:case Ft:case Vt:case zt:return hr.removePngFilter(a,r,s,n);case Tt:throw new Error("Unsupported filter predictor")}}static Encode(t,e=Ot,r=5,s=1,n=8){let i;switch(e){case Dt:i=t;break;case Lt:case Ut:case Ot:case Ft:case Vt:case zt:i=hr.applyPngFilter(t,e,r,s,n);break;case Tt:throw new Error("Unsupported filter predictor")}return a.deflate(i)}static removePngFilter(t,e,r,s){const n=Math.ceil(r*s/8),i=e*n,a=i+1;if(t.length%a)throw new Error("Data length doesn't match filter columns");const o=new Uint8Array(t.length/a*i),h=new Array(i).fill(0),c=new Array(i).fill(0),d=t=>t-n<0?0:c[t-n],l=t=>h[t];let p=0,u=0,f=0,g=0,w=0,y=0;for(let e=0;e<t.length;e++)if(e%a==0){if(w=t[e],p=0,e)for(f=0;f<i;f++)h[f]=o[g+f];g=u}else{switch(c[p]=t[e],w){case 0:y=c[p];break;case 1:y=(c[p]+d(p))%256;break;case 2:y=(c[p]+l(p))%256;break;case 3:y=(c[p]+Math.floor((l(p)+d(p))/2))%256;break;case 4:y=(c[p]+this.paethPredictor(d(p),l(p),(A=p)-n<0?0:h[A-n]))%256}o[u++]=y,p++}var A;return o}static applyPngFilter(t,e=12,r=5,s=1,n=8){let i;switch(e){case Lt:i=0;break;case Ut:i=1;break;case Ot:i=2;break;case Ft:i=3;break;case Vt:i=4;break;default:throw new Error("Invalid PNG filter type")}const a=Math.ceil(s*n/8),o=r*a,h=o+1,c=Math.ceil(t.length/o)*h,d=new Uint8Array(c),l=new Array(o).fill(0),p=new Array(o).fill(0),u=t=>t-a<0?0:p[t-a],f=t=>l[t];let g=0,w=0,y=0,A=0,m=0;for(let e=0;e<c;e++)if(e%h==0){if(g=0,e)for(y=0;y<o;y++)l[y]=t[A+y];A=w,d[e]=i}else{switch(p[g]=t[w++]||0,i){case 0:m=p[g];break;case 1:m=(p[g]-u(g))%256;break;case 2:m=(p[g]-f(g))%256;break;case 3:m=(p[g]-Math.floor((f(g)+u(g))/2))%256;break;case 4:m=(p[g]-this.paethPredictor(u(g),f(g),(v=g)-a<0?0:l[v-a]))%256}d[e]=m,g++}var v;return d}static paethPredictor(t,e,r){const s=t+e-r,n=Math.abs(s-t),i=Math.abs(s-e),a=Math.abs(s-r);return n<=i&&n<=a?t:i<=a?e:r}}class cr extends sr{constructor(t){super(),this.Type=t}get streamData(){return this._streamData}set streamData(t){this.setStreamData(t),this._edited=!0}get decodedStreamData(){return this._decodedStreamData||this.decodeStreamData(),this._decodedStreamData}toArray(t){const e=(null==t?void 0:t.ref)&&t.streamCryptor?t.streamCryptor.encrypt(this.streamData,t.ref):this.streamData,r=new TextEncoder,s=[...gt.DICT_START];return s.push(...r.encode("/Length "),...r.encode(" "+e.length)),this.Type&&s.push(...gt.TYPE,...r.encode(this.Type)),this.Filter&&s.push(...r.encode("/Filter "),...r.encode(this.Filter)),this.DecodeParms&&s.push(...r.encode("/DecodeParms "),...this.DecodeParms.toArray(t)),s.push(...gt.DICT_END,...gt.END_OF_LINE,...gt.STREAM_START,...gt.END_OF_LINE,...e,...gt.END_OF_LINE,...gt.STREAM_END),new Uint8Array(s)}parseProps(t){var e,r;if(!t)throw new Error("Parse info is empty");this._ref=null===(e=t.cryptInfo)||void 0===e?void 0:e.ref;const{parser:s,bounds:n}=t,i=n.contentStart||n.start,a=n.contentEnd||n.end,o=s.findSubarrayIndex(gt.STREAM_END,{direction:"reverse",minIndex:i,maxIndex:a,closedOnly:!0});if(!o)throw new Error("Object is not a stream");const h=s.findSubarrayIndex(gt.STREAM_START,{direction:"reverse",minIndex:i,maxIndex:o.start-1,closedOnly:!0});if(!h)throw new Error("Stream start is out of the data bounds");const c=s.getDictBoundsAt(i);let d,l,p=s.skipToNextName(c.contentStart,c.contentEnd);if(-1===p)throw new Error("Dict is empty (has no properties)");for(;l=s.parseNameAt(p),l;)switch(p=l.end+1,d=l.value,d){case"/Type":const e=s.parseNameAt(p);if(!e)throw new Error("Can't parse /Type property value");if(this.Type&&this.Type!==e.value)throw new Error(`Ivalid dict type: '${e.value}' instead of '${this.Type}'`);p=e.end+1;break;case"/Length":case"/DL":p=this.parseNumberProp(d,s,p,!1);break;case"/Filter":const r=s.getValueTypeAt(p);if(r===ue){const t=s.parseNameAt(p);if(t&&Be.has(t.value)){this.Filter=t.value,p=t.end+1;break}throw new Error(`Unsupported /Filter property value: ${t.value}`)}if(r===fe){const t=s.parseNameArrayAt(p);if(t){const e=t.value;if(1===e.length&&Be.has(e[0])){this.Filter=e[0],p=t.end+1;break}throw new Error(`Unsupported /Filter property value: ${e.toString()}`)}}throw new Error(`Unsupported /Filter property value type: ${r}`);case"/DecodeParms":const n=s.getValueTypeAt(p);if(n===ge){const e=s.getDictBoundsAt(p);if(e){const r=ir.parse({parser:s,bounds:e,cryptInfo:t.cryptInfo});if(r){this.DecodeParms=r.value,p=e.end+1;break}}throw new Error("Can't parse /DecodeParms property value")}if(n===fe){const e=ir.parseArray(s,p,t.cryptInfo);if(e){const t=e.value;if(1===t.length){this.DecodeParms=t[0],p=e.end+1;break}}throw new Error("Can't parse /DecodeParms property value")}throw new Error(`Unsupported /DecodeParms property value type: ${n}`);default:p=s.skipToNextName(p,c.contentEnd)}const u=s.findNewLineIndex("straight",h.end+1),f=s.findNewLineIndex("reverse",o.start-1),g=s.sliceCharCodes(u,f),w=(null===(r=t.cryptInfo)||void 0===r?void 0:r.ref)&&t.cryptInfo.streamCryptor?t.cryptInfo.streamCryptor.decrypt(g,t.cryptInfo.ref):g;this._streamData=w}setStreamData(t){let e;if(this.DecodeParms){const r=this.DecodeParms;e=hr.Encode(t,r.getIntProp("/Predictor")||Dt,r.getIntProp("/Columns")||1,r.getIntProp("/Colors")||1,r.getIntProp("/BitsPerComponent")||8)}else e=hr.Encode(t);this._streamData=e,this.Length=e.length,this.DL=t.length,this._decodedStreamData=t}decodeStreamData(){let t;switch(this.Filter){case Mt:if(this.DecodeParms){const e=this.DecodeParms;t=hr.Decode(this._streamData,e.getIntProp("/Predictor")||Dt,e.getIntProp("/Columns")||1,e.getIntProp("/Colors")||1,e.getIntProp("/BitsPerComponent")||8)}else t=hr.Decode(this._streamData);break;default:t=new Uint8Array(this._streamData)}this._decodedStreamData=t}}class dr extends cr{constructor(t=null){super(t)}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new dr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}getText(){return null}toArray(t){return super.toArray(t)}parseProps(t){super.parseProps(t)}}class lr{constructor(t,e,r){this._literal=t,this._hex=e,this._bytes=r}get literal(){return this._literal}get hex(){return this._hex.slice()}get bytes(){return this._bytes.slice()}static parse(t,e,r=null,s=!0){const n=t.getHexBounds(e,s);if(!n)return null;let i=t.sliceCharCodes(n.start+1,n.end-1);(null==r?void 0:r.ref)&&r.stringCryptor&&(i=r.stringCryptor.decrypt(i,r.ref));return{value:lr.fromBytes(i),start:n.start,end:n.end}}static parseArray(t,e,r=null,s=!0){const n=t.getArrayBoundsAt(e,s);if(!n)return null;const i=[];let a,o=n.start+1;for(;o<n.end&&(a=lr.parse(t,o,r,s),a);)i.push(a.value),o=a.end+1;return{value:i,start:n.start,end:n.end}}static fromBytes(t){const e=(new TextDecoder).decode(t),r=Le(e);return new lr(e,r,t)}static fromHexBytes(t){let e="";t.forEach((t=>e+=t.toString(16).padStart(2,"0")));const r=(new TextEncoder).encode(e);return new lr(e,t,r)}static fromLiteralString(t){const e=Le(t),r=(new TextEncoder).encode(t);return new lr(t,e,r)}toArray(t){return new Uint8Array([...gt.STR_HEX_START,...this._bytes,...gt.STR_HEX_END])}}class pr{constructor(t,e,r){switch(t){case Ee:this.componentsNumber=1;break;case Ce:this.componentsNumber=3;break;case Se:this.componentsNumber=4;break;default:throw new Error(`Unsupported base color space for indexed color space: ${t}`)}if(this.baseColorSpace=t,r.length!==this.componentsNumber*(e+1))throw new Error(`Invalid lookup array length: ${r.length}`);this.highestValue=e,this.lookupArray=r,console.log(this)}static parse(t,e=!0){const{parser:r,bounds:s,cryptInfo:n}=t;let i;e&&(i=r.findNonSpaceIndex("straight",s.start));const a=i;if(i<0||i>r.maxIndex||r.getCharCode(i)!==K)return console.log("Color space array start not found"),null;i++;const o=r.parseNameAt(i);if(!o||"/Indexed"!==o.value)return console.log("Array is not representing an indexed color space"),null;i=o.end+1;const h=r.parseNameAt(i);if(!h)return console.log("Can't parse base color space name of the indexed color space"),null;i=h.end+2;const c=r.parseNumberAt(i);if(!c||isNaN(c.value))return console.log("Can't parse the highest value of the indexed color space"),null;let d;i=c.end+1;const l=r.getValueTypeAt(i);if(l===ye)try{const e=tr.parseRef(r,i),s=t.parseInfoGetter(e.value.id);d=dr.parse(s).value.decodedStreamData,i=e.end+1}catch(t){throw new Error(`Can't parse indexed color array lookup ref: ${t.message}`)}else if(l===pe){const t=lr.parse(r,i,n);if(!t)throw new Error("Can't parse indexed color array lookup hex string");d=t.value.hex,i=t.end+1}try{return{value:new pr(h.value,c.value,d),start:a,end:i-1}}catch(t){return console.log(t.message),null}}toArray(t){const e=new TextEncoder,r=[];return r.push(K,...e.encode("/Indexed "),...e.encode(this.baseColorSpace+" "),...e.encode(this.highestValue+" "),...lr.fromHexBytes(this.lookupArray).toArray(t),Y),new Uint8Array(r)}getColor(t){switch(this.baseColorSpace){case Ee:const e=this.lookupArray[t];return[e,e,e];case Ce:return[this.lookupArray[3*t],this.lookupArray[3*t+1],this.lookupArray[3*t+2]];case Se:const r=this.lookupArray[4*t]/255,s=this.lookupArray[4*t+1]/255,n=this.lookupArray[4*t+2]/255,i=this.lookupArray[4*t+3]/255;return[255*(1-r)*(1-i),255*(1-s)*(1-i),255*(1-n)*(1-i)]}}}var ur=function(t,e,r,s){return new(r||(r=Promise))((function(n,i){function a(t){try{h(s.next(t))}catch(t){i(t)}}function o(t){try{h(s.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))};class fr extends cr{constructor(){super(qt),this.Subtype="/Image",this.ImageMask=!1,this.Interpolate=!1,this.SMaskInData=0}get sMask(){return this._sMask}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new fr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Subtype&&s.push(...r.encode("/Subtype "),...r.encode(this.Subtype)),this.Width&&s.push(...r.encode("/Width "),...r.encode(" "+this.Width)),this.Height&&s.push(...r.encode("/Width "),...r.encode(" "+this.Height)),this.ColorSpace&&(this._indexedColorSpace?s.push(...r.encode("/ColorSpace "),...this._indexedColorSpace.toArray(t)):s.push(...r.encode("/ColorSpace "),...r.encode(this.ColorSpace))),this.BitsPerComponent&&s.push(...r.encode("/BitsPerComponent "),...r.encode(" "+this.BitsPerComponent)),s.push(...r.encode("/ImageMask "),...r.encode(" "+!!this.ImageMask)),this.Mask&&(s.push(...r.encode("/Mask "),K),this.Mask.forEach((t=>s.push(_,...r.encode(" "+t)))),s.push(Y)),this.Decode&&(s.push(...r.encode("/Decode "),K),this.Decode.forEach((t=>s.push(_,...r.encode(" "+t)))),s.push(Y)),s.push(...r.encode("/Interpolate "),...r.encode(" "+!!this.Interpolate)),this.SMask&&s.push(...r.encode("/SMask "),...this.SMask.toArray(t)),this.SMaskInData&&s.push(...r.encode("/SMaskInData "),...r.encode(" "+this.SMaskInData)),this.Matte&&(s.push(...r.encode("/Matte "),K),this.Matte.forEach((t=>s.push(_,...r.encode(" "+t)))),s.push(Y)),this.StructParent&&s.push(...r.encode("/StructParent "),...r.encode(" "+this.StructParent)),this.Metadata&&s.push(...r.encode("/Metadata "),_,...this.Metadata.toArray(t));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}getImageUrlAsync(){return ur(this,void 0,void 0,(function*(){if(this._imageUrl&&URL.revokeObjectURL(this._imageUrl),this.Filter===It||this.Filter===Nt||this.Filter===Rt){const t=new Blob([this.decodedStreamData],{type:"application/octet-binary"}),e=URL.createObjectURL(t);return this._imageUrl=e,e}if(this.Filter===Mt){const t=this.Width*this.Height;let e;if(this.sMask){if(e=this.sMask.decodedStreamData,e.length!==t)throw new Error(`Invalid alpha mask data length: ${e.length} (must be ${t})`)}else e=new Uint8Array(t).fill(255);const r=new Uint8ClampedArray(4*t);for(let s=0;s<t;s++){const[t,n,i]=this.getColor(s);r[4*s]=t,r[4*s+1]=n,r[4*s+2]=i,r[4*s+3]=e[s]}const s=new ImageData(r,this.Width,this.Height),n=new Promise(((t,e)=>{const r=document.createElement("canvas");r.width=this.Width,r.height=this.Height,r.getContext("2d").putImageData(s,0,0),r.toBlob((e=>{const r=URL.createObjectURL(e);t(r)}))})),i=yield n;return this._imageUrl=i,i}throw new Error(`Unsupported image filter type: ${this.Filter}`)}))}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=e.getDictBoundsAt(s);let i,a,o=e.skipToNextName(n.contentStart,n.contentEnd);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Subtype":const r=e.parseNameAt(o);if(!r)throw new Error("Can't parse /Subtype property value");if(this.Subtype&&this.Subtype!==r.value)throw new Error(`Ivalid dict subtype: '${r.value}' instead of '${this.Subtype}'`);o=r.end+1;break;case"/Width":case"/Height":case"/BitsPerComponent":case"/SMaskInData":case"/StructParent":o=this.parseNumberProp(i,e,o,!1);break;case"/Decode":o=this.parseNumberArrayProp(i,e,o,!1);break;case"/Matte":o=this.parseNumberArrayProp(i,e,o,!0);break;case"/Interpolate":o=this.parseBoolProp(i,e,o);break;case"/SMask":case"/Metadata":o=this.parseRefProp(i,e,o);break;case"/ColorSpace":const s=e.getValueTypeAt(o);if(s===ue){const t=e.parseNameAt(o);if(t){this.ColorSpace=t.value,o=t.end+1;break}throw new Error("Can't parse /ColorSpace name")}if(s===fe){const r=e.getArrayBoundsAt(o);if(r){const s=pr.parse({parser:e,bounds:r,cryptInfo:t.cryptInfo,parseInfoGetter:t.parseInfoGetter});if(s){this.ColorSpace=Pe,this._indexedColorSpace=s.value,o=r.end+1;break}throw new Error("Can't parse /ColorSpace object:"+e.sliceChars(r.start,r.end))}throw new Error("Can't parse /ColorSpace value array")}if(s===ye){const r=tr.parseRef(e,o);if(r){const e=t.parseInfoGetter(r.value.id);if(e){const t=pr.parse(e);if(t){this.ColorSpace=Pe,this._indexedColorSpace=t.value,o=r.end+1;break}throw new Error("Can't parse /ColorSpace object:"+e.parser.sliceChars(e.bounds.start,e.bounds.end))}}throw new Error("Can't parse /ColorSpace ref")}throw new Error(`Unsupported /ColorSpace property value type: ${s}`);case"/ImageMask":const a=e.parseBoolAt(o,!1);if(!a)throw new Error("Can't parse /ImageMask property value");this.ImageMask=a.value,o=a.end+1,this.ImageMask&&(this.BitsPerComponent=1);break;case"/Mask":const h=e.getValueTypeAt(o);if(h===ye){const r=tr.parseRef(e,o);if(!r)throw new Error("Can't parse /Mask value reference: failed to parse ref");const s=t.parseInfoGetter(r.value.id);if(!s)throw new Error("Can't parse /Mask value reference: failed to get image parse info");const n=fr.parse(s);if(!n)throw new Error("Can't parse /Mask value reference: failed to parse image stream");const i=new Ke(new Uint8Array([K,...n.value.decodedStreamData,Y]));if(!i)throw new Error("Can't parse /Mask value reference: failed to get decoded image data");const a=i.parseNumberArrayAt(0,!1);if(!a)throw new Error("Can't parse /Mask value reference: failed to parse decoded image data");this.Mask=a.value,o=r.end+1;break}if(h===fe){const t=e.parseNumberArrayAt(o,!1);if(t){this.Mask=t.value,o=t.end+1;break}throw new Error("Can't parse /Mask property value")}throw new Error(`Unsupported /Mask property value type: ${h}`);case"/OC":case"/Intent":case"/Alternates":case"/ID":case"/OPI":default:o=e.skipToNextName(o,n.contentEnd)}if(!this.Width&&!this.Height)throw new Error("Not all required properties parsed");if(this.ImageMask&&(1!==this.BitsPerComponent||this.ColorSpace))throw new Error("Mutually exclusive properties found");if(!this.Decode&&(this.Filter!==Rt||this.ImageMask))switch(this.ColorSpace){case Ee:this.Decode=[0,1];break;case Ce:this.Decode=[0,1,0,1,0,1];break;case Se:this.Decode=[0,1,0,1,0,1,0,1];break;case Pe:this.Decode=[0,Math.pow(2,this.BitsPerComponent||1)-1];break;default:this.Decode=[0,1]}if(this.DecodeParms||(this.DecodeParms=new ir),this.DecodeParms.getIntProp("/BitsPerComponent")||this.DecodeParms.setIntProp("/BitsPerComponent",this.BitsPerComponent),this.DecodeParms.getIntProp("/Columns")||this.DecodeParms.setIntProp("/Columns",this.Width),!this.DecodeParms.getIntProp("/Colors"))switch(this.ColorSpace){case Ee:case Pe:this.DecodeParms.setIntProp("/Colors",1);break;case Ce:this.DecodeParms.setIntProp("/Colors",3);break;case Se:this.DecodeParms.setIntProp("/Colors",4);break;default:this.DecodeParms.setIntProp("/Colors",1)}if(this.SMask){const e=t.parseInfoGetter(this.SMask.id);if(!e)throw new Error(`Can't get parse info for ref: ${this.SMask.id} ${this.sMask.generation} R`);const r=fr.parse(e);if(!r)throw new Error(`Can't parse SMask: ${this.SMask.id} ${this.sMask.generation} R`);this._sMask=r.value}}getColor(t){var e;const r=this.decodedStreamData;switch(this.ColorSpace){case Ee:const s=r[t];return[s,s,s];case Ce:return[r[3*t],r[3*t+1],r[3*t+2]];case Se:const n=r[4*t]/255,i=r[4*t+1]/255,a=r[4*t+2]/255,o=r[4*t+3]/255;return[255*(1-n)*(1-o),255*(1-i)*(1-o),255*(1-a)*(1-o)];case Pe:return(null===(e=this._indexedColorSpace)||void 0===e?void 0:e.getColor(t))||[0,0,0]}}}const gr={SOLID:"/S",DASHED:"/D",BEVELED:"/B",INSET:"/I",UNDERLINE:"/U"};class wr extends nr{constructor(){super($t),this.W=1,this.S=gr.SOLID,this.D=[3,0]}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new wr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.W&&s.push(...r.encode("/W "),...r.encode(" "+this.W)),this.S&&s.push(...r.encode("/S "),...r.encode(this.S)),this.D&&s.push(...r.encode("/D "),K,...r.encode(this.D[0]+""),_,...r.encode(this.D[1]+""),Y);const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){var e,r;super.parseProps(t);const{parser:s,bounds:n}=t,i=n.contentStart||n.start,a=n.contentEnd||n.end;let o,h,c=s.skipToNextName(i,a-1);for(;h=s.parseNameAt(c),h;)switch(c=h.end+1,o=h.value,o){case"/W":c=this.parseNumberProp(o,s,c,!0);break;case"/S":const t=s.parseNameAt(c,!0);if(!t||!Object.values(gr).includes(t.value))throw new Error("Can't parse /S property value");this.S=t.value,c=t.end+1;break;case"/D":const n=s.parseNumberArrayAt(c,!0);if(!n)throw new Error("Can't parse /D property value");this.D=[null!==(e=n.value[0])&&void 0!==e?e:3,null!==(r=n.value[1])&&void 0!==r?r:0],c=n.end+1;break;default:c=s.skipToNextName(c,a-1)}}}class yr extends nr{constructor(){super(null),this._objectIdMap=new Map,this._dictParserMap=new Map}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new yr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}getObjectId(t){return this._objectIdMap.get(t)}*getObjectIds(){for(const t of this._objectIdMap)yield t}getDictParser(t){return this._dictParserMap.get(t)}*getDictParsers(){for(const t of this._dictParserMap)yield t}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this._objectIdMap.forEach(((e,n)=>{s.push(...r.encode(n),_,...e.toArray(t))}));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){default:const r=e.getValueTypeAt(o);if(r===ye){const t=tr.parseRef(e,o);if(t){this._objectIdMap.set(i,t.value),o=t.end+1;break}}else if(r===ge){const r=e.getDictBoundsAt(o);if(r){const s={parser:new Ke(e.sliceCharCodes(r.start,r.end)),bounds:{start:0,end:r.end-r.start,contentStart:r.contentStart-r.start,contentEnd:r.contentEnd-r.start},cryptInfo:t.cryptInfo};this._dictParserMap.set(i,s),o=r.end+1;break}}o=e.skipToNextName(o,n-1)}}}class Ar extends nr{constructor(){super(ie)}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Ar;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Subtype&&s.push(...r.encode("/Subtype "),...r.encode(" "+this.Subtype)),this.BaseFont&&s.push(...r.encode("/BaseFont "),...r.encode(" "+this.BaseFont)),this.Encoding&&s.push(...r.encode("/Encoding "),...r.encode(" "+this.Encoding)),this.ToUnicode&&s.push(...r.encode("/G "),_,...this.ToUnicode.toArray(t));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Subtype":const t=e.parseNameAt(o,!0);if(t){if("/Type1"===t.value||"/TrueType"===t.value){this.Subtype=t.value,o=t.end+1;break}throw new Error(`Font type is not supported: ${t.value}`)}throw new Error("Can't parse /Subtype property value");case"/BaseFont":case"/Encoding":o=this.parseNameProp(i,e,o);break;case"/ToUnicode":o=this.parseRefProp(i,e,o);break;default:o=e.skipToNextName(o,n-1)}}}class mr extends nr{constructor(){super(se),this.TR="/Identity"}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new mr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.S&&s.push(...r.encode("/S "),...r.encode(this.S)),this.G&&s.push(...r.encode("/G "),_,...this.G.toArray(t)),this.BC&&(s.push(...r.encode("/BC "),K),this.BC.forEach((t=>s.push(_,...r.encode(" "+t)))),s.push(Y)),this.TR&&s.push(...r.encode("/TR "),...r.encode(" "+this.TR));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/S":const t=e.parseNameAt(o,!0);if(!t||!Object.values(ke).includes(t.value))throw new Error("Can't parse /S property value");this.S=t.value,o=t.end+1;break;case"/G":o=this.parseRefProp(i,e,o);break;case"/BC":o=this.parseNumberArrayProp(i,e,o);break;case"/TR":default:o=e.skipToNextName(o,n-1)}}}class vr extends nr{constructor(){super(ee)}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new vr;e.parseProps(t);const r=new Proxy(e,e.onChange);return e._proxy=r,{value:r,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.LW&&s.push(...r.encode("/LW "),...r.encode(" "+this.LW)),this.LC&&s.push(...r.encode("/LC "),...r.encode(" "+this.LC)),this.LJ&&s.push(...r.encode("/LJ "),...r.encode(" "+this.LJ)),this.ML&&s.push(...r.encode("/ML "),...r.encode(" "+this.ML)),this.D&&s.push(...r.encode("/D "),K,K,...r.encode(""+this.D[0][0]),...r.encode(" "+this.D[0][1]),Y,...r.encode(" "+this.D[1]),Y),this.RI&&s.push(...r.encode("/RI "),...r.encode(this.RI)),this.OP&&s.push(...r.encode("/OP "),...r.encode(" "+this.OP)),this.op&&s.push(...r.encode("/op "),...r.encode(" "+this.op)),this.OPM&&s.push(...r.encode("/OPM "),...r.encode(" "+this.OPM)),this.Font&&s.push(...r.encode("/Font "),K,...this.Font[0].toArray(t),...r.encode(" "+this.Font[1]),Y),this.FL&&s.push(...r.encode("/FL "),...r.encode(" "+this.FL)),this.SM&&s.push(...r.encode("/SM "),...r.encode(" "+this.SM)),this.SA&&s.push(...r.encode("/SA "),...r.encode(" "+this.SA)),this.BM&&s.push(...r.encode("/BM "),...r.encode(this.BM)),this.SMask&&(this.SMask instanceof mr?s.push(...r.encode("/SMask "),...this.SMask.toArray(t)):s.push(...r.encode("/SMask "),...r.encode(this.SMask))),this.CA&&s.push(...r.encode("/CA "),...r.encode(" "+this.CA)),this.ca&&s.push(...r.encode("/ca "),...r.encode(" "+this.ca)),this.AIS&&s.push(...r.encode("/AIS "),...r.encode(" "+this.AIS)),this.TK&&s.push(...r.encode("/AIS "),...r.encode(" "+this.TK));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}toParams(){const t={};if(isNaN(this.LW)||(t.strokeWidth=this.LW),!isNaN(this.LC))switch(this.LC){case ve.BUTT:t.strokeLineCap="butt";break;case ve.ROUND:t.strokeLineCap="round";break;case ve.SQUARE:t.strokeLineCap="square"}if(!isNaN(this.LJ))switch(this.LJ){case xe.BEVEL:t.strokeLineJoin="bevel";break;case xe.ROUND:t.strokeLineJoin="round";break;case xe.MITER:t.strokeLineJoin="miter"}return this.ML&&(t.strokeMiterLimit=this.ML),this.D&&(t.strokeDashArray=`${this.D[0][0]} ${this.D[0][1]}`,t.strokeDashOffset=this.D[1]),this.Font,this.BM&&(t.strokeMiterLimit=this.ML),this.SMask,this.CA&&(t.strokeAlpha=this.CA),this.ca&&(t.fillAlpha=this.ca),this.AIS,t}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/LC":const t=e.parseNumberAt(o,!0);if(!t||!Object.values(ve).includes(t.value))throw new Error("Can't parse /LC property value");this.LC=t.value,o=t.end+1;break;case"/OPM":const r=e.parseNumberAt(o,!0);if(!r||![0,1].includes(r.value))throw new Error("Can't parse /OPM property value");this.OPM=r.value,o=r.end+1;break;case"/LJ":const s=e.parseNumberAt(o,!0);if(!s||!Object.values(xe).includes(s.value))throw new Error("Can't parse /LJ property value");this.LJ=s.value,o=s.end+1;break;case"/RI":const a=e.parseNameAt(o,!0);if(!a||!Object.values(be).includes(a.value))throw new Error("Can't parse /RI property value");this.RI=a.value,o=a.end+1;break;case"/BM":const h=e.parseNameAt(o,!0);if(!h||!Object.values(_e).includes(h.value))throw new Error("Can't parse /BM property value");this.BM=h.value,o=h.end+1;break;case"/SMask":const c=e.getValueTypeAt(o);if(c===ue){const t=e.parseNameAt(o);if(t){this.SMask=t.value,o=t.end+1;break}throw new Error("Can't parse /SMask property name")}if(c===ge){const t=e.getDictBoundsAt(o);if(t){const r=mr.parse({parser:e,bounds:t});if(r){this.SMask=r.value,o=r.end+1;break}}throw new Error("Can't parse /SMask value dictionary")}throw new Error(`Unsupported /SMask property value type: ${c}`);case"/Font":const d=e.getValueTypeAt(o);if(d!==fe)throw new Error(`Unsupported /Font property value type: ${d}`);{const t=e.getArrayBoundsAt(o);if(t){const r=tr.parse(e,t.start+1);if(r){const s=e.parseNumberAt(r.end+1);if(s){this.Font=[r.value,s.value],o=t.end+1;break}}}}throw new Error("Can't parse /Font property value");case"/D":const l=e.getValueTypeAt(o);if(l!==fe)throw new Error(`Unsupported /D property value type: ${l}`);{const t=e.getArrayBoundsAt(o);if(t){const r=e.parseNumberArrayAt(t.start+1);if(r){const s=e.parseNumberAt(r.end+1);if(s){this.D=[[r.value[0],r.value[1]],s.value],o=t.end+1;break}}}}throw new Error("Can't parse /D property value");case"/OP":case"/op":case"/SA":case"/AIS":case"/TK":o=this.parseBoolProp(i,e,o);break;case"/LW":case"/ML":case"/FL":case"/SM":case"/CA":case"/ca":o=this.parseNumberProp(i,e,o);break;default:o=e.skipToNextName(o,n-1)}}}class xr extends nr{constructor(){super(null),this._gsMap=new Map,this._fontsMap=new Map,this._xObjectsMap=new Map}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new xr;e.parseProps(t);const r=new Proxy(e,e.onChange);return e._proxy=r,{value:r,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];if(this._gsMap.size){s.push(...r.encode("/ExtGState ")),s.push(...gt.DICT_START);for(const[e,n]of this._gsMap)s.push(...r.encode(e.slice(10)),_),n.ref?s.push(...tr.fromRef(n.ref).toArray(t)):s.push(...n.toArray(t));s.push(...gt.DICT_END)}if(this._xObjectsMap.size){s.push(...r.encode("/XObject "),...gt.DICT_START);for(const[e,n]of this._xObjectsMap){const i=n.ref;if(!i)throw new Error("XObject has no reference");s.push(...r.encode(e.slice(8)),_),s.push(...tr.fromRef(i).toArray(t))}s.push(...gt.DICT_END)}this.ColorSpace&&s.push(...r.encode("/ColorSpace "),...this.ColorSpace.toArray(t)),this.Pattern&&s.push(...r.encode("/Pattern "),...this.Pattern.toArray(t)),this.Shading&&s.push(...r.encode("/Shading "),...this.Shading.toArray(t)),this.Font&&s.push(...r.encode("/Font "),...this.Font.toArray(t)),this.Properties&&s.push(...r.encode("/Properties "),...this.Properties.toArray(t)),this.ProcSet&&(s.push(...r.encode("/ProcSet "),K),this.ProcSet.forEach((t=>s.push(_,...r.encode(t)))),s.push(Y));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}getGraphicsState(t){return this._gsMap.get(t)}*getGraphicsStates(){for(const t of this._gsMap)yield t}setGraphicsState(t,e){this._gsMap.set(`/ExtGState${t}`,e),this._edited=!0}getFont(t){return this._fontsMap.get(t)}*getFonts(){for(const t of this._fontsMap)yield t}getXObject(t){return this._xObjectsMap.get(t)}*getXObjects(){for(const t of this._xObjectsMap)yield t}setXObject(t,e){this._xObjectsMap.set(`/XObject${t}`,e),this._edited=!0}fillMaps(t,e){if(this._gsMap.clear(),this._fontsMap.clear(),this._xObjectsMap.clear(),this.ExtGState){for(const[e,r]of this.ExtGState.getObjectIds()){const s=t(r.id);if(!s)continue;const n=vr.parse(s);n&&this._gsMap.set(`/ExtGState${e}`,n.value)}for(const[t,e]of this.ExtGState.getDictParsers()){const r=vr.parse(e);r&&this._gsMap.set(`/ExtGState${t}`,r.value)}}if(this.XObject)for(const[e,r]of this.XObject.getObjectIds()){const s=t(r.id);if(!s)continue;const n=s.parser.findSubarrayIndex(gt.FORM,{direction:"straight",minIndex:s.bounds.start,maxIndex:s.bounds.end})?Cr.parse(s):fr.parse(s);n&&this._xObjectsMap.set(`/XObject${e}`,n.value)}if(this.Font)for(const[e,r]of this.Font.getObjectIds()){const s=t(r.id);if(!s)continue;const n=Ar.parse(s);n&&this._fontsMap.set(`/Font${e}`,n.value)}}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/ExtGState":case"/ColorSpace":case"/Pattern":case"/Shading":case"/XObject":case"/Font":case"/Properties":const t=e.getDictBoundsAt(o);if(t){const r=yr.parse({parser:e,bounds:t});if(r){this[i.slice(1)]=r.value,o=t.end+1;break}}throw new Error(`Can't parse ${i} property value`);case"/ProcSet":o=this.parseNameArrayProp(i,e,o);break;default:o=e.skipToNextName(o,n-1)}t.parseInfoGetter&&this.fillMaps(t.parseInfoGetter,t.cryptInfo)}}class br extends nr{constructor(){super(te),this.Subtype="/RL"}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new br;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Subtype&&s.push(...r.encode("/Subtype "),...r.encode(this.Subtype));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Subtype":const t=e.parseNameAt(o);if(!t)throw new Error("Can't parse /Subtype property value");if(this.Subtype&&this.Subtype!==t.value)throw new Error(`Ivalid dict subtype: '${t.value}' instead of '${this.Subtype}'`);o=t.end+1;break;default:o=e.skipToNextName(o,n-1)}}}class _r extends nr{constructor(){super(ne),this.S="/Transparency"}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.S&&s.push(...r.encode("/S "),...r.encode(this.S));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/S":const t=e.parseNameAt(o,!0);if(!t)throw new Error("Can't parse /S property value");if(!Object.values(oe).includes(t.value))throw new Error(`Ivalid dict subtype: '${t.value}'`);this.S=t.value,o=t.end+1;break;default:o=e.skipToNextName(o,n-1)}}}class Er extends _r{constructor(){super(),this.I=!1,this.K=!1}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Er;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.CS&&s.push(...r.encode("/CS "),...r.encode(this.CS)),this.I&&s.push(...r.encode("/I "),...r.encode(" "+this.I)),this.K&&s.push(...r.encode("/K "),...r.encode(" "+this.K));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){if(super.parseProps(t),"/Transparency"!==this.S)throw new Error("Not a transparency dict");const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/CS":const t=e.getValueTypeAt(o);if(t===ue){const t=e.parseNameAt(o);if(t){this.CS=t.value,o=t.end+1;break}throw new Error("Can't parse /CS property name")}if(t===fe){const t=e.getArrayBoundsAt(o);if(t){o=t.end+1;break}throw new Error("Can't parse /CS value dictionary")}throw new Error(`Unsupported /CS property value type: ${t}`);case"/I":case"/K":o=this.parseBoolProp(i,e,o);break;default:o=e.skipToNextName(o,n-1)}}}class Cr extends cr{constructor(){super(qt),this.Subtype="/Form",this.FormType=1,this.Matrix=[1,0,0,1,0,0]}get matrix(){const t=new f;if(this.Matrix){const[e,r,s,n,i,a]=this.Matrix;t.set(e,r,0,s,n,0,i,a,1)}return t}set matrix(t){t&&(this.Matrix=[...t.toFloatShortArray()])}get bBox(){return{ll:new p(this.BBox[0],this.BBox[1]),lr:new p(this.BBox[2],this.BBox[1]),ur:new p(this.BBox[2],this.BBox[3]),ul:new p(this.BBox[0],this.BBox[3])}}get transformedBBox(){const t=new f;if(this.Matrix){const[e,r,s,n,i,a]=this.Matrix;t.set(e,r,0,s,n,0,i,a,1)}const e=new p(this.BBox[0],this.BBox[1]),r=new p(this.BBox[2],this.BBox[1]),s=new p(this.BBox[2],this.BBox[3]),n=new p(this.BBox[0],this.BBox[3]);return{ll:p.applyMat3(e,t),lr:p.applyMat3(r,t),ur:p.applyMat3(s,t),ul:p.applyMat3(n,t)}}get edited(){return this._edited||this.Resources.edited}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Cr;e.parseProps(t);const r=new Proxy(e,e.onChange);return e._proxy=r,{value:r,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Subtype&&s.push(...r.encode("/Subtype "),...r.encode(this.Subtype)),this.FormType&&s.push(...r.encode("/FormType "),...r.encode(" "+this.FormType)),this.BBox&&s.push(...r.encode("/BBox "),K,...r.encode(this.BBox[0]+""),_,...r.encode(this.BBox[1]+""),_,...r.encode(this.BBox[2]+""),_,...r.encode(this.BBox[3]+""),Y),this.Matrix&&s.push(...r.encode("/Matrix "),K,...r.encode(this.Matrix[0]+""),_,...r.encode(this.Matrix[1]+""),_,...r.encode(this.Matrix[2]+""),_,...r.encode(this.Matrix[3]+""),_,...r.encode(this.Matrix[4]+""),_,...r.encode(this.Matrix[5]+""),Y),this.Resources&&s.push(...r.encode("/Resources "),...this.Resources.toArray(t)),this.Metadata&&s.push(...r.encode("/Metadata "),_,...this.Metadata.toArray(t)),this.LastModified&&s.push(...r.encode("/LastModified "),...this.LastModified.toArray(t)),this.StructParent&&s.push(...r.encode("/StructParent "),...r.encode(" "+this.StructParent)),this.StructParents&&s.push(...r.encode("/StructParents "),...r.encode(" "+this.StructParents)),this.Measure&&s.push(...r.encode("/Measure "),...this.Measure.toArray(t)),this.Group&&s.push(...r.encode("/Group "),...this.Group.toArray(t));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=e.getDictBoundsAt(s);let i,a,o=e.skipToNextName(n.contentStart,n.contentEnd);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Subtype":const r=e.parseNameAt(o);if(!r)throw new Error("Can't parse /Subtype property value");if(this.Subtype&&this.Subtype!==r.value)throw new Error(`Ivalid dict subtype: '${r.value}' instead of '${this.Subtype}'`);o=r.end+1;break;case"/FormType":const s=e.parseNumberAt(o,!1);if(!s)throw new Error("Can't parse /FormType property value");if(1!==s.value)throw new Error(`Ivalid form type: '${s.value}' instead of '1'`);o=s.end+1;break;case"/BBox":case"/Matrix":o=this.parseNumberArrayProp(i,e,o,!0);break;case"/LastModified":o=this.parseDateProp(i,e,o,t.cryptInfo);break;case"/Metadata":o=this.parseRefProp(i,e,o);break;case"/StructParent":case"/StructParents":o=this.parseNumberProp(i,e,o,!1);break;case"/Resources":const a=e.getValueTypeAt(o);if(a===ye){const r=tr.parseRef(e,o);if(r&&t.parseInfoGetter){const e=t.parseInfoGetter(r.value.id);if(e){const t=xr.parse(e);if(t){this.Resources=t.value,o=t.end+1;break}}}throw new Error("Can't parse /Resources value reference")}if(a===ge){const r=e.getDictBoundsAt(o);if(r){if(r.contentStart){const s=xr.parse({parser:e,bounds:r,parseInfoGetter:t.parseInfoGetter});if(!s)throw new Error("Can't parse /Resources value dictionary");this.Resources=s.value}o=r.end+1;break}throw new Error("Can't parse /Resources dictionary bounds")}throw new Error(`Unsupported /Resources property value type: ${a}`);case"/Measure":const h=e.getValueTypeAt(o);if(h===ye){const r=tr.parseRef(e,o);if(r&&t.parseInfoGetter){const e=t.parseInfoGetter(r.value.id);if(e){const t=br.parse(e);if(t){this.Measure=t.value,o=t.end+1;break}}}throw new Error("Can't parse /Measure value reference")}if(h===ge){const r=e.getDictBoundsAt(o);if(r){const s=br.parse({parser:e,bounds:r,cryptInfo:t.cryptInfo});if(s){this.Measure=s.value,o=s.end+1;break}}throw new Error("Can't parse /Measure value dictionary")}throw new Error(`Unsupported /Measure property value type: ${h}`);case"/Group":const c=e.getValueTypeAt(o);if(c===ye){const r=tr.parseRef(e,o);if(r&&t.parseInfoGetter){const e=t.parseInfoGetter(r.value.id);if(e){const t=Er.parse(e);if(t){this.Group=t.value,o=t.end+1;break}}}throw new Error("Can't parse /Group value reference")}if(c===ge){const r=e.getDictBoundsAt(o);if(r){const s=Er.parse({parser:e,bounds:r,cryptInfo:t.cryptInfo});if(s){this.Group=s.value,o=s.end+1;break}}throw new Error("Can't parse /Group value dictionary")}throw new Error(`Unsupported /Group property value type: ${c}`);case"/OC":case"/OPI":default:o=e.skipToNextName(o,n.contentEnd)}if(!this.BBox)throw new Error("Not all required properties parsed")}}class Sr extends nr{constructor(){super(null),this._streamsMap=new Map}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Sr;e.parseProps(t);const r=new Proxy(e,e.onChange);return e._proxy=r,{value:r,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}getStream(t){return this._streamsMap.get(t)}*getStreams(){for(const t of this._streamsMap)yield t[1]}setStream(t,e){this._streamsMap.set(t,e),this._edited=!0}clearStreams(){this._streamsMap.clear(),this._edited=!0}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[],n=this._streamsMap.get("/N");n?(s.push(...r.encode("/N ")),s.push(...tr.fromRef(n.ref).toArray(t))):this.N&&(s.push(...r.encode("/N ")),this.N,s.push(...this.N.toArray(t)));const i=this._streamsMap.get("/R");i?(s.push(...r.encode("/R ")),s.push(...tr.fromRef(i.ref).toArray(t))):this.R&&(s.push(...r.encode("/R ")),this.R,s.push(...this.R.toArray(t)));const a=this._streamsMap.get("/D");a?(s.push(...r.encode("/D ")),s.push(...tr.fromRef(a.ref).toArray(t))):this.D&&(s.push(...r.encode("/D ")),this.D,s.push(...this.D.toArray(t)));const o=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(o)}fillStreamsMap(t){this._streamsMap.clear();for(const e of["N","R","D"])if(this[e])if(this[e]instanceof tr){const r=t(this[e].id);if(!r)continue;const s=Cr.parse(r);if(!s)continue;s&&this._streamsMap.set(`/${e}`,s.value)}else for(const[r,s]of this[e].getProps()){const n=t(s.id);if(!n)continue;const i=Cr.parse(n);i&&this._streamsMap.set(`/${e}${r}`,i.value)}}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/N":const t=e.getValueTypeAt(o);if(t===ye){const t=tr.parseRef(e,o);if(t){this.N=t.value,o=t.end+1;break}}else{if(t!==ge)throw new Error(`Unsupported /N property value type: ${t}`);{const t=e.getDictBoundsAt(o);if(t){const r=yr.parse({parser:e,bounds:t});if(r){this.N=r.value,o=r.end+1;break}}}}throw new Error("Can't parse /N property value");case"/R":const r=e.getValueTypeAt(o);if(r===ye){const t=tr.parseRef(e,o);if(t){this.R=t.value,o=t.end+1;break}}else{if(r!==ge)throw new Error(`Unsupported /R property value type: ${r}`);{const t=e.getDictBoundsAt(o);if(t){const r=yr.parse({parser:e,bounds:t});if(r){this.R=r.value,o=r.end+1;break}}}}throw new Error("Can't parse /R property value");case"/D":const s=e.getValueTypeAt(o);if(s===ye){const t=tr.parseRef(e,o);if(t){this.D=t.value,o=t.end+1;break}}else{if(s!==ge)throw new Error(`Unsupported /D property value type: ${s}`);{const t=e.getDictBoundsAt(o);if(t){const r=yr.parse({parser:e,bounds:t});if(r){this.D=r.value,o=r.end+1;break}}}}throw new Error("Can't parse /D property value");default:o=e.skipToNextName(o,n-1)}if(!this.N)throw new Error("Not all required properties parsed");t.parseInfoGetter&&this.fillStreamsMap(t.parseInfoGetter)}}const Pr={NONE:"/S",CLOUDY:"/C"};class kr extends nr{constructor(){super(null),this.S=Pr.NONE,this.L=0}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new kr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.S&&s.push(...r.encode("/S "),...r.encode(this.S)),this.L&&s.push(...r.encode("/L "),...r.encode(" "+this.L));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/S":const t=e.parseNameAt(o,!0);if(!t||!Object.values(Pr).includes(t.value))throw new Error("Can't parse /S property value");this.S=t.value,o=t.end+1;break;case"/L":o=this.parseNumberProp(i,e,o,!0);break;default:o=e.skipToNextName(o,n-1)}}}class Br{constructor(t,e,r,s,n){this.hCornerR=null!=t?t:0,this.vCornerR=null!=e?e:0,this.width=null!=r?r:1,this.dash=null!=s?s:3,this.gap=null!=n?n:0}static parse(t,e,r=!0){if(r&&(e=t.findRegularIndex("straight",e)),e<0||e>t.maxIndex||t.getCharCode(e)!==K)return null;const s=t.parseNumberAt(e+1);if(!s||isNaN(s.value))return null;const n=t.parseNumberAt(s.end+2);if(!n||isNaN(n.value))return null;const i=t.parseNumberAt(n.end+2);if(!i||isNaN(i.value))return null;const a=t.findNonSpaceIndex("straight",i.end+1);if(!a)return null;if(t.getCharCode(a)===Y)return{value:new Br(s.value,n.value,i.value),start:e,end:a};if(t.getCharCode(a)===K){const r=t.parseNumberAt(a+1);if(!r||isNaN(r.value))return null;const o=t.parseNumberAt(r.end+2);if(!o||isNaN(o.value))return null;const h=t.findNonSpaceIndex("straight",o.end+1);if(!h||t.getCharCode(h)!==Y)return null;const c=t.findNonSpaceIndex("straight",h+1);return c&&t.getCharCode(c)===Y?{value:new Br(s.value,n.value,i.value,r.value,o.value),start:e,end:c}:null}return null}toArray(t){const e=this.dash&&this.gap?`[${this.hCornerR} ${this.vCornerR} ${this.width}]`:`[${this.hCornerR} ${this.vCornerR} ${this.width} [${this.dash} ${this.gap}]]`;return(new TextEncoder).encode(e)}}class Ir{constructor(t){Object.assign(this,Ir.defaultParams,t)}clone(t){const e=new Ir(this);return t?Object.assign(e,t):e}}Ir.defaultParams={fontFamily:"helvetica, sans-serif",fontSize:"12px",lineHeight:"1",letterSpacing:"normal",wordSpacing:"normal",textHorScale:1,textRenderMode:0,textVertAlign:"0",textKnockOut:!0};class Mr{constructor(t){var e,r,s,n;Object.assign(this,Mr.defaultParams,t),this.matrix=null===(e=this.matrix)||void 0===e?void 0:e.clone(),this.textState=null===(r=this.textState)||void 0===r?void 0:r.clone(),this.strokeColor=null===(s=this.strokeColor)||void 0===s?void 0:s.clone(),this.fillColor=null===(n=this.fillColor)||void 0===n?void 0:n.clone()}get stroke(){const{x:t,y:e,z:r}=this.strokeColor;return`rgba(${t},${e},${r},${this.strokeAlpha})`}get fill(){const{x:t,y:e,z:r}=this.fillColor;return`rgba(${t},${e},${r},${this.fillAlpha})`}clone(t){const e=new Mr(this);return t?Object.assign(e,t):e}setColor(t,...e){let r,s,n;switch(e.length){case 1:r=s=n=255*e[0];break;case 3:r=255*e[0],s=255*e[1],n=255*e[2];break;case 4:const[t,i,a,o]=e;r=255*(1-t)*(1-o),s=255*(1-i)*(1-o),n=255*(1-a)*(1-o)}"stroke"===t?this.strokeColor.set(r,s,n):this.fillColor.set(r,s,n)}}Mr.defaultParams={matrix:new f,textState:new Ir,strokeColorSpace:"rgb",strokeAlpha:1,strokeColor:new u,fillColorSpace:"rgb",fillAlpha:1,fillColor:new u,strokeWidth:1,strokeMiterLimit:10,strokeLineCap:"square",strokeLineJoin:"miter"};var Nr=function(t,e,r,s){return new(r||(r=Promise))((function(n,i){function a(t){try{h(s.next(t))}catch(t){i(t)}}function o(t){try{h(s.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))};class Rr{constructor(t,e,r){if(this._clipPaths=[],this._graphicsStates=[],!t)throw new Error("Stream is not defined");this._stream=t,this._parser=new Ke(t.decodedStreamData),this._rect=e,this._objectName=r;const s=Rr.calcBBoxToRectMatrix(t,e),n=document.createElementNS("http://www.w3.org/2000/svg","clipPath");n.id=`clip0_${r}`,n.innerHTML=`<rect x="${e[0]}" y="${e[1]}" width="${e[2]-e[0]}" height="${e[3]-e[1]}" />`,this._clipPaths.push(n),this._graphicsStates.push(new Mr({matrix:s}))}get state(){return this._graphicsStates[this._graphicsStates.length-1]}static calcBBoxToRectMatrix(t,e){const r=t.matrix,{ll:s,lr:n,ur:i,ul:a}=t.bBox,{min:o,max:h}=w(p.applyMat3(s,r),p.applyMat3(n,r),p.applyMat3(i,r),p.applyMat3(a,r)),c=g(o,h,new p(e[0],e[1]),new p(e[2],e[3]));return f.fromMat3(r).multiply(c)}static parseNextCommand(t,e){const r=[];let s;t:for(;!s;){const n=t.getValueTypeAt(e,!0);switch(n){case de:const i=t.parseNumberAt(e,!0);r.push(i.value),e=i.end+1;break;case ue:const a=t.parseNameAt(e,!0);r.push(a.value),e=a.end+1;break;case fe:const o=t.getArrayBoundsAt(e),h=t.parseNumberArrayAt(e,!0);if(!h)throw new Error(`Invalid appearance stream array: \n            ${t.sliceChars(o.start,o.end)}`);{const t=h.value;2===t.length?r.push(...t):1===t.length?r.push(t[0],0):r.push(3,0)}e=o.end+1;break;case le:const c=rr.parse(t,e);r.push(c.value.literal),e=c.end+1;break;case pe:const d=lr.parse(t,e);r.push(d.value.hex),e=d.end+1;break;case he:const l=t.parseStringAt(e);s=l.value,e=l.end+1;break t;default:throw new Error(`Invalid appearance stream value type: ${n}`)}}return{endIndex:e,parameters:r,operator:s}}renderAsync(){return Nr(this,void 0,void 0,(function*(){return{svg:yield this.drawGroupAsync(this._parser),clipPaths:this._clipPaths}}))}pushState(t){const e=this._graphicsStates[this._graphicsStates.length-1].clone(t);this._graphicsStates.push(e)}popState(){return 1===this._graphicsStates.length?null:this._graphicsStates.pop()}drawPath(t,e,r,s=!1,n=!1){s&&"Z"!==t[t.length-1]&&(t+=" Z");const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("transform",`matrix(${this.state.matrix.toFloatShortArray().join(" ")})`),i.setAttribute("clipPath",`url(#${this._clipPaths[this._clipPaths.length-1].id})`),i.setAttribute("d",t),this.state.mixBlendMode&&i.setAttribute("mix-blend-mode",this.state.mixBlendMode),r?(i.setAttribute("fill",this.state.fill),i.setAttribute("fill-rule",n?"evenodd":"nonzero")):i.setAttribute("fill","none"),e?(i.setAttribute("stroke",this.state.stroke),i.setAttribute("stroke-width",this.state.strokeWidth+""),i.setAttribute("stroke-miterlimit",this.state.strokeMiterLimit+""),i.setAttribute("stroke-linecap",this.state.strokeLineCap),i.setAttribute("stroke-linejoin",this.state.strokeLineJoin),this.state.strokeDashArray&&i.setAttribute("stroke-dasharray",this.state.strokeDashArray),this.state.strokeDashOffset&&i.setAttribute("stroke-dashoffset",this.state.strokeDashOffset+"")):i.setAttribute("stroke","none"),i}drawText(t){throw new Error("Method is not implemented")}drawTextGroup(t){const e=document.createElementNS("http://www.w3.org/2000/svg","g");let r=0;for(;-1!==r;){const{endIndex:e,parameters:s,operator:n}=Rr.parseNextCommand(t,r);r=t.skipEmpty(e+1)}return e}drawGroupAsync(t){return Nr(this,void 0,void 0,(function*(){const e=document.createElementNS("http://www.w3.org/2000/svg","g"),r=new p;let s,n="";const i=t=>{e.append(t),n=""};let a=0;for(;-1!==a;){const{endIndex:o,parameters:h,operator:c}=Rr.parseNextCommand(t,a);switch(a=t.skipEmpty(o+1),c){case"q":this.pushState();break;case"Q":this.popState();break;case"gs":const o=this._stream.Resources.getGraphicsState(`/ExtGState${h[0]}`);if(!o)throw new Error("External state specified in appearance stream not found");const d=o.toParams();Object.assign(this.state,d);break;case"cm":const[l,u,g,w,y,A]=h,m=(new f).set(l,u,0,g,w,0,y,A,1);this.state.matrix=m.multiply(this.state.matrix);break;case"w":this.state.strokeWidth=+h[0]||1;break;case"J":switch(h[0]){case ve.ROUND:this.state.strokeLineCap="round";break;case ve.SQUARE:this.state.strokeLineCap="square";break;case ve.BUTT:default:this.state.strokeLineCap="butt"}break;case"j":switch(h[0]){case xe.BEVEL:this.state.strokeLineJoin="bevel";break;case xe.ROUND:this.state.strokeLineJoin="round";break;case xe.MITER:default:this.state.strokeLineJoin="miter"}break;case"M":this.state.strokeMiterLimit=+h[0]||10;break;case"d":this.state.strokeDashArray=`${h[0]} ${h[1]}`,this.state.strokeDashOffset=+h[2];break;case"CS":switch(h[0]){case Ee:this.state.strokeColorSpace="grayscale";break;case Ce:this.state.strokeColorSpace="rgb";break;case Se:this.state.strokeColorSpace="cmyk";break;default:throw new Error("Unsupported color space in appearance stream")}break;case"cs":switch(h[0]){case Ee:this.state.fillColorSpace="grayscale";break;case Ce:this.state.fillColorSpace="rgb";break;case Se:this.state.fillColorSpace="cmyk";break;default:throw new Error("Unsupported color space in appearance stream")}break;case"G":this.state.strokeColorSpace="grayscale",this.state.setColor("stroke",...h);break;case"g":this.state.fillColorSpace="grayscale",this.state.setColor("fill",...h);break;case"RG":this.state.strokeColorSpace="rgb",this.state.setColor("stroke",...h);break;case"rg":this.state.fillColorSpace="rgb",this.state.setColor("fill",...h);break;case"K":this.state.strokeColorSpace="cmyk",this.state.setColor("stroke",...h);break;case"k":this.state.fillColorSpace="cmyk",this.state.setColor("fill",...h);break;case"SC":this.state.setColor("stroke",...h);break;case"cs":this.state.setColor("fill",...h);break;case"ri":case"i":break;case"m":const v=new p(+h[0],+h[1]);n+=` M ${v.x} ${v.y}`,r.setFromVec2(v);break;case"l":const x=new p(+h[0],+h[1]);n+=` L ${x.x} ${x.y}`,r.setFromVec2(x);break;case"re":const b=new p(+h[0],+h[1]),_=new p(+h[2],+h[3]).add(b);n+=` M ${b.x} ${b.y} L ${_.x} ${b.y} L ${_.x} ${_.y} L ${b.x} ${_.y} L ${b.x} ${b.y}`,r.setFromVec2(b);break;case"c":const E=new p(+h[0],+h[1]),C=new p(+h[2],+h[3]),S=new p(+h[4],+h[5]);n+=` C ${E.x} ${E.y}, ${C.x} ${C.y}, ${S.x} ${S.y}`,r.setFromVec2(S);break;case"v":const P=new p(+h[0],+h[1]),k=new p(+h[2],+h[3]);n+=` C ${r.x} ${r.y}, ${P.x} ${P.y}, ${k.x} ${k.y}`,r.setFromVec2(k);break;case"y":const B=new p(+h[0],+h[1]),I=new p(+h[2],+h[3]);n+=` C ${B.x} ${B.y}, ${I.x} ${I.y}, ${I.x} ${I.y}`,r.setFromVec2(I);break;case"h":n+=" Z";break;case"S":i(this.drawPath(n,!0,!1));break;case"s":i(this.drawPath(n,!0,!1,!0));break;case"F":case"f":i(this.drawPath(n,!1,!0,!0));break;case"F*":case"f*":i(this.drawPath(n,!1,!0,!0,!0));break;case"B":i(this.drawPath(n,!0,!0,!1,!1));break;case"B*":i(this.drawPath(n,!0,!0,!1,!0));break;case"b":i(this.drawPath(n,!0,!0,!0,!1));break;case"b*":i(this.drawPath(n,!0,!0,!0,!0));break;case"n":if("W"===s||"W*"===s){"Z"!==n[n.length-1]&&(n+=" Z");const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",n);const e=this._clipPaths.length-1,r=document.createElementNS("http://www.w3.org/2000/svg","clipPath");r.setAttribute("clip-rule","W"===s?"nonzero":"evenodd"),r.setAttribute("clip-path",`url(#${this._clipPaths[e]})`),r.id=`clip${e+1}_${this._objectName}`,r.append(t),this._clipPaths.push(r),this.state.clipPath=r}n="";break;case"W":case"W*":break;case"BT":const M=t.findSubarrayIndex([H,X],{closedOnly:!0,minIndex:a});if(M){const r=this.drawTextGroup(new Ke(t.sliceCharCodes(a,M.start-1)));e.append(r),a=t.skipEmpty(M.end+1);break}throw new Error("Can't find the appearance stream text object end");case"Do":const N=this._stream.Resources.getXObject(`/XObject${h[0]}`);if(!N)throw new Error(`External object not found in the appearance stream resources: ${h[0]}`);if(N instanceof Cr){const t=yield this.drawGroupAsync(new Ke(N.decodedStreamData));e.append(t)}else{if(!(N instanceof fr))throw new Error(`Unsupported appearance stream external object: ${h[0]}`);{const t=yield N.getImageUrlAsync();if(!t)throw new Error("Can't get image url from external image stream");const r=document.createElementNS("http://www.w3.org/2000/svg","image");r.onerror=t=>{console.log(`Loading external image stream failed: ${t}`)},r.setAttribute("href",t),r.setAttribute("width",N.Width+""),r.setAttribute("height",N.Height+"");const s=(new f).applyTranslation(-N.Width/2,-N.Height/2).applyScaling(1,-1).applyTranslation(N.Width/2,N.Height/2).applyScaling(1/N.Width,1/N.Height).multiply(this.state.matrix);r.setAttribute("transform",`matrix(${s.toFloatShortArray().join(" ")})`),r.setAttribute("clipPath",`url(#${this._clipPaths[this._clipPaths.length-1].id})`),e.append(r)}}break;default:throw new Error(`Unsupported appearance stream operator: ${c}`)}s=c}return e}))}}var Dr=function(t,e,r,s){return new(r||(r=Promise))((function(n,i){function a(t){try{h(s.next(t))}catch(t){i(t)}}function o(t){try{h(s.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))};class Tr extends nr{constructor(t){super(Zt),this.F=0,this.Border=new Br(0,0,1),this._transformationMatrix=new f,this._transformationPoint=new p,this._currentAngle=0,this._boxX=new p,this._boxY=new p,this._svgId=o(),this.onRectPointerDown=t=>{document.addEventListener("pointerup",this.onRectPointerUp),document.addEventListener("pointerout",this.onRectPointerUp),this._transformationTimer=setTimeout((()=>{this._transformationTimer=null,this._svg.after(this._svgContentCopy),this._transformationPoint.setFromVec2(this.convertClientCoordsToPage(t.clientX,t.clientY)),document.addEventListener("pointermove",this.onRectPointerMove)}),200)},this.onRectPointerMove=t=>{const e=this.convertClientCoordsToPage(t.clientX,t.clientY);this._transformationMatrix.reset().applyTranslation(e.x-this._transformationPoint.x,e.y-this._transformationPoint.y),this._svgContentCopyUse.setAttribute("transform",`matrix(${this._transformationMatrix.toFloatShortArray().join(" ")})`)},this.onRectPointerUp=()=>{if(document.removeEventListener("pointermove",this.onRectPointerMove),document.removeEventListener("pointerup",this.onRectPointerUp),document.removeEventListener("pointerout",this.onRectPointerUp),this._transformationTimer)return clearTimeout(this._transformationTimer),void(this._transformationTimer=null);this._svgContentCopy.remove(),this._svgContentCopyUse.setAttribute("transform","matrix(1 0 0 1 0 0)"),this.applyRectTransform(this._transformationMatrix),this._transformationMatrix.reset(),this.updateRenderAsync()},this.onRotationHandlePointerDown=t=>{document.addEventListener("pointerup",this.onRotationHandlePointerUp),document.addEventListener("pointerout",this.onRotationHandlePointerUp),this._transformationTimer=setTimeout((()=>{this._transformationTimer=null,this._svg.after(this._svgContentCopy),document.addEventListener("pointermove",this.onRotationHandlePointerMove)}),200),t.stopPropagation()},this.onRotationHandlePointerMove=t=>{const e=(this.Rect[0]+this.Rect[2])/2,r=(this.Rect[1]+this.Rect[3])/2,s=this.convertPageCoordsToClient(e,r),n=this.getCurrentRotation(),i=Math.atan2(t.clientY-s.y,t.clientX-s.x)+Math.PI/2-n;this._currentAngle=i,this._transformationMatrix.reset().applyTranslation(-e,-r).applyRotation(i).applyTranslation(e,r),this._svgContentCopyUse.setAttribute("transform",`matrix(${this._transformationMatrix.toFloatShortArray().join(" ")})`)},this.onRotationHandlePointerUp=t=>{if(document.removeEventListener("pointermove",this.onRotationHandlePointerMove),document.removeEventListener("pointerup",this.onRotationHandlePointerUp),document.removeEventListener("pointerout",this.onRotationHandlePointerUp),this._transformationTimer)return clearTimeout(this._transformationTimer),void(this._transformationTimer=null);this._svgContentCopy.remove(),this._svgContentCopyUse.setAttribute("transform","matrix(1 0 0 1 0 0)"),this.applyRectTransform(this._transformationMatrix),this._transformationMatrix.reset(),this.updateRenderAsync()},this.onScaleHandlePointerDown=t=>{document.addEventListener("pointerup",this.onScaleHandlePointerUp),document.addEventListener("pointerout",this.onScaleHandlePointerUp);const e=t.target,{ll:r,lr:s,ur:n,ul:i}=this.getLocalBB(),a=e.dataset.handleName;switch(a){case"ll":this._transformationPoint.setFromVec2(n),this._boxX.setFromVec2(i).substract(n),this._boxY.setFromVec2(s).substract(n);break;case"lr":this._transformationPoint.setFromVec2(i),this._boxX.setFromVec2(n).substract(i),this._boxY.setFromVec2(r).substract(i);break;case"ur":this._transformationPoint.setFromVec2(r),this._boxX.setFromVec2(s).substract(r),this._boxY.setFromVec2(i).substract(r);break;case"ul":this._transformationPoint.setFromVec2(s),this._boxX.setFromVec2(r).substract(s),this._boxY.setFromVec2(n).substract(s);break;default:throw new Error(`Invalid handle name: ${a}`)}this._boxXLength=this._boxX.getMagnitude(),this._boxYLength=this._boxY.getMagnitude(),this._transformationTimer=setTimeout((()=>{this._transformationTimer=null,this._svg.after(this._svgContentCopy),document.addEventListener("pointermove",this.onScaleHandlePointerMove)}),200),t.stopPropagation()},this.onScaleHandlePointerMove=t=>{const e=this.convertClientCoordsToPage(t.clientX,t.clientY).substract(this._transformationPoint),r=e.getMagnitude(),s=Math.abs(e.dotProduct(this._boxX))/r/this._boxXLength*r,n=Math.sqrt(r*r-s*s),i=s/this._boxXLength,a=n/this._boxYLength,o=(this.Rect[0]+this.Rect[2])/2,h=(this.Rect[1]+this.Rect[3])/2,c=this.getCurrentRotation();this._transformationMatrix.reset().applyTranslation(-o,-h).applyRotation(-c).applyScaling(i,a).applyRotation(c).applyTranslation(o,h);const d=this._transformationPoint.clone().substract(this._transformationPoint.clone().applyMat3(this._transformationMatrix));this._transformationMatrix.applyTranslation(d.x,d.y),this._svgContentCopyUse.setAttribute("transform",`matrix(${this._transformationMatrix.toFloatShortArray().join(" ")})`)},this.onScaleHandlePointerUp=t=>{if(document.removeEventListener("pointermove",this.onScaleHandlePointerMove),document.removeEventListener("pointerup",this.onScaleHandlePointerUp),document.removeEventListener("pointerout",this.onScaleHandlePointerUp),this._transformationTimer)return clearTimeout(this._transformationTimer),void(this._transformationTimer=null);this._svgContentCopy.remove(),this._svgContentCopyUse.setAttribute("transform","matrix(1 0 0 1 0 0)"),this.applyRectTransform(this._transformationMatrix),this._transformationMatrix.reset(),this.updateRenderAsync()},this.Subtype=t}get apStream(){var t;return this._apStream||(this._apStream=[...null===(t=this.AP)||void 0===t?void 0:t.getStreams()][0]),this._apStream}set apStream(t){this._apStream=t,this._edited=!0}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];if(this.Subtype&&s.push(...r.encode("/Subtype "),...r.encode(this.Subtype)),this.Rect&&s.push(...r.encode("/Rect "),K,...r.encode(this.Rect[0]+""),_,...r.encode(this.Rect[1]+""),_,...r.encode(this.Rect[2]+""),_,...r.encode(this.Rect[3]+""),Y),this.Contents&&s.push(...r.encode("/Contents "),...this.Contents.toArray(t)),this.P&&s.push(...r.encode("/P "),_,...this.P.toArray(t)),this.NM&&s.push(...r.encode("/NM "),...this.NM.toArray(t)),this.M&&s.push(...r.encode("/M "),...this.M.toArray(t)),this.F&&s.push(...r.encode("/F "),...r.encode(" "+this.F)),this.AS&&s.push(...r.encode("/AS "),...r.encode(this.AS)),this.Border&&s.push(...r.encode("/Border "),...this.Border.toArray(t)),this.BS&&s.push(...r.encode("/BS "),...this.BS.toArray(t)),this.BE&&s.push(...r.encode("/BE "),...this.BE.toArray(t)),this.C&&(s.push(...r.encode("/C "),K),this.C.forEach((t=>s.push(...r.encode(" "+t)))),s.push(Y)),this.StructParent&&s.push(...r.encode("/StructParent "),...r.encode(" "+this.StructParent)),this.apStream){this.AP||(this.AP=new Sr);const e=this.apStream.ref;if(!e)throw new Error("Appearance stream has no reference");this.AP.N=tr.fromRef(e),this.AP.R=null,this.AP.D=null,this.AP.clearStreams(),this.AP.setStream("/N",this.apStream),s.push(...r.encode("/AP "),...this.AP.toArray(t))}const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}render(){return this._svg||(this._svg=this.renderMainElement()),this.updateRenderAsync(),{svg:this._svg,clipPaths:this._svgClipPaths}}parseProps(t){var e;super.parseProps(t);const{parser:r,bounds:s}=t,n=s.contentStart||s.start,i=s.contentEnd||s.end;let a,h,c=r.skipToNextName(n,i-1);for(;h=r.parseNameAt(c),h;)switch(c=h.end+1,a=h.value,a){case"/Subtype":const e=r.parseNameAt(c);if(!e)throw new Error("Can't parse /Subtype property value");if(this.Subtype&&this.Subtype!==e.value)throw new Error(`Ivalid dict subtype: '${e.value}' instead of '${this.Subtype}'`);c=e.end+1;break;case"/Rect":c=this.parseNumberArrayProp(a,r,c,!0);break;case"/P":c=this.parseRefProp(a,r,c);break;case"/Contents":case"/NM":c=this.parseLiteralProp(a,r,c,t.cryptInfo);break;case"/M":const s=er.parse(r,c,t.cryptInfo);if(s){this.M=s.value,c=s.end+1;break}{const e=rr.parse(r,c,t.cryptInfo);if(e){this.M=e.value,c=e.end+1;break}}throw new Error("Can't parse /M property value");case"/C":c=this.parseNumberArrayProp(a,r,c,!0);break;case"/F":case"/StructParent":c=this.parseNumberProp(a,r,c,!1);break;case"/Border":const n=Br.parse(r,c);if(!n)throw new Error("Can't parse /Border property value");this.Border=n.value,c=n.end+1;break;case"/BS":const o=r.getValueTypeAt(c);if(o===ye){const e=tr.parseRef(r,c);if(e&&t.parseInfoGetter){const r=t.parseInfoGetter(e.value.id);if(r){const t=wr.parse(r);if(t){this.BS=t.value,c=t.end+1;break}}}throw new Error("Can't parse /BS value reference")}if(o===ge){const t=r.getDictBoundsAt(c);if(t){const e=wr.parse({parser:r,bounds:t});if(e){this.BS=e.value,c=e.end+1;break}}throw new Error("Can't parse /BS value dictionary")}throw new Error(`Unsupported /BS property value type: ${o}`);case"/BE":const h=r.getValueTypeAt(c);if(h===ye){const e=tr.parseRef(r,c);if(e&&t.parseInfoGetter){const r=t.parseInfoGetter(e.value.id);if(r){const t=kr.parse(r);if(t){this.BE=t.value,c=t.end+1;break}}}throw new Error("Can't parse /BE value reference")}if(h===ge){const t=r.getDictBoundsAt(c);if(t){const e=kr.parse({parser:r,bounds:t});if(e){this.BE=e.value,c=e.end+1;break}}throw new Error("Can't parse /BE value dictionary")}throw new Error(`Unsupported /BE property value type: ${h}`);case"/AP":const d=r.getValueTypeAt(c);if(d===ye){const e=tr.parseRef(r,c);if(e&&t.parseInfoGetter){const r=t.parseInfoGetter(e.value.id);if(r){const t=Sr.parse(r);if(t){this.AP=t.value,c=t.end+1;break}}}throw new Error("Can't parse /AP value reference")}if(d===ge){const e=r.getDictBoundsAt(c);if(e){const s=Sr.parse({parser:r,bounds:e,parseInfoGetter:t.parseInfoGetter});if(s){this.AP=s.value,c=s.end+1;break}}throw new Error("Can't parse /AP value dictionary")}throw new Error(`Unsupported /AP property value type: ${d}`);case"/AS":c=this.parseNameProp(a,r,c);break;case"/OC":default:c=r.skipToNextName(c,i-1)}if(!this.Subtype||!this.Rect)throw new Error("Not all required properties parsed");this.name=(null===(e=this.NM)||void 0===e?void 0:e.literal)||o(),this.pageRect=t.rect}applyRectTransform(t){const e=this._proxy||this,r=e.getLocalBB();r.ll.applyMat3(t),r.lr.applyMat3(t),r.ur.applyMat3(t),r.ul.applyMat3(t);const{min:s,max:n}=w(r.ll,r.lr,r.ur,r.ul);e.Rect=[s.x,s.y,n.x,n.y];const i=e.apStream;if(i){const r=i.matrix.multiply(t);e.apStream.matrix=r}e.M=er.fromDate(new Date)}getCurrentRotation(){var t;const e=null===(t=this.apStream)||void 0===t?void 0:t.matrix;if(!e)return 0;const{r:r}=e.getTRS();return r}getLocalBB(){let t,e,r,s;if(this._bBox)t=this._bBox.ll,e=this._bBox.lr,r=this._bBox.ur,s=this._bBox.ul;else if(this.apStream){const{ll:n,lr:i,ur:a,ul:o}=this.apStream.transformedBBox,{min:h,max:c}=w(n,i,a,o),d=g(h,c,new p(this.Rect[0],this.Rect[1]),new p(this.Rect[2],this.Rect[3]),!0);t=n.applyMat3(d),e=i.applyMat3(d),r=a.applyMat3(d),s=o.applyMat3(d)}else t=new p(this.Rect[0],this.Rect[1]),e=new p(this.Rect[2],this.Rect[1]),r=new p(this.Rect[2],this.Rect[3]),s=new p(this.Rect[0],this.Rect[3]);return this._bBox={ll:t,lr:e,ur:r,ul:s},this._bBox}convertClientCoordsToPage(t,e){const{x:r,y:s,width:n,height:i}=this._svgBox.getBoundingClientRect(),a=new p(r,s),o=(new p(r+n,s+i).x-a.x)/(this.Rect[2]-this.Rect[0]),h=new p(r-this.Rect[0]*o,s+i+this.Rect[1]*o);return new p((t-h.x)/o,(h.y-e)/o)}convertPageCoordsToClient(t,e){const{x:r,y:s,width:n,height:i}=this._svgBox.getBoundingClientRect(),a=new p(r,s),o=(new p(r+n,s+i).x-a.x)/(this.Rect[2]-this.Rect[0]),h=new p(r-this.Rect[0]*o,s+i+this.Rect[1]*o);return new p(h.x+t*o,h.y-e*o)}renderRect(){const t=document.createElementNS("http://www.w3.org/2000/svg","rect");return t.classList.add("svg-annot-rect"),t.setAttribute("data-annotation-name",this.name),t.setAttribute("x",this.Rect[0]+""),t.setAttribute("y",this.Rect[1]+""),t.setAttribute("width",this.Rect[2]-this.Rect[0]+""),t.setAttribute("height",this.Rect[3]-this.Rect[1]+""),t}renderBox(){const{ll:t,lr:e,ur:r,ul:s}=this.getLocalBB(),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.classList.add("svg-annot-box"),n.setAttribute("data-annotation-name",this.name),n.setAttribute("d",`M ${t.x} ${t.y} L ${e.x} ${e.y} L ${r.x} ${r.y} L ${s.x} ${s.y} Z`),n}renderMainElement(){const t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.classList.add("svg-annotation"),t.setAttribute("data-annotation-name",this.name),t.addEventListener("pointerdown",this.onRectPointerDown),t}renderApAsync(){return Dr(this,void 0,void 0,(function*(){const t=this.apStream;if(t)try{const e=new Rr(t,this.Rect,this.name);return yield e.renderAsync()}catch(t){console.log(`Annotation stream render error: ${t.message}`)}return null}))}renderContent(){return null}renderContentCopy(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","defs"),r=document.createElementNS("http://www.w3.org/2000/svg","symbol");r.id=this._svgId+"_symbol";const s=document.createElementNS("http://www.w3.org/2000/svg","use");s.setAttribute("href",`#${this._svgId}`),s.setAttribute("viewBox",`${this.pageRect[0]} ${this.pageRect[1]} ${this.pageRect[2]} ${this.pageRect[3]}`),r.append(s),e.append(r);const n=document.createElementNS("http://www.w3.org/2000/svg","use");return n.setAttribute("href",`#${this._svgId}_symbol`),n.setAttribute("opacity","0.2"),t.append(e,n),{copy:t,use:n}}renderScaleHandles(){const t=this.getLocalBB(),e=[];return["ll","lr","ur","ul"].forEach((r=>{const s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.classList.add("svg-annot-handle-scale"),s.setAttribute("data-handle-name",r),s.setAttribute("cx",t[r].x+""),s.setAttribute("cy",t[r].y+""),s.addEventListener("pointerdown",this.onScaleHandlePointerDown),e.push(s)})),e}renderRotationHandle(){const t=(this.Rect[0]+this.Rect[2])/2,e=(this.Rect[1]+this.Rect[3])/2,r=this.getCurrentRotation(),s=document.createElementNS("http://www.w3.org/2000/svg","g");s.classList.add("svg-annot-rotation"),s.setAttribute("data-handle-name","center");const n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.classList.add("circle","dashed"),n.setAttribute("cx",t+""),n.setAttribute("cy",e+"");const i=(new f).applyTranslation(-t,35-e).applyRotation(r).applyTranslation(t,e),a=new p(t,e).applyMat3(i),o=document.createElementNS("http://www.w3.org/2000/svg","line");o.classList.add("dashed"),o.setAttribute("x1",t+""),o.setAttribute("y1",e+""),o.setAttribute("x2",a.x+""),o.setAttribute("y2",a.y+"");const h=document.createElementNS("http://www.w3.org/2000/svg","circle");return h.classList.add("svg-annot-handle-rotation"),h.setAttribute("data-handle-name","center"),h.setAttribute("cx",a.x+""),h.setAttribute("cy",a.y+""),h.addEventListener("pointerdown",this.onRotationHandlePointerDown),s.append(n,o,h),s}renderHandles(){return[...this.renderScaleHandles(),this.renderRotationHandle()]}updateRenderAsync(){return Dr(this,void 0,void 0,(function*(){this._svg.innerHTML="";const t=this.renderContent()||(yield this.renderApAsync());if(!t)return this._svgBox=null,this._svgContent=null,this._svgContentCopy=null,this._svgContentCopyUse=null,void(this._svgClipPaths=null);const e=t.svg;e.id=this._svgId,e.classList.add("svg-annotation-content"),e.setAttribute("data-annotation-name",this.name);const{copy:r,use:s}=this.renderContentCopy(),n=this.renderRect(),i=this.renderBox(),a=this.renderHandles();this._svg.append(n,i,t.svg,...a),this._svgBox=i,this._svgContent=e,this._svgContentCopy=r,this._svgContentCopyUse=s,this._svgClipPaths=t.clipPaths}))}}const Lr={REPLY:"/R",GROUP:"/Group"};class Ur extends Tr{constructor(t){super(t),this.RT=Lr.REPLY}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.T&&s.push(...r.encode("/T "),...this.T.toArray(t)),this.Popup&&s.push(...r.encode("/Popup "),_,...this.Popup.toArray(t)),this.RC&&s.push(...r.encode("/RC "),...this.RC.toArray(t)),this.CA&&s.push(...r.encode("/CA "),...r.encode(" "+this.CA)),this.CreationDate&&s.push(...r.encode("/CreationDate "),...this.CreationDate.toArray(t)),this.Subj&&s.push(...r.encode("/Subj "),...this.Subj.toArray(t)),this.IRT&&s.push(...r.encode("/IRT "),_,...this.IRT.toArray(t)),this.RT&&s.push(...r.encode("/RT "),...r.encode(this.RT));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/T":case"/Subj":o=this.parseLiteralProp(i,e,o,t.cryptInfo);break;case"/Popup":case"/IRT":o=this.parseRefProp(i,e,o);break;case"/RC":const r=e.getValueTypeAt(o);if(r===ye){const r=tr.parseRef(e,o);if(r&&t.parseInfoGetter){const e=t.parseInfoGetter(r.value.id);if(e){const t=e.type||e.parser.getValueTypeAt(e.bounds.contentStart);if(t===le){const t=rr.parse(e.parser,e.bounds.contentStart);if(t){this.RC=t.value,o=r.end+1;break}}else{if(t!==ge)throw new Error(`Unsupported /RC property value type: ${t}`);{const t=dr.parse(e);if(t){const e=t.value.getText();this.RC=rr.fromString(e),o=r.end+1;break}}}}}throw new Error("Can't parse /RC value reference")}if(r===le){const r=rr.parse(e,o,t.cryptInfo);if(r){this.RC=r.value,o=r.end+1;break}throw new Error("Can't parse /RC property value")}throw new Error(`Unsupported /RC property value type: ${r}`);case"/CA":o=this.parseNumberProp(i,e,o,!0);break;case"/CreationDate":o=this.parseDateProp(i,e,o,t.cryptInfo);break;case"/RT":const s=e.parseNameAt(o,!0);if(!s||!Object.values(Lr).includes(s.value))throw new Error("Can't parse /RT property value");this.RT=s.value,o=s.end+1;break;case"/ExData":break;default:o=e.skipToNextName(o,n-1)}if(!this.Subtype||!this.Rect)throw new Error("Not all required properties parsed")}}class Or{constructor(t,e,r,s){this.writeImageXObject=t=>{const e=t.sMask;if(this.isNew(e)){const r=this.writeIndirectObject(e);t.SMask=tr.fromRef(r)}else e.edited&&this.writeUpdatedIndirectObject(e);return this.isNew(t)?this.writeIndirectObject(t):t.edited?this.writeUpdatedIndirectObject(t):{id:t.id,generation:t.generation,byteOffset:this._refData.getOffset(t.id)}},this._lastXref=e,this._refData=r,this._changeData=new Ze(r),this._writer=new $e(t),this._stringCryptor=null==s?void 0:s.stringCryptor,this._streamCryptor=null==s?void 0:s.streamCryptor}getDataWithUpdatedAnnotations(t){for(const{page:e,supportedAnnotations:r,allAnnotationIds:s}of t)if(null==r?void 0:r.length){for(const t of r)if(t.deleted){if(!t.ref)continue;const e=s.findIndex((e=>e.id===t.id));s.splice(e,1),this._changeData.setRefFree(t.id),t instanceof Ur&&t.Popup&&this._changeData.setRefFree(t.Popup.id)}else if(!t.ref||t.edited){const e=t.apStream;if(e&&this.writeFormXObject(e),this.isNew(t)){const e=this.writeIndirectObject(t);s.push(tr.fromRef(e))}else this.writeUpdatedIndirectObject(t)}if(e.Annots instanceof tr&&this._changeData.isUsedInSource(e.Annots.id)){const t={id:e.Annots.id,generation:e.Annots.generation,byteOffset:this._writer.offset},r={ref:t,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};this._changeData.updateUsedRef(t),this._writer.writeIndirectArray(r,s)}else{const t=this._changeData.takeFreeRef(this._writer.offset,!0),r={ref:t,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};this._writer.writeIndirectArray(r,s),e.Annots=tr.fromRef(t)}this.writeUpdatedIndirectObject(e)}this.writeXref();const e=this._writer.getCurrentData(),r=new Ke(e);return console.log(r.sliceChars(r.maxIndex-3e3,r.maxIndex)),e}isNew(t){return!t.ref||!this._changeData.isUsedInSource(t.id)}writeIndirectObject(t){const e=this._changeData.takeFreeRef(this._writer.offset,!0),r={ref:e,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};return this._writer.writeIndirectObject(r,t),t.ref=e,e}writeUpdatedIndirectObject(t){const e={id:t.id,generation:t.generation,byteOffset:this._writer.offset},r={ref:e,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};return this._changeData.updateUsedRef(e),this._writer.writeIndirectObject(r,t),e}writeFormXObject(t){const e=t.Resources;return e&&e.edited&&[...e.getXObjects()].forEach((([t,e])=>{e instanceof fr?this.writeImageXObject(e):this.writeFormXObject(e)})),this.isNew(t)?this.writeIndirectObject(t):t.edited?this.writeUpdatedIndirectObject(t):{id:t.id,generation:t.generation,byteOffset:this._refData.getOffset(t.id)}}writeXref(){const t=this._writer.offset,e=this._changeData.takeFreeRef(t,!0),r=this._changeData.exportEntries();console.log(r);const s=this._lastXref.createUpdate(r,t);return this._writer.writeIndirectObject({ref:e},s),this._writer.writeEof(t),t}}class Fr extends cr{constructor(){super(jt)}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Fr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Size&&s.push(...r.encode("/Size "),...r.encode(" "+this.Size)),this.Prev&&s.push(...r.encode("/Prev "),...r.encode(" "+this.Prev)),this.Root&&s.push(...r.encode("/Root "),_,...this.Root.toArray(t)),this.Encrypt&&s.push(...r.encode("/Encrypt "),_,...this.Encrypt.toArray(t)),this.Info&&s.push(...r.encode("/Info "),_,...this.Info.toArray(t)),this.ID&&s.push(...r.encode("/ID "),K,...this.ID[0].toArray(t),...this.ID[1].toArray(t),Y),this.Index&&(s.push(...r.encode("/Index "),K),this.Index.forEach((t=>s.push(...r.encode(" "+t)))),s.push(Y)),this.W&&s.push(...r.encode("/W "),K,...r.encode(this.W[0]+""),_,...r.encode(this.W[1]+""),_,...r.encode(this.W[2]+""),Y);const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){var e;super.parseProps(t);const{parser:r,bounds:s}=t,n=s.contentStart||s.start,i=r.getDictBoundsAt(n);let a,o,h=r.skipToNextName(i.contentStart,i.contentEnd);for(;o=r.parseNameAt(h),o;)switch(h=o.end+1,a=o.value,a){case"/Size":case"/Prev":h=this.parseNumberProp(a,r,h,!1);break;case"/Root":case"/Info":h=this.parseRefProp(a,r,h);break;case"/Encrypt":const t=r.getValueTypeAt(h);if(t===ye){const t=tr.parseRef(r,h);if(t){this.Encrypt=t.value,h=t.end+1;break}throw new Error("Can't parse /Encrypt property value")}throw new Error(`Unsupported /Encrypt property value type: ${t}`);case"/ID":const e=lr.parseArray(r,h);if(!e)throw new Error("Can't parse /ID property value");this.ID=[e.value[0],e.value[1]],h=e.end+1;break;case"/Index":case"/W":h=this.parseNumberArrayProp(a,r,h,!1);break;default:h=r.skipToNextName(h,i.contentEnd)}if(!this.W||!this.Size||!this.Root||this.Encrypt&&!this.ID)throw new Error("Not all required properties parsed");(null===(e=this.Index)||void 0===e?void 0:e.length)||(this.Index=[0,this.Size])}}class Vr{constructor(t){this._type=t}get type(){return this._type}get offset(){return this._offset}}class zr extends Vr{constructor(t,e){super(St),this._trailerStream=t,this._offset=e}get prev(){var t;return null===(t=this._trailerStream)||void 0===t?void 0:t.Prev}get size(){var t;return null===(t=this._trailerStream)||void 0===t?void 0:t.Size}get root(){var t;return null===(t=this._trailerStream)||void 0===t?void 0:t.Root}get info(){var t;return null===(t=this._trailerStream)||void 0===t?void 0:t.Root}get encrypt(){var t;return null===(t=this._trailerStream)||void 0===t?void 0:t.Encrypt}get id(){var t;return null===(t=this._trailerStream)||void 0===t?void 0:t.ID}static createFrom(t,e,r){if(!(null==e?void 0:e.length)||!t)return null;const s=Math.max(...e.map((t=>t.id)))+1,n=Math.max(s,t.size);return zr.create(e,n,r,t.root,t.offset,t.info,t.encrypt,t.id)}static create(t,e,r,s,n,i,a,o){if(!((null==t?void 0:t.length)&&e&&r&&s))return null;const h=new Fr;h.Size=e,h.Root=s,h.Prev=n,h.Info=i,h.Encrypt=a,h.ID=o;const c=[1,4,2],d=c[0]+c[1]+c[2],l=new ir;l.setIntProp("/Predictor",Ot),l.setIntProp("/Columns",d),l.setIntProp("/Colors",1),l.setIntProp("/BitsPerComponent",8);const p=Je.toStreamBytes(t,c),u=new zr(h,r);return u._trailerStream.Filter=Mt,u._trailerStream.DecodeParms=l,u._trailerStream.W=c,u._trailerStream.Index=p.index,u._trailerStream.streamData=p.bytes,u}static parse(t,e){if(!t)return null;const r=Fr.parse(t);if(!r)return null;return{value:new zr(r.value,e),start:null,end:null}}createUpdate(t,e){return zr.createFrom(this,t,e)}getEntries(){if(!this._trailerStream)return[];return Je.fromStreamBytes(this._trailerStream.decodedStreamData,this._trailerStream.W,this._trailerStream.Index)}toArray(t){return this._trailerStream.toArray(t)}}class Hr extends nr{constructor(){super(ae)}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Hr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Size&&s.push(...r.encode("/Size "),...r.encode(" "+this.Size)),this.Prev&&s.push(...r.encode("/Prev "),...r.encode(" "+this.Prev)),this.Root&&s.push(...r.encode("/Root "),_,...this.Root.toArray(t)),this.Encrypt&&s.push(...r.encode("/Encrypt "),_,...this.Encrypt.toArray(t)),this.Info&&s.push(...r.encode("/Info "),_,...this.Info.toArray(t)),this.ID&&s.push(...r.encode("/ID "),K,...this.ID[0].toArray(t),...this.ID[1].toArray(t),Y);const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Size":case"/Prev":o=this.parseNumberProp(i,e,o,!1);break;case"/Root":case"/Info":o=this.parseRefProp(i,e,o);break;case"/Encrypt":const t=e.getValueTypeAt(o);if(t===ye){const t=tr.parseRef(e,o);if(t){this.Encrypt=t.value,o=t.end+1;break}throw new Error("Can't parse /Encrypt property value")}throw new Error(`Unsupported /Encrypt property value type: ${t}`);case"/ID":const r=lr.parseArray(e,o);if(!r)throw new Error("Can't parse /ID property value");this.ID=[r.value[0],r.value[1]],o=r.end+1;break;default:o=e.skipToNextName(o,n-1)}if(!this.Size||!this.Root||this.Encrypt&&!this.ID)throw new Error("Not all required properties parsed")}}class Wr extends Vr{constructor(t,e,r){super(Ct),this._table=t,this._trailerDict=e,this._offset=r}get prev(){var t;return null===(t=this._trailerDict)||void 0===t?void 0:t.Prev}get size(){var t;return null===(t=this._trailerDict)||void 0===t?void 0:t.Size}get root(){var t;return null===(t=this._trailerDict)||void 0===t?void 0:t.Root}get info(){var t;return null===(t=this._trailerDict)||void 0===t?void 0:t.Root}get encrypt(){var t;return null===(t=this._trailerDict)||void 0===t?void 0:t.Encrypt}get id(){var t;return null===(t=this._trailerDict)||void 0===t?void 0:t.ID}static createFrom(t,e,r){if(!(null==e?void 0:e.length)||!t)return null;const s=Math.max(...e.map((t=>t.id)))+1,n=Math.max(s,t.size);return Wr.create(e,n,r,t.root,t.offset,t.info,t.encrypt,t.id)}static create(t,e,r,s,n,i,a,o){if(!((null==t?void 0:t.length)&&e&&r&&s))return null;const h=new Hr;h.Size=e,h.Prev=n,h.Root=s,h.Info=i,h.Encrypt=a,h.ID=o;const c=Je.toTableBytes(t);return new Wr(c,h,r)}static parse(t,e,r){if(!t||isNaN(e))return null;const s=t.getXrefTableBoundsAt(e);if(!s)return null;const n=t.getDictBoundsAt(s.end+1);if(!n)return null;const i=t.sliceCharCodes(s.contentStart,s.contentEnd),a=Hr.parse({parser:t,bounds:n});if(!a)return null;return{value:new Wr(i,a.value,r),start:null,end:null}}createUpdate(t,e){return Wr.createFrom(this,t,e)}getEntries(){if(!this._table.length)return[];return Je.fromTableBytes(this._table)}toArray(t){const e=this._trailerDict.toArray(t),r=[...gt.XREF_TABLE,...gt.END_OF_LINE,...this._table,...gt.TRAILER,...gt.END_OF_LINE,...e,...gt.END_OF_LINE];return new Uint8Array(r)}}class Gr extends nr{constructor(){super(Kt)}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Gr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Version&&s.push(...r.encode("/Version "),...r.encode(this.Version)),this.Pages&&s.push(...r.encode("/Pages "),_,...this.Pages.toArray(t)),this.Lang&&s.push(...r.encode("/Lang "),...this.Lang.toArray(t));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Version":o=this.parseNameProp(i,e,o);break;case"/Pages":o=this.parseRefProp(i,e,o);break;case"/Lang":o=this.parseLiteralProp(i,e,o,t.cryptInfo);break;default:o=e.skipToNextName(o,n-1)}if(!this.Pages)throw new Error("Not all required properties parsed")}}class Qr extends nr{constructor(){super(Yt),this.Rotate=0}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Qr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Parent&&s.push(...r.encode("/Parent "),_,...this.Parent.toArray(t)),this.LastModified&&s.push(...r.encode("/LastModified "),...this.LastModified.toArray(t)),this.Resources&&s.push(...r.encode("/Resources "),...this.Resources.toArray(t)),this.MediaBox&&s.push(...r.encode("/MediaBox "),K,...r.encode(this.MediaBox[0]+""),_,...r.encode(this.MediaBox[1]+""),_,...r.encode(this.MediaBox[2]+""),_,...r.encode(this.MediaBox[3]+""),Y),this.CropBox&&s.push(...r.encode("/CropBox "),K,...r.encode(this.CropBox[0]+""),_,...r.encode(this.CropBox[1]+""),_,...r.encode(this.CropBox[2]+""),_,...r.encode(this.CropBox[3]+""),Y),this.BleedBox&&s.push(...r.encode("/BleedBox "),K,...r.encode(this.BleedBox[0]+""),_,...r.encode(this.BleedBox[1]+""),_,...r.encode(this.BleedBox[2]+""),_,...r.encode(this.BleedBox[3]+""),Y),this.TrimBox&&s.push(...r.encode("/TrimBox "),K,...r.encode(this.TrimBox[0]+""),_,...r.encode(this.TrimBox[1]+""),_,...r.encode(this.TrimBox[2]+""),_,...r.encode(this.TrimBox[3]+""),Y),this.ArtBox&&s.push(...r.encode("/ArtBox "),K,...r.encode(this.ArtBox[0]+""),_,...r.encode(this.ArtBox[1]+""),_,...r.encode(this.ArtBox[2]+""),_,...r.encode(this.ArtBox[3]+""),Y),this.Contents&&(this.Contents instanceof tr?s.push(...r.encode("/Contents "),_,...this.Contents.toArray(t)):(s.push(...r.encode("/Contents "),K),this.Contents.forEach((e=>s.push(_,...e.toArray(t)))),s.push(Y))),this.Rotate&&s.push(...r.encode("/Rotate "),...r.encode(" "+this.Rotate)),this.Thumb&&s.push(...r.encode("/Thumb "),_,...this.Thumb.toArray(t)),this.B&&(this.B instanceof tr?s.push(...r.encode("/B "),_,...this.B.toArray(t)):(s.push(...r.encode("/B "),K),this.B.forEach((e=>s.push(_,...e.toArray(t)))),s.push(Y))),this.Dur&&s.push(...r.encode("/Dur "),...r.encode(" "+this.Dur)),this.Annots&&(this.Annots instanceof tr?s.push(...r.encode("/Annots "),_,...this.Annots.toArray(t)):(s.push(...r.encode("/Annots "),K),this.Annots.forEach((e=>s.push(_,...e.toArray(t)))),s.push(Y))),this.Metadata&&s.push(...r.encode("/Metadata "),_,...this.Metadata.toArray(t)),this.StructParent&&s.push(...r.encode("/StructParent "),...r.encode(" "+this.StructParent)),this.ID&&s.push(...r.encode("/ID "),_,...this.ID.toArray(t)),this.PZ&&s.push(...r.encode("/PZ "),...r.encode(" "+this.PZ)),this.Tabs&&s.push(...r.encode("/Tabs "),...r.encode(this.Tabs)),this.TemplateInstantiated&&s.push(...r.encode("/TemplateInstantiated "),...r.encode(this.TemplateInstantiated)),this.UserUnit&&s.push(...r.encode("/UserUnit "),...r.encode(" "+this.UserUnit));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Parent":case"/Thumb":case"/Metadata":o=this.parseRefProp(i,e,o);break;case"/LastModified":o=this.parseDateProp(i,e,o,t.cryptInfo);break;case"/Resources":const r=e.getValueTypeAt(o);if(r===ye){const r=tr.parseRef(e,o);if(r&&t.parseInfoGetter){const e=t.parseInfoGetter(r.value.id);if(e){const t=xr.parse(e);if(t){this.Resources=t.value,o=t.end+1;break}}}throw new Error("Can't parse /Resources value reference")}if(r===ge){const r=e.getDictBoundsAt(o);if(r){if(r.contentStart){const s=xr.parse({parser:e,bounds:r,parseInfoGetter:t.parseInfoGetter});if(!s)throw new Error("Can't parse /Resources value dictionary");this.Resources=s.value}o=r.end+1;break}throw new Error("Can't parse /Resources dictionary bounds")}throw new Error(`Unsupported /Resources property value type: ${r}`);case"/MediaBox":case"/CropBox":case"/BleedBox":case"/TrimBox":case"/ArtBox":o=this.parseNumberArrayProp(i,e,o,!0);break;case"/Contents":case"/B":case"/Annots":const s=e.getValueTypeAt(o);if(s===ye){const t=tr.parseRef(e,o);if(t){this[i.slice(1)]=t.value,o=t.end+1;break}}else if(s===fe){const t=tr.parseRefArray(e,o);if(t){this[i.slice(1)]=t.value,o=t.end+1;break}}throw new Error(`Unsupported ${i} property value type: ${s}`);case"/Rotate":case"/Dur":case"/StructParent":case"/PZ":case"/UserUnit":o=this.parseNumberProp(i,e,o,!1);break;case"/ID":const a=e.getValueTypeAt(o);if(a===ye){const r=tr.parseRef(e,o);if(r&&r&&t.parseInfoGetter){const e=t.parseInfoGetter(r.value.id);if(e){const t=lr.parse(e.parser,e.bounds.start,e.cryptInfo);if(t){this.ID=t.value,o=r.end+1;break}}}throw new Error("Can't parse /ID property value")}if(a===pe){const r=lr.parse(e,o,t.cryptInfo);if(r){this.ID=r.value,o=r.end+1;break}}throw new Error(`Unsupported /ID property value type: ${a}`);case"/Tabs":case"/TemplateInstantiated":o=this.parseNameProp(i,e,o);break;default:o=e.skipToNextName(o,n-1)}if(!this.Parent)throw new Error("Not all required properties parsed")}}class jr extends nr{constructor(){super(Jt),this.Rotate=0}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new jr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Parent&&s.push(...r.encode("/Parent "),_,...this.Parent.toArray(t)),this.Kids&&(s.push(...r.encode("/Kids "),K),this.Kids.forEach((e=>s.push(_,...e.toArray(t)))),s.push(Y)),this.Count&&s.push(...r.encode("/Count "),...r.encode(" "+this.Count)),this.MediaBox&&s.push(...r.encode("/MediaBox "),K,...r.encode(this.MediaBox[0]+""),_,...r.encode(this.MediaBox[1]+""),_,...r.encode(this.MediaBox[2]+""),_,...r.encode(this.MediaBox[3]+""),Y),this.Rotate&&s.push(...r.encode("/Rotate "),...r.encode(" "+this.Rotate));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Parent":o=this.parseRefProp(i,e,o);break;case"/Kids":o=this.parseRefArrayProp(i,e,o);break;case"/Count":case"/Rotate":o=this.parseNumberProp(i,e,o,!1);break;case"/MediaBox":o=this.parseNumberArrayProp(i,e,o,!0);break;default:o=e.skipToNextName(o,n-1)}if(!this.Kids||isNaN(this.Count))throw new Error("Not all required properties parsed")}}class Xr extends nr{constructor(){super(re),this.CFM=Gt.NONE,this.AuthEvent=Qt.DOC_OPEN,this.Length=40,this.EncryptMetadata=!0}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Xr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.CFM&&s.push(...r.encode("/CFM "),...r.encode(this.CFM)),this.AuthEvent&&s.push(...r.encode("/AuthEvent "),...r.encode(this.AuthEvent)),this.Length&&s.push(...r.encode("/Length "),...r.encode(" "+this.Length)),this.EncryptMetadata&&s.push(...r.encode("/EncryptMetadata "),...r.encode(" "+this.EncryptMetadata)),this.Recipients&&(this.Recipients instanceof lr?s.push(...r.encode("/Recipients "),...this.Recipients.toArray(t)):(s.push(K),this.Recipients.forEach((e=>s.push(...e.toArray(t)))),s.push(Y)));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/CFM":const r=e.parseNameAt(o,!0);if(!r||!Object.values(Gt).includes(r.value))throw new Error("Can't parse /CFM property value");this.CFM=r.value,o=r.end+1;break;case"/AuthEvent":const s=e.parseNameAt(o,!0);if(!s||!Object.values(Qt).includes(s.value))throw new Error("Can't parse /AuthEvent property value");this.AuthEvent=s.value,o=s.end+1;break;case"/Length":o=this.parseNumberProp(i,e,o,!1);break;case"/EncryptMetadata":o=this.parseBoolProp(i,e,o);break;case"/Recipients":const a=e.getValueTypeAt(o);if(a===pe){const r=lr.parse(e,o,t.cryptInfo);if(r){this.Recipients=r.value,o=r.end+1;break}throw new Error("Can't parse /Recipients property value")}if(a===fe){const t=lr.parseArray(e,o);if(t){this.Recipients=t.value,o=t.end+1;break}throw new Error("Can't parse /Recipients property value")}throw new Error(`Unsupported /Filter property value type: ${a}`);default:o=e.skipToNextName(o,n-1)}}}class qr extends nr{constructor(){super(null),this._filtersMap=new Map}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new qr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}getProp(t){return this._filtersMap.get(t)}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this._filtersMap.size&&this._filtersMap.forEach(((e,n)=>s.push(...r.encode(n),...e.toArray(t))));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){default:if(e.getValueTypeAt(o)===ge){const t=e.getDictBoundsAt(o);if(t){const r=Xr.parse({parser:e,bounds:t});if(r){this._filtersMap.set(i,r.value),o=r.end+1;break}}}o=e.skipToNextName(o,n-1)}}}class Kr extends nr{constructor(){super(ae),this.Filter="/Standard",this.Length=40,this.StmF="/Identity",this.StrF="/Identity",this.EncryptMetadata=!0}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Kr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Filter&&s.push(...r.encode("/Filter "),...r.encode(this.Filter)),this.SubFilter&&s.push(...r.encode("/SubFilter "),...r.encode(this.SubFilter)),this.V&&s.push(...r.encode("/V "),...r.encode(" "+this.V)),this.Length&&s.push(...r.encode("/Length "),...r.encode(" "+this.Length)),this.CF&&s.push(...r.encode("/CF "),...this.CF.toArray(t)),this.StmF&&s.push(...r.encode("/StmF "),...r.encode(this.StmF)),this.StrF&&s.push(...r.encode("/StrF "),...r.encode(this.StrF)),this.EFF&&s.push(...r.encode("/EFF "),...r.encode(this.EFF)),this.R&&s.push(...r.encode("/R "),...r.encode(" "+this.R)),this.O&&s.push(...r.encode("/O "),...this.O.toArray(t)),this.U&&s.push(...r.encode("/U "),...this.U.toArray(t)),this.OE&&s.push(...r.encode("/OE "),...this.OE.toArray(t)),this.UE&&s.push(...r.encode("/UE "),...this.UE.toArray(t)),this.P&&s.push(...r.encode("/P "),...r.encode(" "+this.P)),this.Perms&&s.push(...r.encode("/Perms "),...this.Perms.toArray(t)),this.U&&s.push(...r.encode("/U "),...this.U.toArray(t)),this.EncryptMetadata&&s.push(...r.encode("/EncryptMetadata "),...r.encode(" "+this.EncryptMetadata)),this.Recipients&&(this.Recipients instanceof lr?s.push(...r.encode("/Recipients "),...this.Recipients.toArray(t)):(s.push(K),this.Recipients.forEach((e=>s.push(...e.toArray(t)))),s.push(Y)));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}toCryptOptions(){var t,e,r,s,n,i,a,o,h;return this.V?{filter:this.Filter,version:this.V,revision:this.R,permissions:this.P,keyLength:this.Length,encryptMetadata:this.EncryptMetadata,stringKeyLength:null===(t=this.stringFilter)||void 0===t?void 0:t.Length,streamKeyLength:null===(e=this.streamFilter)||void 0===e?void 0:e.Length,stringMethod:null===(r=this.stringFilter)||void 0===r?void 0:r.CFM,streamMethod:null===(s=this.streamFilter)||void 0===s?void 0:s.CFM,oPasswordHash:null===(n=this.O)||void 0===n?void 0:n.bytes,uPasswordHash:null===(i=this.U)||void 0===i?void 0:i.bytes,oEncPasswordHash:null===(a=this.OE)||void 0===a?void 0:a.bytes,uEncPasswordHash:null===(o=this.UE)||void 0===o?void 0:o.bytes,perms:null===(h=this.Perms)||void 0===h?void 0:h.bytes}:null}parseProps(t){var e,r;super.parseProps(t);const{parser:s,bounds:n}=t,i=n.contentStart||n.start,a=n.contentEnd||n.end;let o,h,c=s.skipToNextName(i,a-1);for(;h=s.parseNameAt(c),h;)switch(c=h.end+1,o=h.value,o){case"/Filter":case"/SubFilter":case"/StmF":case"/StrF":case"/EFF":c=this.parseNameProp(o,s,c);break;case"/V":const e=s.parseNumberAt(c,!1);if(!e||!Object.values(Ht).includes(e.value))throw new Error("Can't parse /V property value");this.V=e.value,c=e.end+1;break;case"/R":const r=s.parseNumberAt(c,!1);if(!r||!Object.values(Wt).includes(r.value))throw new Error("Can't parse /R property value");this.R=r.value,c=r.end+1;break;case"/Length":case"/P":c=this.parseNumberProp(o,s,c,!1);break;case"/O":case"/U":case"/OE":case"/UE":case"/Perms":c=this.parseLiteralProp(o,s,c,t.cryptInfo);break;case"/EncryptMetadata":c=this.parseBoolProp(o,s,c);break;case"/CF":const i=s.getDictBoundsAt(c);if(!n)throw new Error("Can't parse /CF property value");{const t=qr.parse({parser:s,bounds:i});t&&(this.CF=t.value,c=t.end+1)}break;case"/Recipients":const h=s.getValueTypeAt(c);if(h===pe){const e=lr.parse(s,c,t.cryptInfo);if(e){this.Recipients=e.value,c=e.end+1;break}throw new Error("Can't parse /Recipients property value")}if(h===fe){const t=lr.parseArray(s,c);if(t){this.Recipients=t.value,c=t.end+1;break}throw new Error("Can't parse /Recipients property value")}throw new Error(`Unsupported /Filter property value type: ${h}`);default:c=s.skipToNextName(c,a-1)}if(!this.Filter)throw new Error("Not all required properties parsed");if("/Standard"===this.Filter&&(!this.R||!this.O||!this.U||isNaN(this.P)||5===this.V&&(this.R<5||!this.OE||!this.UE||!this.Perms)))throw new Error("Not all required properties parsed");if(("adbe.pkcs7.s3"===this.SubFilter||"adbe.pkcs7.s4"===this.SubFilter)&&!this.Recipients)throw new Error("Not all required properties parsed");"/Identity"!==this.StrF&&(this.stringFilter=null===(e=this.CF)||void 0===e?void 0:e.getProp(this.StrF)),"/Identity"!==this.StmF&&(this.streamFilter=null===(r=this.CF)||void 0===r?void 0:r.getProp(this.StmF))}}class Jr extends cr{constructor(){super(Xt)}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Jr;return e.parseProps(t),{value:e,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}getObjectData(t){if(!this._streamData||!this.N||!this.First)return null;const e=new Ke(this.decodedStreamData),r=new Map;let s,n,i,a=0;for(let t=0;t<this.N;t++)s=e.parseNumberAt(a,!1,!1),n=s.value,a=s.end+2,s=e.parseNumberAt(a,!1,!1),i=s.value,a=s.end+2,r.set(n,i);if(!r.has(t))return null;const o=this.First+r.get(t),h=e.getValueTypeAt(o);if(null===h)return;let c,d;switch(h){case Et:c=e.getDictBoundsAt(o,!1);break;case _t:c=e.getArrayBoundsAt(o,!1);break;case xt:const t=rr.parse(e,o);t&&(c={start:t.start,end:t.end},d=t);break;case bt:const r=lr.parse(e,o);r&&(c={start:r.start,end:r.end},d=r);break;case vt:const s=e.parseNumberAt(o);s&&(c={start:s.start,end:s.end},d=s)}if(!c)return null;const l=e.sliceCharCodes(c.start,c.end);if(!l.length)throw new Error("Object byte array is empty");return{parser:new Ke(l),bounds:{start:0,end:l.length-1,contentStart:c.contentStart?c.contentStart-c.start:void 0,contentEnd:c.contentEnd?l.length-1-(c.end-c.contentEnd):void 0},type:h,value:d,cryptInfo:{ref:{id:t,generation:0}},streamId:this.id}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.N&&s.push(...r.encode("/N "),...r.encode(" "+this.N)),this.First&&s.push(...r.encode("/First "),...r.encode(" "+this.First)),this.Extends&&s.push(...r.encode("/Extends "),_,...this.Extends.toArray(t));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=e.getDictBoundsAt(s);let i,a,o=e.skipToNextName(n.contentStart,n.contentEnd);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/N":case"/First":o=this.parseNumberProp(i,e,o,!1);break;case"/Extends":o=this.parseRefProp(i,e,o);break;default:o=e.skipToNextName(o,n.contentEnd)}}}const Yr="/Draft";class Zr extends Ur{constructor(){super(me),this.Name=Yr}static parse(t){if(!t)throw new Error("Parsing information not passed");try{const e=new Zr;e.parseProps(t);const r=new Proxy(e,e.onChange);return e._proxy=r,{value:r,start:t.bounds.start,end:t.bounds.end}}catch(t){return console.log(t.message),null}}toArray(t){const e=super.toArray(t),r=new TextEncoder,s=[];this.Name&&s.push(...r.encode("/Name "),...r.encode(this.Name));const n=[...e.subarray(0,2),...s,...e.subarray(2,e.length)];return new Uint8Array(n)}parseProps(t){super.parseProps(t);const{parser:e,bounds:r}=t,s=r.contentStart||r.start,n=r.contentEnd||r.end;e.sliceChars(s,n);let i,a,o=e.skipToNextName(s,n-1);for(;a=e.parseNameAt(o),a;)switch(o=a.end+1,i=a.value,i){case"/Name":o=this.parseNameProp(i,e,o);break;default:o=e.skipToNextName(o,n-1)}if(!this.Name)throw new Error("Not all required properties parsed")}}class $r{constructor(t){this._pageById=new Map,this._annotIdsByPageId=new Map,this.getObjectParseInfo=t=>{var e,r,s;if(!t)return null;const n=null===(e=this._referenceData)||void 0===e?void 0:e.getOffset(t);if(isNaN(n))return null;const i=tr.parse(this._docParser,n);if(!i)return null;const a=this._docParser.getIndirectObjectBoundsAt(i.end+1,!0);if(!a)return null;const o=this.getObjectParseInfo,h={parser:this._docParser,bounds:a,parseInfoGetter:o,cryptInfo:{ref:{id:i.value.id,generation:i.value.generation},stringCryptor:null===(r=this._authResult)||void 0===r?void 0:r.stringCryptor,streamCryptor:null===(s=this._authResult)||void 0===s?void 0:s.streamCryptor}};if(i.value.id===t)return h;const c=Jr.parse(h);if(!c)return;const d=c.value.getObjectData(t);return d?(d.parseInfoGetter=o,d):null},this._data=t,this._docParser=new Ke(t),this._version=this._docParser.getPdfVersion();const e=this._docParser.getLastXrefIndex();if(!e)throw new Error("File doesn't contain update section");const r=$r.parseAllXrefs(this._docParser,e.value);if(!r.length)throw new Error("Failed to parse cross-reference sections");this._xrefs=r,this._referenceData=new Ye(r),this.parseEncryption()}get size(){var t;return(null===(t=this._xrefs)||void 0===t?void 0:t.length)?this._xrefs[0].size:0}get encrypted(){return!!this._encryption}get authenticated(){return!this._encryption||!!this._authResult}static parseXref(t,e,r){if(!t||!e)return null;const s=e,n=t.findSubarrayIndex(gt.XREF_TABLE,{minIndex:e,closedOnly:!0});if(n&&n.start===e){const n=t.findSubarrayIndex(gt.XREF_HYBRID,{minIndex:e,maxIndex:r,closedOnly:!0});if(!n){const r=Wr.parse(t,e,s);return null==r?void 0:r.value}{const r=t.parseNumberAt(n.end+1);if(!r)return null;e=r.value}}const i=tr.parse(t,e,!1);if(!i)return null;const a=t.getIndirectObjectBoundsAt(i.end+1);if(!a)return null;const o=zr.parse({parser:t,bounds:a},s);return null==o?void 0:o.value}static parseAllXrefs(t,e){const r=[];let s,n=t.maxIndex;for(;e&&(s=$r.parseXref(t,e,n),s);)r.push(s),n=e,e=s.prev;return r}tryAuthenticate(t=""){return!!this.authenticated||this.authenticate(t)}getPlainData(){return this._data.slice()}getDataWithoutSupportedAnnotations(){const t=this.getSupportedAnnotationMap(),e=[];(null==t?void 0:t.size)&&t.forEach(((t,r)=>{t.slice().forEach((t=>{t.deleted||(t.markAsDeleted(!0),e.push(t))}))}));const r=this.getDataWithUpdatedAnnotations();return e.forEach((t=>t.markAsDeleted(!1))),r}getDataWithUpdatedAnnotations(){const t=this.getSupportedAnnotationMap(),e=[];t.forEach(((t,r)=>{const s=this._pageById.get(r);if(!s)throw new Error(`Page with id '${r}' not found`);const n=this._annotIdsByPageId.get(r).slice()||[];e.push({page:s,allAnnotationIds:n,supportedAnnotations:t||[]})}));return new Or(this._data,this._xrefs[0],this._referenceData,this._authResult).getDataWithUpdatedAnnotations(e)}getPageAnnotations(t){return this.getSupportedAnnotationMap().get(t)||[]}addAnnotation(t,e){const r=this.getSupportedAnnotationMap().get(t);r?r.push(e):this.getSupportedAnnotationMap().set(t,[e])}removeAnnotation(t){t.markAsDeleted(!0)}authenticate(t){if(this.authenticated)return!0;const e=this._encryption.toCryptOptions(),r=this._xrefs[0].id[0].hex,s=new qe(e,r);return this._authResult=s.authenticate(t),this.authenticated}checkAuthentication(){if(!this.authenticated)throw new Error("Unauthorized access to file data")}parseEncryption(){const t=this._xrefs[0].encrypt;if(!t)return;const e=this.getObjectParseInfo(t.id),r=Kr.parse(e);if(!r)throw new Error("Encryption dict can't be parsed");this._encryption=r.value}parsePages(t,e){if(e.Kids.length)for(const r of e.Kids){const e=this.getObjectParseInfo(r.id);if(!e)continue;const s=e.parser.parseDictType(e.bounds);if(s===Jt){const r=jr.parse(e);r&&this.parsePages(t,r.value)}else if(s===Yt){const r=Qr.parse(e);r&&t.push(r.value)}}}parsePageTree(){const t=this._xrefs[0].root,e=this.getObjectParseInfo(t.id),r=Gr.parse(e);if(!r)throw new Error("Document root catalog not found");this._catalog=r.value;const s=r.value.Pages,n=this.getObjectParseInfo(s.id),i=jr.parse(n);if(!i)throw new Error("Document root page tree not found");const a=[];this.parsePages(a,i.value),this._pages=a,this._pageById.clear(),a.forEach((t=>this._pageById.set(t.ref.id,t)))}getSupportedAnnotations(){var t;this.checkAuthentication(),this._catalog||this.parsePageTree();const e=new Map,r=new Map;for(const s of this._pages){const n=[];if(Array.isArray(s.Annots))n.push(...s.Annots);else if(s.Annots instanceof tr){const e=this.getObjectParseInfo(s.Annots.id);if(e){const r=tr.parseRefArray(e.parser,e.bounds.contentStart);(null===(t=null==r?void 0:r.value)||void 0===t?void 0:t.length)&&n.push(...r.value)}}e.set(s.ref.id,n);const i=[];for(const t of n){const e=this.getObjectParseInfo(t.id);e.rect=s.MediaBox;let r;switch(e.parser.parseDictSubtype(e.bounds)){case me:r=Zr.parse(e)}r&&(i.push(r.value),console.log(r.value))}r.set(s.id,i)}return this._annotIdsByPageId=e,this._supportedAnnotsByPageId=r,this._supportedAnnotsByPageId}getSupportedAnnotationMap(){return this.checkAuthentication(),this._supportedAnnotsByPageId||(this._supportedAnnotsByPageId=this.getSupportedAnnotations()),this._supportedAnnotsByPageId}}var ts=function(t,e,r,s){return new(r||(r=Promise))((function(n,i){function a(t){try{h(s.next(t))}catch(t){i(t)}}function o(t){try{h(s.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))};class es{constructor(t){if(this.onMouseDown=t=>{var e;this._divModeTimer&&(clearTimeout(this._divModeTimer),this._divModeTimer=null),null===(e=this._renderTask)||void 0===e||e.expandTextDivs(!0)},this.onMouseUp=t=>{this._divModeTimer=setTimeout((()=>{var t;null===(t=this._renderTask)||void 0===t||t.expandTextDivs(!1),this._divModeTimer=null}),300)},!t)throw new Error("Page proxy is not defined");this._pageProxy=t,this._container=document.createElement("div"),this._container.classList.add("page-text"),this._container.addEventListener("mousedown",this.onMouseDown),this._container.addEventListener("mouseup",this.onMouseUp)}static appendPageTextAsync(t,e,r){return ts(this,void 0,void 0,(function*(){const s=new es(t);return yield s.renderTextLayerAsync(r),e.append(s._container),s}))}destroy(){this.destroyRenderTask(),this._container&&(this._container.remove(),this._container=null)}renderTextLayerAsync(e){return ts(this,void 0,void 0,(function*(){this.clear(),this.destroyRenderTask();const r=this._pageProxy.getViewport({scale:e}),s=this._pageProxy.streamTextContent();this._renderTask=t({container:this._container,textContentStream:s,viewport:r,enhanceTextSelection:!0});try{yield this._renderTask.promise}catch(t){if("TextLayer task cancelled."===t.message)return!1;throw t}return!0}))}clear(){this._container.innerHTML=""}destroyRenderTask(){this._renderTask&&(this._renderTask.cancel(),this._renderTask=null)}}var rs=function(t,e,r,s){return new(r||(r=Promise))((function(n,i){function a(t){try{h(s.next(t))}catch(t){i(t)}}function o(t){try{h(s.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))};class ss{constructor(t,e,r){if(this._svgByAnnotation=new Map,!t||isNaN(e)||!r)throw new Error("Required argument not found");this._pageId=e,this._pageDimensions=r,this._container=document.createElement("div"),this._container.classList.add("page-annotations"),this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.classList.add("stretch"),this._svg.setAttribute("data-page-id",e+""),this._svg.setAttribute("viewBox",`0 0 ${r.x} ${r.y}`),this._svg.setAttribute("transform","scale(1, -1)"),this._svg.addEventListener("pointerdown",(t=>{t.target===this._svg&&this.switchSelectedAnnotation(null)})),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._container.append(this._svg),this._annotations=t.getPageAnnotations(e)}destroy(){this.remove(),this._container=null}remove(){var t;null===(t=this._container)||void 0===t||t.remove()}appendAsync(t){return rs(this,void 0,void 0,(function*(){this._rendered||(yield this.renderAnnotationsAsync(),this._rendered=!0),t.append(this._container)}))}switchSelectedAnnotation(t){if(t===this._selectedAnnotation)return;if(this._selectedAnnotation){const t=this._svgByAnnotation.get(this._selectedAnnotation);null==t||t.classList.remove("selected")}const e=this._svgByAnnotation.get(t);e&&(e.classList.add("selected"),this._svg.append(e),this._selectedAnnotation=t)}renderAnnotation(t){const e=t.render();if(!e)return;const{svg:r,clipPaths:s}=e;this._svgByAnnotation.set(t,r),r.addEventListener("pointerdown",(()=>this.switchSelectedAnnotation(t))),this._svg.append(r),null==s||s.forEach((t=>this._defs.append(t)))}renderAnnotationsAsync(){var t;return rs(this,void 0,void 0,(function*(){this.clear();const e=[];for(let r=0;r<(null===(t=this._annotations)||void 0===t?void 0:t.length);r++)e.push(new Promise((t=>{setTimeout((()=>{this.renderAnnotation(this._annotations[r]),t()}),0)})));return yield Promise.all(e),this._svg.append(this._defs),!0}))}clear(){this._svg.innerHTML="",this._svgByAnnotation.clear()}}var ns=function(t,e,r,s){return new(r||(r=Promise))((function(n,i){function a(t){try{h(s.next(t))}catch(t){i(t)}}function o(t){try{h(s.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))};class is{constructor(t,e,r,s){if(!t)throw new Error("Page proxy is not defined");if(!e)throw new Error("Annotation data is not defined");this._pageProxy=t,this._viewport=t.getViewport({scale:1}),this._maxScale=Math.max(r,1),this._annotationData=e,this.number=t.pageNumber,this.id=t.ref.num,this.generation=t.ref.gen;const{width:n,height:i}=this._viewport,a=(s=Math.max(null!=s?s:0,50))*(i/n);this._dimensions={width:n,height:i,previewWidth:s,previewHeight:a},this._previewContainer=document.createElement("div"),this._previewContainer.classList.add("page-preview"),this._previewContainer.setAttribute("data-page-number",this.number+""),this._previewContainer.setAttribute("data-page-id",this.id+""),this._previewContainer.setAttribute("data-page-gen",this.generation+""),this._previewContainer.style.width=this._dimensions.previewWidth+"px",this._previewContainer.style.height=this._dimensions.previewHeight+"px",this._viewContainer=document.createElement("div"),this._viewContainer.classList.add("page"),this._viewContainer.setAttribute("data-page-number",this.number+""),this._viewContainer.setAttribute("data-page-id",this.id+""),this._viewContainer.setAttribute("data-page-gen",this.generation+""),this.scale=1}get previewContainer(){return this._previewContainer}get viewContainer(){return this._viewContainer}set _viewRendered(t){this.$viewRendered=t,this._viewContainer.setAttribute("data-loaded",t+"")}get _viewRendered(){return this.$viewRendered}set scale(t){if(t<=0||this._scale===t)return;this._scale=t;const e=window.devicePixelRatio;this._dimensions.scaledWidth=this._dimensions.width*this._scale,this._dimensions.scaledHeight=this._dimensions.height*this._scale,this._dimensions.scaledDprWidth=this._dimensions.scaledWidth*e,this._dimensions.scaledDprHeight=this._dimensions.scaledHeight*e,this._viewContainer.style.width=this._dimensions.scaledWidth+"px",this._viewContainer.style.height=this._dimensions.scaledHeight+"px",this._viewCanvas&&(this._viewCanvas.style.width=this._dimensions.scaledWidth+"px",this._viewCanvas.style.height=this._dimensions.scaledHeight+"px"),this._scaleIsValid=!1}get viewValid(){return this._scaleIsValid&&this._viewRendered}destroy(){this._previewContainer.remove(),this._viewContainer.remove(),this._pageProxy.cleanup()}renderPreviewAsync(t=!1){return ns(this,void 0,void 0,(function*(){if(this._renderPromise&&(t&&this.cancelRenderTask(),yield this._renderPromise),t||!this._previewRendered)return this._renderPromise=this.runPreviewRenderAsync(),this._renderPromise}))}renderViewAsync(t=!1){return ns(this,void 0,void 0,(function*(){if(this._renderPromise&&(t&&this.cancelRenderTask(),yield this._renderPromise),t||!this.viewValid)return this._renderPromise=this.runViewRenderAsync(),this._renderPromise}))}clearPreview(){this._previewContainer.innerHTML=""}clearView(){var t,e,r;null===(t=this._annotations)||void 0===t||t.destroy(),this._annotations=null,null===(e=this._text)||void 0===e||e.destroy(),this._text=null,null===(r=this._viewCanvas)||void 0===r||r.remove(),this._viewRendered=!1}cancelRenderTask(){this._renderTask&&(this._renderTask.cancel(),this._renderTask=null)}runRenderTaskAsync(t){return ns(this,void 0,void 0,(function*(){this.cancelRenderTask(),this._renderTask=this._pageProxy.render(t);try{yield this._renderTask.promise}catch(t){if(t instanceof e)return!1;throw t}finally{this._renderTask=null}return!0}))}createPreviewCanvas(){const t=document.createElement("canvas");t.classList.add("page-canvas");const e=window.devicePixelRatio,{previewWidth:r,previewHeight:s}=this._dimensions;return t.style.width=r+"px",t.style.height=s+"px",t.width=r*e,t.height=s*e,t}createViewCanvas(){const t=document.createElement("canvas");return t.classList.add("page-canvas"),t.style.width=this._dimensions.scaledWidth+"px",t.style.height=this._dimensions.scaledHeight+"px",t.width=this._dimensions.scaledDprWidth,t.height=this._dimensions.scaledDprHeight,t}scaleCanvasImage(t,e){let r,s=this._scale/this._maxScale,n=t;for(;s<.5;)r=document.createElement("canvas"),r.width=.5*n.width,r.height=.5*n.height,r.getContext("2d").drawImage(n,0,0,r.width,r.height),n=r,s*=2;e.getContext("2d").drawImage(n,0,0,e.width,e.height)}runPreviewRenderAsync(){return ns(this,void 0,void 0,(function*(){const t=this.createPreviewCanvas(),e={canvasContext:t.getContext("2d"),viewport:this._viewport.clone({scale:t.width/this._dimensions.width})};(yield this.runRenderTaskAsync(e))?(this._previewContainer.innerHTML="",this._previewContainer.append(t),this._previewRendered=!0):this._previewRendered=!1}))}runViewRenderAsync(){var t,e;return ns(this,void 0,void 0,(function*(){const r=this._scale;null===(t=this._text)||void 0===t||t.destroy(),this._text=null;const s=this.createViewCanvas(),n={canvasContext:s.getContext("2d"),viewport:this._viewport.clone({scale:r*window.devicePixelRatio}),enableWebGL:!0};if((yield this.runRenderTaskAsync(n))&&r===this._scale){if(null===(e=this._viewCanvas)||void 0===e||e.remove(),this._viewContainer.append(s),this._viewCanvas=s,this._viewRendered=!0,this._text=yield es.appendPageTextAsync(this._pageProxy,this._viewContainer,r),!this._annotations){const{width:t,height:e}=this._dimensions;this._annotations=new ss(this._annotationData,this.id,new p(t,e))}yield this._annotations.appendAsync(this.viewContainer),r===this._scale&&(this._scaleIsValid=!0)}}))}}var as=function(t,e,r,s){return new(r||(r=Promise))((function(n,i){function a(t){try{h(s.next(t))}catch(t){i(t)}}function o(t){try{h(s.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))};class os{constructor(t,e){this._visibleAdjPages=0,this._previewWidth=100,this._minScale=.25,this._maxScale=4,this._scale=1,this._previewerHidden=!0,this._pages=[],this._currentPage=0,this._pointerInfo={lastPos:null,downPos:null,downScroll:null},this._timers={hidePanels:0},this._pinchInfo={active:!1,lastDist:0,minDist:10,sensitivity:.025,target:null},this.onPdfLoadingProgress=t=>{},this.onPdfLoadedAsync=(t,e)=>as(this,void 0,void 0,(function*(){this._pdfDocument=t,this._docData=e,yield this.refreshPagesAsync(),this.renderVisiblePreviews(),this.renderVisiblePages(),this._shadowRoot.querySelector("#panel-bottom").classList.remove("disabled")})),this.onPdfClosedAsync=()=>as(this,void 0,void 0,(function*(){this._shadowRoot.querySelector("#panel-bottom").classList.add("disabled"),this._pdfDocument&&(this._pdfDocument=null,this._docData=null),yield this.refreshPagesAsync()})),this.onMainContainerResize=(t,e)=>{const{width:r}=this._mainContainer.getBoundingClientRect();r<721?this._mainContainer.classList.add("mobile"):this._mainContainer.classList.remove("mobile")},this.onDownloadFileButtonClick=()=>{var t;const e=null===(t=this._docData)||void 0===t?void 0:t.getDataWithUpdatedAnnotations();(null==e?void 0:e.length)&&os.downloadFile(e,`file_${(new Date).toISOString()}.pdf`)},this.onTextModeButtonClick=()=>{this.toggleMode("text")},this.onHandModeButtonClick=()=>{this.toggleMode("hand")},this.onAnnotationModeButtonClick=()=>{this.toggleMode("annotation")},this.onPreviewerToggleClick=()=>{this._previewerHidden?(this._mainContainer.classList.remove("hide-previewer"),this._shadowRoot.querySelector("div#toggle-previewer").classList.add("on"),this._previewerHidden=!1,setTimeout((()=>this.renderVisiblePreviews()),1e3)):(this._mainContainer.classList.add("hide-previewer"),this._shadowRoot.querySelector("div#toggle-previewer").classList.remove("on"),this._previewerHidden=!0)},this.onPreviewerPageClick=t=>{let e,r=t.target;for(;r&&!e;){const t=r.dataset.pageNumber;t?e=+t:r=r.parentElement}e&&this.scrollToPage(e-1)},this.onPreviewerScroll=t=>{this.renderVisiblePreviews()},this.onPaginatorInput=t=>{t.target instanceof HTMLInputElement&&(t.target.value=t.target.value.replace(/[^\d]+/g,""))},this.onPaginatorChange=t=>{if(t.target instanceof HTMLInputElement){const e=Math.max(Math.min(+t.target.value,this._pdfDocument.numPages),1);e+""!==t.target.value&&(t.target.value=e+""),this.scrollToPage(e-1)}},this.onPaginatorPrevClick=()=>{const t=l(this._currentPage-1,0,this._pages.length-1);this.scrollToPage(t)},this.onPaginatorNextClick=()=>{const t=l(this._currentPage+1,0,this._pages.length-1);this.scrollToPage(t)},this.onZoomOutClick=()=>{this.zoomOut()},this.onZoomInClick=()=>{this.zoomIn()},this.onZoomFitViewerClick=()=>{const t=l((this._viewer.getBoundingClientRect().width-20)/this._pages[this._currentPage].viewContainer.getBoundingClientRect().width*this._scale,this._minScale,this._maxScale);this.setScale(t),this.scrollToPage(this._currentPage)},this.onZoomFitPageClick=()=>{const{width:t,height:e}=this._viewer.getBoundingClientRect(),{width:r,height:s}=this._pages[this._currentPage].viewContainer.getBoundingClientRect(),n=l((t-20)/r*this._scale,this._minScale,this._maxScale),i=l((e-20)/s*this._scale,this._minScale,this._maxScale);this.setScale(Math.min(n,i)),this.scrollToPage(this._currentPage)},this.onViewerScroll=t=>{this.renderVisiblePages()},this.onViewerPointerMove=t=>{const{clientX:e,clientY:r}=t,{x:s,y:n,width:i,height:a}=this._viewer.getBoundingClientRect(),o=e-s,h=r-n,c=i-o,d=a-h;Math.min(o,c,h,d)>100?this._panelsHidden||this._timers.hidePanels||(this._timers.hidePanels=setTimeout((()=>{this._mainContainer.classList.add("hide-panels"),this._panelsHidden=!0,this._timers.hidePanels=null}),5e3)):(this._timers.hidePanels&&(clearTimeout(this._timers.hidePanels),this._timers.hidePanels=null),this._panelsHidden&&(this._mainContainer.classList.remove("hide-panels"),this._panelsHidden=!1)),this._pointerInfo.lastPos=new p(e,r)},this.onViewerPointerDown=t=>{if("hand"!==this._mode)return;const{clientX:e,clientY:r}=t;this._pointerInfo.downPos=new p(e,r),this._pointerInfo.downScroll=new p(this._viewer.scrollLeft,this._viewer.scrollTop);const s=t=>{const{x:e,y:r}=this._pointerInfo.downPos,{x:s,y:n}=this._pointerInfo.downScroll,i=t.clientX-e,a=t.clientY-r;this._viewer.scrollTo(s-i,n-a)},n=t=>{this._pointerInfo.downPos=null,this._pointerInfo.downScroll=null,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",n),window.removeEventListener("pointerout",n)};window.addEventListener("pointermove",s),window.addEventListener("pointerup",n),window.addEventListener("pointerout",n)},this.onViewerTouchStart=t=>{if(2!==t.touches.length)return;const e=t.touches[0],r=t.touches[1];this._pinchInfo.active=!0,this._pinchInfo.lastDist=h(e.clientX,e.clientY,r.clientX,r.clientY);const s=t=>{if(2!==t.touches.length)return;const e=t.touches[0],r=t.touches[1],s=h(e.clientX,e.clientY,r.clientX,r.clientY),n=s-this._pinchInfo.lastDist,i=Math.floor(n/this._pinchInfo.minDist);if(i){const t=new p((r.clientX+e.clientX)/2,(r.clientY+e.clientY)/2);this._pinchInfo.lastDist=s,this.zoom(i*this._pinchInfo.sensitivity,t)}},n=e=>{this._pinchInfo.active=!1,this._pinchInfo.lastDist=0,t.target.removeEventListener("touchmove",s),t.target.removeEventListener("touchend",n),t.target.removeEventListener("touchcancel",n)};t.target.addEventListener("touchmove",s),t.target.addEventListener("touchend",n),t.target.addEventListener("touchcancel",n)},this.onViewerWheel=t=>{t.ctrlKey&&(t.preventDefault(),t.deltaY>0?this.zoomOut(this._pointerInfo.lastPos):this.zoomIn(this._pointerInfo.lastPos))};const s=document.querySelector(t);if(!s)throw new Error("Container not found");if(!(s instanceof HTMLDivElement))throw new Error("Container is not a DIV element");if(this._outerContainer=s,!e)throw new Error("Worker source path not defined");r.workerSrc=e,this.initViewerGUI()}static downloadFile(t,e,r="application/pdf"){const s=new Blob([t],{type:r}),n=URL.createObjectURL(s),i=document.createElement("a");i.setAttribute("download",e),i.href=n,document.body.appendChild(i),i.click(),i.remove(),setTimeout((()=>URL.revokeObjectURL(n)),1e4)}destroy(){var t,e;null===(t=this._pdfLoadingTask)||void 0===t||t.destroy(),this._pages.forEach((t=>t.destroy())),this._pdfDocument&&(this._pdfDocument.cleanup(),this._pdfDocument.destroy()),null===(e=this._mainContainerResizeObserver)||void 0===e||e.disconnect(),this._shadowRoot.innerHTML=""}openPdfAsync(t){return as(this,void 0,void 0,(function*(){let e,r;try{if(t instanceof Uint8Array)e=t;else{let r;if("string"==typeof t){const e=yield fetch(t);r=yield e.blob()}else r=t;const s=yield r.arrayBuffer();e=new Uint8Array(s)}}catch(t){throw new Error(`Cannot load file data: ${t.message}`)}const n=new $r(e);let i;for(;;){if(n.tryAuthenticate(i))break;if(i=yield this.showPasswordDialogAsync(),null===i)throw new Error("File loading cancelled: authentication aborted")}e=n.getDataWithoutSupportedAnnotations();try{if(this._pdfLoadingTask)return yield this.closePdfAsync(),this.openPdfAsync(e);this._pdfLoadingTask=s({data:e,password:i}),this._pdfLoadingTask.onProgress=this.onPdfLoadingProgress,r=yield this._pdfLoadingTask.promise,this._pdfLoadingTask=null}catch(t){throw new Error(`Cannot open PDF: ${t.message}`)}yield this.onPdfLoadedAsync(r,n)}))}closePdfAsync(){return as(this,void 0,void 0,(function*(){this._pdfLoadingTask&&(this._pdfLoadingTask.destroyed||(yield this._pdfLoadingTask.destroy()),this._pdfLoadingTask=null),yield this.onPdfClosedAsync()}))}initViewerGUI(){this._shadowRoot=this._outerContainer.attachShadow({mode:"open"}),this._shadowRoot.innerHTML='\n  <style>\n    :host {\n      --color-primary-final: var(--color-primary, rgba(40,40,40,1));\n      --color-primary-tr-final: var(--color-primary-tr, rgba(40,40,40,0.9));\n      --color-secondary-final: var(--color-secondary, rgba(60,60,60,1));\n      --color-secondary-tr-final: var(--color-secondary-tr, rgba(60,60,60,0.9));\n      --color-accent-final: var(--color-accent, rgba(96,96,96,1));\n      --color-shadow-final: var(--color-shadow, rgba(0,0,0,0.75));\n      --color-bg-final: var(--color-bg, rgba(128,128,128,1));\n      --color-fg-primary-final: var(--color-fg-primary, rgba(255,255,255,1));\n      --color-fg-secondary-final: var(--color-fg-secondary, rgba(187,187,187,1));\n      --color-fg-accent-final: var(--color-fg-accent, rgba(255,255,255,1));\n      --color-text-selection-final: var(--color-text-selection, rgba(104,104,128,0.3));\n    }\n\n    .disabled {\n      pointer-events: none;\n    }\n\n    .relative {\n      position: relative;\n    }\n    .absolute {\n      position: absolute;\n    }\n    .abs-stretch {\n      position: absolute;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n    }\n    .abs-topleft {\n      position: absolute;\n      left: 0;\n      top: 0;\n    }\n    .stretch {\n      width: 100%;\n      height: 100%;\n    }\n    \n    .margin-s-5 {\n      margin: 0 5px;\n    }\n\n    #main-container {\n      box-sizing: border-box;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      justify-content: stretch;\n      align-items: stretch;\n      width: 100%;\n      height: 100%;\n      background: var(--color-bg-final);\n    }\n  \n    #panel-top {\n      position: relative;\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n      align-items: center;\n      flex-shrink: 0;\n      width: 100%;\n      height: 50px;\n      background: var(--color-primary-final);\n      box-shadow: 0 0 10px var(--color-shadow-final);\n      z-index: 1;\n      transition: height 0.25s ease-out 0.1s;\n    }\n    .hide-panels #panel-top {\n      height: 0;\n      transition: height 0.25s ease-in 0.2s;\n    }\n  \n    #panel-bottom {\n      position: absolute;\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      align-items: center;\n      flex-grow: 0;\n      flex-shrink: 0;\n      left: calc(50% - 160px);\n      bottom: 20px;\n      width: 320px;\n      height: 50px;  \n      background: var(--color-primary-tr-final);\n      box-shadow: 0 0 10px var(--color-shadow-final);\n      z-index: 1;\n      transition: height 0.25s ease-out, bottom 0.1s linear 0.25s;\n    }\n    .hide-panels #panel-bottom {\n      bottom: 0;\n      height: 0;\n      transition: bottom 0.1s linear 0.1s, height 0.25s ease-in 0.2s;\n    }\n\n    .panel-v-separator {\n      width: 1px;\n      height: 30px;\n      background-color: var(--color-fg-secondary-final);\n    }\n  \n    .panel-button {\n      cursor: pointer;\n      user-select: none;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      width: 36px;\n      height: 36px;\n      border-radius: 50%;\n    }\n    .panel-button:hover,\n    .panel-button.on {\n      background-color: var(--color-accent-final);\n    }\n    .panel-button img {\n      width: 20px;\n      height: 20px;\n      filter: invert() opacity(0.5) drop-shadow(0 0 0 var(--color-fg-primary-final)) saturate(1000%);\n    }  \n    .panel-button:hover img,\n    .panel-button.on img {\n      filter: invert() opacity(0.5) drop-shadow(0 0 0 var(--color-fg-accent-final)) saturate(1000%);\n    }  \n  \n    .subpanel {\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      align-items: center;\n      margin: 0 4px;\n    }    \n    \n    .panel-item {\n      transform: scale(1);\n      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;\n    }\n    .hide-panels .panel-item {\n      cursor: default;      \n      opacity: 0;\n      transform: scale(0);\n      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;\n    }\n  \n    #paginator {  \n      user-select: none;\n      font-family: sans-serif;\n      font-size: 16px;\n      color: var(--color-fg-primary-final);\n    }\n    #paginator-input {\n      text-align: center; \n      font-size: 16px;\n      width: 30px;\n      height: 30px;\n      margin: 2px;\n      padding: 0;\n      outline: none;\n      border: none;\n      color: var(--color-fg-primary-final);\n      background-color: var(--color-primary-final);\n    }\n    #paginator-total {\n      margin: 4px;\n    }\n\n    #toggle-previewer {\n      margin: 4px;\n    }\n      \n    #previewer {\n      box-sizing: border-box;\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      overflow-y: auto;\n      left: 0;\n      top: 50px;\n      bottom: 0;\n      width: 160px; \n      padding-top: 0px;\n      background: var(--color-secondary-final);\n      box-shadow: 0 0 10px var(--color-shadow-final);\n      z-index: 1;\n      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, width 0.25s ease-out;\n    } \n    .hide-panels #previewer {\n      top: 0;\n      padding-top: 50px;\n      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s;\n    }   \n    .mobile #previewer {\n      background: var(--color-secondary-tr-final);\n    } \n    .hide-previewer #previewer {\n      width: 0;\n      transition: width 0.25s ease-in 0.1s;\n    }\n    #previewer .page-preview {      \n      transform: scaleX(1);\n      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;\n    }\n    .hide-previewer #previewer .page-preview {\n      opacity: 0;\n      transform: scaleX(0);\n      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;\n    }\n  \n    #viewer {\n      box-sizing: border-box;\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      overflow: auto;\n      left: 160px;\n      right: 0;\n      top: 50px;\n      bottom: 0;\n      padding-top: 0px;\n      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, left 0.25s ease-out;\n    }\n    #viewer.mode-hand {\n      cursor: grab !important;\n      user-select: none !important;\n    }\n    .hide-panels #viewer {\n      top: 0;\n      padding-top: 50px;\n      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s;\n    }      \n    .hide-panels.mobile #viewer,\n    .hide-panels.hide-previewer #viewer {\n      top: 0;\n      padding-top: 50px;\n      left: 0;\n      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s, left 0.25s ease-in;\n    }   \n    .mobile #viewer,\n    .hide-previewer #viewer {\n      top: 50px;\n      padding-top: 0px;\n      left: 0;\n      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, left 0.25s ease-in;\n    } \n  \n    .page {    \n      position: relative;\n      display: flex;\n      flex-grow: 0;\n      flex-shrink: 0;\n      margin: 10px auto;\n      background-color: white;\n      box-shadow: 0 0 10px var(--color-shadow-final);\n    }\n    .page-preview {   \n      cursor: pointer; \n      position: relative;\n      display: flex;\n      flex-grow: 0;\n      flex-shrink: 0;\n      margin: 0 auto;\n      background-color: white;\n      background-clip: content-box;\n      border-style: solid;\n      border-width: 10px 10px 20px 10px;\n      border-color: transparent;\n    }\n    .page-preview:hover,\n    .page-preview.current {\n      border-color: var(--color-accent-final);\n    }\n    .page-preview::after {\n      display: inline-block;\n      position: absolute;\n      top: calc(100% + 3px);\n      width: 100%;\n      text-align: center;\n      font-family: sans-serif;\n      font-size: 14px;\n      line-height: 1;\n      color: var(--color-fg-primary-final);\n      content: attr(data-page-number) " ";\n    }\n\n    .page-canvas {\n      background-color: white;\n    } \n    \n    .page-text {\n      position: absolute;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      margin: 0;\n      padding: 0;\n      overflow: hidden;\n      line-height: 1;\n    }\n    .page-text span {\n      cursor: text;\n      position: absolute;\n      white-space: pre;\n      color: transparent;\n      transform-origin: 0% 0%;\n    }\n    .page-text ::selection {\n      background: var(--color-text-selection-final);\n    }\n    .mode-hand .page-text span {\n      cursor: grab;\n    }\n    \n    .page-annotations {\n      position: absolute;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      margin: 0;\n      padding: 0;\n      overflow: hidden;\n    }\n    .mode-text .page-annotations,\n    .mode-hand .page-annotations {\n      pointer-events: none;\n    }\n    \n    #password-dialog {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      background: var(--color-secondary-tr-final);\n      z-index: 2;\n    }\n    #password-dialog .form {\n      position: absolute;\n      display: flex;\n      flex-direction: row;\n      justify-content: stretch;\n      align-items: stretch;\n      flex-grow: 0;\n      flex-shrink: 0;\n      left: calc(50% - 160px);\n      top: calc(50% - 25px);\n      width: 320px;\n      height: 50px;  \n      background: var(--color-primary-tr-final);\n      box-shadow: 0 0 10px var(--color-shadow-final);\n    }\n    #password-dialog input {\n      width: 220px;\n      margin: 10px 0 10px 10px;\n      padding: 5px;\n      font-size: 16px;\n      outline: none;\n      border: none;\n      color: var(--color-fg-primary-final);\n      background-color: var(--color-primary-final);\n    }\n    #password-dialog input::placeholder {\n      font-size: 14px;\n      font-style: italic;\n      color: var(--color-fg-primary-final);\n    }\n    #password-dialog .buttons {\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      align-items: center;\n      flex-grow: 1;\n      flex-shrink: 1;\n      width: 100px;\n    } \n\n    .svg-annotation {\n      cursor: pointer;\n    } \n    .svg-annot-rect,\n    .svg-annot-box {\n      fill: transparent;\n    }\n    .mode-annotation .svg-annotation.selected {\n      cursor: grab;\n    } \n    .mode-annotation .svg-annotation.selected .svg-annot-rect,\n    .mode-annotation .svg-annotation.selected .svg-annot-box {\n      stroke: var(--color-secondary-tr-final);\n      stroke-dasharray: 3 3;\n    } \n    .mode-annotation .svg-annotation.selected .svg-annot-handle-scale,\n    .mode-annotation .svg-annotation.selected .svg-annot-handle-rotation {\n      r: 5;\n      fill: var(--color-primary-final);\n      cursor: pointer;\n    }\n    .mode-annotation .svg-annotation.selected .svg-annot-rotation {\n      fill: none;\n      cursor: pointer;\n    }\n    .mode-annotation .svg-annotation.selected .svg-annot-rotation .circle {\n      r: 25;\n    }\n    .mode-annotation .svg-annotation.selected .svg-annot-rotation .dashed {\n      stroke: var(--color-secondary-tr-final);\n      stroke-dasharray: 3 3;\n    }\n  </style>\n\n  <div id="main-container" class="hide-previewer" \n    ondragstart="return false;" ondrop="return false;">\n    <div id="viewer"></div>\n    <div id="previewer"></div>\n    <div id="panel-top"> \n      <div class="subpanel panel-item">\n        <div id="toggle-previewer" class="panel-button panel-item">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcmlDQ1BpY2MAACiRdZE9S8NQFIbftkpFWwrqIOKQoYpCC0VBHKWCXapDW8GqS3KbtEKShpsUKa6Ci0PBQXTxa/Af6Cq4KgiCIoi4+Af8WqTEc5tCi7Qn3JyH9573cO+5gD+tM8PuSQCG6fBMKimt5tek4Dt8GEQYQ5iSmW0tZRdz6Bo/j1RN8RAXvbrXdYyBgmozwNdHPMss7hDPE6e3HEvwHvEwK8kF4hPiGKcDEt8KXfH4TXDR4y/BPJdZAPyip1RsY6WNWYkbxJPEUUOvsOZ5xE1CqrmSpTxKaww2MkghCQkKKtiEDgdxyibNrLMv0fAto0weRn8LVXByFFEib4zUCnVVKWukq/TpqIq5/5+nrc1Me91DSaD31XU/x4HgPlCvue7vqevWz4DAC3BttvxlmtPcN+m1lhY9BiI7wOVNS1MOgKtdYOTZkrnckAK0/JoGfFwA4TwwdA/0r3uzau7j/AnIbdMT3QGHR8AE1Uc2/gDt82gCvNGYhAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAcpJREFUeNrtWwFuwyAMjBEPWNf8/4XpugesoWMKUppBYidQ5cAnVZWaRtGdDxscoC6Bvu9d7PfRue6sMETJa8MwRC8Slzi6ACkhiEu8FgGWQpiucdBW9FNj5wiWzyvxjOk5/muVm30n8Xfjl8NfkNeEMLHo10Cem/CbyAHeCZMb/sGePfqTfXfh5/Hovu/3F25Lx9ujiURad6WIld1xHDtjTLLshXv8f7Zgka2dY04ClQNCxDmR5eL0Dvi63Vavf16vh1xjzzy13YKUPPQQWFaDHOShBJjX8VzkIRdDa+RDvvBlskoBOOSlVcLURr7KIVCKPIQAJclDJsGc5FkzwdBUqJE8pANykocTIDd59mKI2zIv0Q8oSR7GAaXIQwhQkjx0GVQBGI5xjEWRrTGqkmGjQ0AFUAFUABVABVAB2sXmRMi3pEbnSDLJyNm3h3MAEvnsAqCRZw0Bb/l5Q2THjg1qaghoFVABVAAVQAVQAVQAFUCCI9thxYSJXj5WcspCHaACNNgP+LhcTr+gySqAX/nNX2nP99ujI/aaX3NAbAPDkQ0RSNFfPTUWbkA/QLUVTNoT9RpOj+rJ0aUDJE5AdkDy8LRECEQBUrnsCeUexwK5uUFRAAAAAElFTkSuQmCC"/>\n        </div> \n      </div>\n      <div id="modes" class="subpanel panel-item">\n        <div id="button-mode-text" class="panel-button panel-item">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIU/N4piFBEtRCxSRLFQCApiKRFMoxYxgq8mu24SIRuX3Q0itoKNRcBCtPFV+A+0FWwVBEERRGz8A74akfVOVohIMsvs/Tgz5zJzBrTJvGG59TGwCp6TTMQjc/MLkcYXQmiE6aQ9bbj21MxEiprj8446VW8HVa/a+6qO8LLpGlDXJDxi2I4nPCY8uebZireFO41celn4UHjAkQMKXyldD/hZcTbgd8VOKjkOmuoZyf5h/Q8bOccS7heOWvmi8XsedZMWszA7I7VbZg8uSRLEiaBTZIU8HoNSC5JZdV+s7JtmVTyG/G3WccSRJSfeAVGL0tWUmhHdlC/Pusr9f55uZngo6N4Sh4Yn33/rhcYd+C75/teR738fQ+gRLgoV/6rkNPoheqmiRQ+gbRPOLiuavgvnW9D1YKeddFkKydQyGXg9hdZ56LiB5sUgq991Tu4htSFPdA17+9An+9uWfgCZXmfbLPy9EwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAtBJREFUeNrlWwtuwjAMra2cALj/CWFHWLYiQKGLEzu282GRqiFo3bznT23PhY1Yl8vl/vd6vW6VFTf5AitZp/P5JQsByPMoHEABr12oAE/d21IWG0+gTuywYrLx2OumR8sOSnmg3LwaONcFiqZT0j4jBngAhoZYVDX/HLbQCfgRWJT6MkVGycefn0tEQO5HS7YJWWwCanI5+y8REKxUu99UEEhzsQO0hFOKK5GFrdrfhT2PQU+RJiVVCdA8WkYA0O4DPTdrHUg5AKUk4AhNzURy0DIqDH4uJB/3sH+mAt+fVPg7Ri+Nx5bonpFtIscrFeZkfFGxeSs5pLLQGfww2Vy3xIXAu9wDO2xMY7bgTQJODF5EQi4Q59zg+B1ODt7FElIS4HQ+v/34dbv1Ah8NrqleW+t14OSad7cEXAi8Cwm4GHgVCRbl8Azgm0igiqagBf/rR+BZCVaKGaor/ZY2l/aEC2reNCaE9LGXtrgy1diM4KuW8Lt/YPcDMqayAniVO+CiZm/mDvhB4JtIwA8DLyYBt3++Qmsw6bUa8wq2FeOoRoTjErkw9io6ZgR/dwGLVHMl8Mf+BzIaCCtYQvOTC5m9tJlJUD22JdVg1h0etQKsCP7lAtyO6mSWYJKwoaQWn4gEs2wVGxOOkSSYpuqaVHgECeZ1ingqy3BTUXl+E/gU3z4aYFEM9bAEc/B38wdonxLrSIJreW5ZDnuQYAaecm3UChjQNDG7B/m/QcoNJiDBXDZ22CiMluM6K1wQDoqgaqb12mMdS/6hcINlFqZDz9z3hVYnIcUVtg9dZmNyveZ+e4En3xpLL+aAfp43G0Fdp8UVsSCOKKWzEyKcbtAKbpAL4hwMotfmDF6vE78252mJr1RYo+G9KfpojHIOiYuwjlalNI3LCwYopFle1ChAky2GI7iOSc4xz+/SVK0+BrlEPH6HwgyR1MebSOBOqVHf/wB4polu0KoYHQAAAABJRU5ErkJggg=="/>\n        </div> \n        <div id="button-mode-hand" class="panel-button panel-item">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZE9S8NQFIbfpkpFqx3qIMUhQxWHFoqCOEoFu1SHtoJVl+Q2aYQkDUmKFFfBxaHgILr4NfgPdBVcFQRBEURc/AN+LVLiuU2hRdoTbs7De897uPdcQMjqzHD6UoBhunYukxZXi2ti6B0BxDACAVGJOdZSfrGAnvHzSNUUD0neq3dd1xgqKQ4DAgPEs8yyXeJ54uyWa3HeIx5lmlQiPiFO2HRA4luuyz6/cS77/MXZLuQWAIH3FMsdLHcw02yDeIo4buhV1joPv0lYMVfylGO0xuEghwzSECGjik3ocJGkbNLMuvtSTd8yKuRh9LdQg02OMjTyJkitUleFskq6Qp+OGp/7/3k66sy03z2cBvpfPe9zAgjtA4265/2eel7jDAi+ANdm21+hOc19k15va/FjILIDXN60NfkAuNoFxp4tyZaaUpCWoKrAxwUwXASi98Dguj+r1j7On4DCNj3RHXB4BExSfWTjD603Z+Sp2ztrAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGklEQVR42uVbC47jIAytESeY6f1P2NkjLCOqInmoP5g4BChSpLZJAT8/G9sQuDHtfr+Tv/9P6WZp/35+tP6lDsEyXgBg7z0eD3qAVsE9AWgU/s8cOQG+vr+bAOCAiK2Cn9CS4TnwGrTIWYAItw9voGmfo56DJlI1DnD38jx75qGxOvcZRwuuCV++V888zaCmLyUkvlc+S0BE6uZBtBMDKHjYbvnMzVG6Rz0bvbSaByWo+0frR0GQWCSZicSE0Kv93Fm5mAl10V/4PSkrSGpRkgrAUXoatWbq8yVA8ujfFQBOg56UbxXQCoIXACytvUHwBjkepffL+Q0PYGqQseaxw5WWyScDcmyPr6uEYOzdnT3YcTcxwMsBtsTlXv1aVoJwpv0bNH16tDl8FThTmwygXeYSBtn61YAmLn6YlgFW0Bg/UgueatMYWQ+AWRiFQZjSBOql6kwneWlF6MyaA8E+6EqHtUleEQUeMD2ofcJH1QRPS4cno7tp/NjoMGbSIljpL4EfPo3ybwzAOzd5aRC0DSOTllEgBEPykBSAlmzBkjkhILyWJLb2Vy7qP54heW89oGu/rgiEKskiRdGETyurBUr7L08L0sA9FdhpTYBaZopmpMKjBwjO+5KiuVD9xVYPSuzXTRdAtdQRc90TnyMIBxBetuHib+jQxjYgPNnQ68m3igOsjm0nEALl4Q2BzvIgRC3Qwaewciu5A9pzr4sM65nAQRYszYioxPzqQUXsDzJbOMZMDwAX6GQB6vM522WDStKzdYt1HlCzQNrBXZEROAxuDYS2YUGtrAwGmw1+SmsNhdMm2n87Wxha1/PdvH/xa8GQg69eEL3ufMBszg+zPBjD2jRwgmfavv7CxC7rvqbcgA89E4cKYQNfkCTlDt0XmGDZezNt1QmuGBgJwvNvjeE/t5Siy3ncq/f9LcJTrA1Wp7GAQ2SFJ0+ItGx5C0XQNJPmhYIuiG+Otm5P9QzQypwjpmSlPR4TNDoTr6iRA40+ak/l95QD1+RaemdIE96UDqMDCUuBYBW+lhM0O1VC4nQl/SkW1MJrcvwCJhH28gf87HUAAAAASUVORK5CYII="/>\n        </div> \n        <div id="button-mode-annotation" class="panel-button panel-item">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIU/N4piFBEtRCxSRLFQCApiKRFMoxYxgq8mu24SIRuX3Q0itoKNRcBCtPFV+A+0FWwVBEERRGz8A74akfVOVohIMsvs/Tgz5zJzBrTJvGG59TGwCp6TTMQjc/MLkcYXQmiE6aQ9bbj21MxEiprj8446VW8HVa/a+6qO8LLpGlDXJDxi2I4nPCY8uebZireFO41celn4UHjAkQMKXyldD/hZcTbgd8VOKjkOmuoZyf5h/Q8bOccS7heOWvmi8XsedZMWszA7I7VbZg8uSRLEiaBTZIU8HoNSC5JZdV+s7JtmVTyG/G3WccSRJSfeAVGL0tWUmhHdlC/Pusr9f55uZngo6N4Sh4Yn33/rhcYd+C75/teR738fQ+gRLgoV/6rkNPoheqmiRQ+gbRPOLiuavgvnW9D1YKeddFkKydQyGXg9hdZ56LiB5sUgq991Tu4htSFPdA17+9An+9uWfgCZXmfbLPy9EwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAhxJREFUeNrtW1lywyAMtRhO0OT+J3SaHqCxanfijsuAEQaEWDTjn2CM3kMbS2ByyP1+R9vvC+IkVRSAs22eZ2sjUIHXToCLCKACb4UAkwg1dS7gm32X78TIOp45RhZw73FOsWlO4NzyJhbOiFC22W8BPDXgdxEDNktwuZmWPvtmvAiR79dr+no+/2EzLV7nVCBFgLOl3WVZJqWUM+3tfbZ3fKJrNu0UNYmOncFYCwktdDbQlJlNRkBp+Xw8Tts/brcoq4H1A2gMSAmCUuthr+4m3iu2hIINJli37tcCKoeZSXaB4CDoiPLkgWxZ5Opi6Czg7cHSfMcXRKtxAQp4LhdoBnwVBOQEX3UWSAF+FEKbBWxMBrLZVCG0d/p9THZ87wt9KBbw94ClU9MuYOquMw7UbCnc/VpgEDAIaEhitsQ4MgFItQCuNIjDBYQSwFUHgOQYAD1bwEiDzRBw3HEJPWWpUUyMuhfgLhJ0dyZvHKnrkKtlIwgOAgYB7RNAvTJbo9iwjauyLmZauyzpwqh9HWonwufScMX3z66nHc7pkxK3fhcpVSu1rslyXf54xLYrnBK8OUbS/YCdkZRZYFM81hJSEmlzaedd4VRExJCQEjz5P0MJBH3xhvk7/jQokATk0jdnirsKAjl1zZ3jQ8Egt54cRQ4VFJbQkavK84HDUvpxlrkoUTfuOh+l6VVioYOSdCq50kNBuhQloegO1A9Y7hjyBIja5wAAAABJRU5ErkJggg=="/>\n        </div> \n        <div class="panel-v-separator margin-s-5 panel-item"></div>\n        <div id="button-download-file" class="panel-button panel-item">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABbmlDQ1BpY2MAACiRdZG9S0JRGMZ/amGY4VBDRIODhYRCFERjGORiDWqQ1aLXr8CPy71KSGvQ0iA0RC19Df0HtQatBUFQBBEt/QN9LSG392RghJ7Lue+P55zn5ZzngD1S0Ipm1zgUSxUjGg55lxLLXucLDly4GcOf1Ex9PjYXp+P4vMOm6m1Q9eq8r+3oTWdMDWw9wlOablSEZ4Qj6xVd8bbwgJZPpoUPhQOGHFD4SumpJj8rzjX5XbERj86CXfX05v5w6g9reaMo7Bf2FQtV7fc86ibuTGkxJnVI5jAmUcKE8JKiyhoFKgSlliSz9r7xH98CZfFo8tepYYgjR168AVGr0jUjNSt6Rr4CNZX7/zzN7OREs7s7BN1PlvU2As4daNQt6+vIshrH4HiEi1LLX5acpj9Er7c03wF4NuHssqWlduF8CwYf9KSR/JEcMu3ZLLyeQl8C+m/AtdLM6nedk3uIb8gTXcPePozKfs/qNw5zaBHJcPVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAADIUlEQVR42u1bPY7UMBS2PZYQotmdTMMhqFhKGsR23IN6F1pEg7bj5xZUnICSluEAXIBmnEkFQsomPId45bGcxEnsTJ4nT7I0cX7s73u/diaUNMhms7H2F2VJ+kgqhK3b9hBqu3CdJM5jMUobz+12O2s/dwWOXRQukwgeO/AuIhg5caFd2m/ynZHiHAN8aLsNG58Y+KSiMLQRwWwnYwDvaiEnEQOkQp3T4Ny0PyY75be3JNvvD7CZz+MhJ+CDUFvhVRQFYYw1Fj7qHnlNl3DMpt23KrUGQUyAlcZdNOsqR7EAWd/rawTz2GEtMWitYLMa7sOMhpIwh2egcQEzGPsAj4oAPZv4Ao9yMdQGXsULmSajJMAFfN8swWIDH6ULhAKPgoCQ4FEGQZ/gnSrBOe4N+AKP0gJ8gkdHgG/wzouhMXsCvlwoBHg0FhAKPAoCQoJHnQYXAhwspnRYFPEYtdrHbRYXWAhYCFgIWAhYCDhhGV0H5Hn+iDF2Qyh9UedgGmqy6yT5/xanLL+lafpMDu/DAkqjmYNWr5NUU+/aVaOUfqnBi4NJhgIvhdKnSZK8HPioA7zjXYCxz/WvxDpZ3+DvOKBfZxED9kK8BZN87zJpX+DlsGB9PychQNbV8rW0anJzRG/VNWn6OgQJlvv3MIfHMKf17LKAbxJs9wH456D5H7NNgxUJhHwYS0KD5i98gw9SB4B5vhpDgpbq/mqavwTwWzSFUE0C6UuCOl8UxR8I8/e0gBcEfNBKUBZEBSEfXUnQ+6Gwul9r/sJnwAtSCXZsmV/nUDwBy1e1Zn8BuIct12fQztTvkJqfbC2QCXGtLKEDPKnBZ7Xmz6NZDOkk2ERahpHqtmQimWw1KEkAJ/9kr6Yry8hgFfUkNHi9qKua2RFSoGy+aiIBRr4UQnyPfj9AkmA3kOnBH21DRKZIsIR34Pu/pwx4gwg4O/c/N5k6V5S+4avVAzjcHvODLdtncyUEortgoP/fHrtIbLNwgTkJ07XdxlSM2pfYedcNNoKwAzfSb3+tH+sv9q6FjosoxS5fjg7xf8wWYLo0HeI7GAloimX/ANBjieJDfrkhAAAAAElFTkSuQmCC"/>\n        </div> \n      </div>\n    </div>\n    <div id="panel-bottom" class="disabled">\n      <div id="paginator" class="subpanel panel-item">\n        <div id="paginator-prev" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <div id="paginator-next" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <input id="paginator-input" type="text">\n        <span>&nbsp/&nbsp</span>\n        <span id="paginator-total">0</span>\n      </div>\n      <div class="panel-v-separator panel-item"></div>\n      <div id="zoomer" class="subpanel panel-item">\n        <div id="zoom-out" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <div id="zoom-in" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <div id="zoom-fit-viewer" class="panel-button">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZG9S8NQFMVPW8Wi1Q46SHHIUMWhhaIgjlLBLtWhrWDVJXlN2kKShpcUKa6Ci0PBQXTxa/A/0FVwVRAERRBx8R/wa5ES72sKLdLe8PJ+nHfP5eUE8Kd1Zth9CcAwHZ5JJaW1/Lo08A4fRhBEHBGZ2dZydimHnvXzSN1UD3Exq3df1xoqqDYDfEHiOWZxh3iBOL3lWIL3iMdYSS4QnxDHOF2Q+Fboisdvgosefwnmucwi4BczpWIHKx3MStwgniaOGnqVte4jviSkmqtZ2iO0JmAjgxSSkKCgijJ0OJRLGSZl1t2XaPpWUCEPo7eFGjg5iiiRN0ZqlaaqtGukq/ToqInc/+dpa7Mz3vRQEuh/dd3PSWBgH2jUXff31HUbZ0DgBbg22/4K5TT/TXq9rUWPgfAOcHnT1pQD4GoXGH+2ZC43pQAtv6YBHxfAcB4YvQcGN7ysWuc4fwJy2/SL7oDDI2CK+sObf/JNaAQfxWcoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR42u2bMW/EIAyFA7qla5Ol///HdUm6dguFKlQuBwnh7ADKs5TlTsrxPp6NAZ16H0czCMTXsijO90mNUw83DwC4OwAV5hZ37rYWoV6kAAAAAAAAAAAAAAAAAAAAAADcMh6CO63F7iwnkR2cUmqe57YcEIq3zyg4cWaapnYARM7rRjtLYupXY9ggaAHxzqKDtSgbAXdIkwBqqgK4QryP8J3OBe6xLjBVAFwpnjoh9rmDUJoOuhfxqXTwTiitCbon8WE6ROrCaQi6N/GxdFjX9XtzwWkIukS8/cHPmuKfnKD1W6kTdMnM2x/8qC0+VhNIPciGoEts7+nb75ro53cm4nCJ3L0ZkrqRvWSXRwokBZR9M9SzeJoOR82SziHYe5C6kA/A2cZB8E/PsXfh+zgqLt4+DgIl2cotsivEdizJlD0aZ84ymOy/G5nd5FhyJukQwHby8td60jW3hULpxP8Wu605O+vQrEaIQqDtZ20nePG+OStJz+xW+MkJpP2s4QQqvmTmizZDUSdsg7jSCVzii7bDHkK4PF5VEzjFFx+IOAip/lsSArf4YgCxZkl6iZQQ/zKAVJ/AnQ5S4lkA0Jog3Msv3OK5HBBdHZjj300TZxvOdjcoCYHrjlHMAT0HAAAAAAAAAAAAAAAAAAAAANwzFP47jBQAgFvHDyRnPtj60cBDAAAAAElFTkSuQmCC"/>\n        </div>\n        <div id="zoom-fit-page" class="panel-button">\n          <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZG9S8NQFMVPW8Wi1Q46SHHIUMWhhaIgjlLBLtWhrWDVJXlN2kKShpcUKa6Ci0PBQXTxa/A/0FVwVRAERRBx8R/wa5ES72sKLdLe8PJ+nHfP5eUE8Kd1Zth9CcAwHZ5JJaW1/Lo08A4fRhBEHBGZ2dZydimHnvXzSN1UD3Exq3df1xoqqDYDfEHiOWZxh3iBOL3lWIL3iMdYSS4QnxDHOF2Q+Fboisdvgosefwnmucwi4BczpWIHKx3MStwgniaOGnqVte4jviSkmqtZ2iO0JmAjgxSSkKCgijJ0OJRLGSZl1t2XaPpWUCEPo7eFGjg5iiiRN0ZqlaaqtGukq/ToqInc/+dpa7Mz3vRQEuh/dd3PSWBgH2jUXff31HUbZ0DgBbg22/4K5TT/TXq9rUWPgfAOcHnT1pQD4GoXGH+2ZC43pQAtv6YBHxfAcB4YvQcGN7ysWuc4fwJy2/SL7oDDI2CK+sObf/JNaAQfxWcoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVR42u2bzXKDIBCAw+ql6cnqpQ/Q93+f9gF60aan9GKwmkqHsXZA5Wd3YWcyySFO+D4WCLKKU+R4qush5u/DKfHIAlIXIFIDXs45eQhkAYlHiaUhTdMMcvgZniDcTE397Xb9vFweKQgoFfwU+ue1kFJ+AcDDf6J+RQKcqWRAv+cikyhqc4Ax71WPT73Pbg746Lpd/0uO7iVIrwIuNlJkBIyrhJddJBkBbdt62UIDp7Qf5xExL5PvLAXYwM+rxDM7AbbwLIeAL3gSAnzCoxfgGx61gBDwaAWEgkcpICQ8OgGh4VEJiAGPRkAseBQCPMF3JAQo+LV7e3vh9esGKd9M3xeppT2Kk6GYY/5PBiwb47sBmOCDZwA2eCsBVVW9Tg0fX63TsadNfLHgrQQIgBebHtza8+pQIyb81iFQc0n7YHMAdnivAijAexNABd6LAErwzgVQg3cqgCK8MwFU4Z0IoAx/WAB1+EMCOMBvEqAfOXOB3yRAHTlzgne6DOrwy3IW9gKWPa+Xs7AXQDHt9ThcJ7h2p8eiglPMdYF85oCpfvf+ble+OpDMAFNx8o7f7tELGHv2WhbF2SQGisJYv7soh+9JZICp3p565EdmsoDEQ8R+dpfSwUgeAlkAw/gGgdL3j4c6UpkAAAAASUVORK5CYII="/>\n        </div>\n      </div>\n    </div>\n  </div>\n';const t=this._shadowRoot.getElementById("paginator-input");t.addEventListener("input",this.onPaginatorInput),t.addEventListener("change",this.onPaginatorChange),this._shadowRoot.querySelector("#paginator-prev").addEventListener("click",this.onPaginatorPrevClick),this._shadowRoot.querySelector("#paginator-next").addEventListener("click",this.onPaginatorNextClick),this._shadowRoot.querySelector("#zoom-out").addEventListener("click",this.onZoomOutClick),this._shadowRoot.querySelector("#zoom-in").addEventListener("click",this.onZoomInClick),this._shadowRoot.querySelector("#zoom-fit-viewer").addEventListener("click",this.onZoomFitViewerClick),this._shadowRoot.querySelector("#zoom-fit-page").addEventListener("click",this.onZoomFitPageClick),this._shadowRoot.querySelector("#toggle-previewer").addEventListener("click",this.onPreviewerToggleClick),this._previewer=this._shadowRoot.querySelector("#previewer"),this._previewer.addEventListener("scroll",this.onPreviewerScroll),this._viewer=this._shadowRoot.querySelector("#viewer"),this._viewer.addEventListener("scroll",this.onViewerScroll),this._viewer.addEventListener("wheel",this.onViewerWheel),this._viewer.addEventListener("pointermove",this.onViewerPointerMove),this._viewer.addEventListener("pointerdown",this.onViewerPointerDown),this._viewer.addEventListener("touchstart",this.onViewerTouchStart),this._shadowRoot.querySelector("#button-mode-text").addEventListener("click",this.onTextModeButtonClick),this._shadowRoot.querySelector("#button-mode-hand").addEventListener("click",this.onHandModeButtonClick),this._shadowRoot.querySelector("#button-mode-annotation").addEventListener("click",this.onAnnotationModeButtonClick),this.toggleMode("text"),this._shadowRoot.querySelector("#button-download-file").addEventListener("click",this.onDownloadFileButtonClick),this._mainContainer=this._shadowRoot.querySelector("div#main-container");const e=new ResizeObserver(this.onMainContainerResize);e.observe(this._mainContainer),this._mainContainerResizeObserver=e}refreshPagesAsync(){var t;return as(this,void 0,void 0,(function*(){this._pages.forEach((t=>{t.previewContainer.removeEventListener("click",this.onPreviewerPageClick),t.destroy()})),this._pages.length=0;const e=(null===(t=this._pdfDocument)||void 0===t?void 0:t.numPages)||0;if(this._shadowRoot.getElementById("paginator-total").innerHTML=e+"",e)for(let t=0;t<e;t++){const e=yield this._pdfDocument.getPage(t+1),r=new is(e,this._docData,this._maxScale,this._previewWidth);r.scale=this._scale,r.previewContainer.addEventListener("click",this.onPreviewerPageClick),this._previewer.append(r.previewContainer),this._viewer.append(r.viewContainer),this._pages.push(r)}}))}renderVisiblePreviews(){if(this._previewerHidden)return;const t=this._pages,e=this.getVisiblePages(this._previewer,t,!0),r=Math.max(Math.min(...e)-this._visibleAdjPages,0),s=Math.min(Math.max(...e)+this._visibleAdjPages,t.length-1);for(let e=0;e<t.length;e++){const n=t[e];e>=r&&e<=s&&n.renderPreviewAsync()}}renderVisiblePages(){var t,e;const r=this._pages,s=this.getVisiblePages(this._viewer,r),n=this._currentPage,i=this.getCurrentPage(this._viewer,r,s);if(n&&n===i||(null===(t=r[n])||void 0===t||t.previewContainer.classList.remove("current"),null===(e=r[i])||void 0===e||e.previewContainer.classList.add("current"),this._shadowRoot.getElementById("paginator-input").value=i+1+"",this.scrollToPreview(i),this._currentPage=i),-1===i)return;const a=Math.max(Math.min(...s)-this._visibleAdjPages,0),o=Math.min(Math.max(...s)+this._visibleAdjPages,r.length-1);for(let t=0;t<r.length;t++){const e=r[t];t>=a&&t<=o?e.renderViewAsync():e.clearView()}}scrollToPreview(t){const{top:e,height:r}=this._previewer.getBoundingClientRect(),{top:s,height:n}=this._pages[t].previewContainer.getBoundingClientRect(),i=s+n/2-(e+r/2)+this._previewer.scrollTop;this._previewer.scrollTo(0,i)}scrollToPage(t){const{top:e}=this._viewer.getBoundingClientRect(),{top:r}=this._pages[t].viewContainer.getBoundingClientRect(),s=r-(e-this._viewer.scrollTop);this._viewer.scrollTo(this._viewer.scrollLeft,s)}setScale(t,e=null){if(!t||t===this._scale)return;let r,s,n;if(e)for(const t of this._pages){const{x:i,y:a}=e,{x:o,y:h,width:c,height:d}=t.viewContainer.getBoundingClientRect();if(o<=i&&o+c>=i&&h<=a&&h+d>=a){r=t.viewContainer,s=(i-o)/c,n=(a-h)/d;break}}if(this._scale=t,this._pages.forEach((t=>t.scale=this._scale)),r&&(this._viewer.scrollHeight>this._viewer.clientHeight||this._viewer.scrollWidth>this._viewer.clientWidth)){const{x:t,y:i}=e,{x:a,y:o,width:h,height:c}=r.getBoundingClientRect(),d=a+h*s,l=o+c*n;let p=this._viewer.scrollLeft+(d-t),u=this._viewer.scrollTop+(l-i);if(p=p<0?0:p,u=u<0?0:u,u!==this._viewer.scrollTop||p!==this._viewer.scrollLeft)return void this._viewer.scrollTo(p,u)}setTimeout((()=>this.renderVisiblePages()),0)}zoom(t,e=null){const r=l(this._scale+t,this._minScale,this._maxScale);this.setScale(r,e||this.getViewerCenterPosition())}zoomOut(t=null){this.zoom(-.25,t)}zoomIn(t=null){this.zoom(.25,t)}getViewerCenterPosition(){const{x:t,y:e,width:r,height:s}=this._viewer.getBoundingClientRect();return new p(t+r/2,e+s/2)}toggleMode(t){if(t&&t!==this._mode){switch(this._mode){case"text":this._viewer.classList.remove("mode-text"),this._shadowRoot.querySelector("#button-mode-text").classList.remove("on");break;case"hand":this._viewer.classList.remove("mode-hand"),this._shadowRoot.querySelector("#button-mode-hand").classList.remove("on");break;case"annotation":this._viewer.classList.remove("mode-annotation"),this._shadowRoot.querySelector("#button-mode-annotation").classList.remove("on")}switch(t){case"text":this._viewer.classList.add("mode-text"),this._shadowRoot.querySelector("#button-mode-text").classList.add("on");break;case"hand":this._viewer.classList.add("mode-hand"),this._shadowRoot.querySelector("#button-mode-hand").classList.add("on");break;case"annotation":this._viewer.classList.add("mode-annotation"),this._shadowRoot.querySelector("#button-mode-annotation").classList.add("on");break;default:throw new Error(`Invalid viewer mode: ${t}`)}this._mode=t}}getVisiblePages(t,e,r=!1){const s=new Set;if(!e.length)return s;const n=t.getBoundingClientRect(),i=n.top,a=n.top+n.height;for(let t=0;t<e.length;t++){const n=e[t],o=r?n.previewContainer.getBoundingClientRect():n.viewContainer.getBoundingClientRect(),h=o.top,c=o.top+o.height;if(h<a&&c>i)s.add(t);else if(s.size)break}return s}getCurrentPage(t,e,r){const s=[...r];if(!s.length)return-1;if(1===s.length)return s[0];const n=t.getBoundingClientRect(),i=n.top,a=n.top+n.height/2;for(const t of s){const r=e[t].viewContainer.getBoundingClientRect().top;if(r>i)return r>a?t-1:t}throw new Error("Incorrect argument")}showPasswordDialogAsync(){return as(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{const r=document.createElement("div");r.id="password-dialog",r.innerHTML='\n    <div class="form">\n      <input id="password-input" type="password" maxlength="127"/>\n      <div class="buttons">\n        <div id="password-ok" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n        <div id="password-cancel" class="panel-button">\n          <img src="data:image/png;base64,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"/>\n        </div>\n      </div>\n    </div>\n',this._mainContainer.append(r);let s="";const n=this._shadowRoot.getElementById("password-input");n.placeholder="Enter password...",n.addEventListener("change",(()=>s=n.value));const i=()=>{r.remove(),t(null)};r.addEventListener("click",(t=>{t.target===r&&i()})),this._shadowRoot.getElementById("password-ok").addEventListener("click",(()=>{r.remove(),t(s)})),this._shadowRoot.getElementById("password-cancel").addEventListener("click",i)}))}))}}export{os as TsPdfViewer};
